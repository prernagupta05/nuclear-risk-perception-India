---
title: "module2graphsandPCA"
output:
  html_document:
    fig_width: 9
    fig_height: 6
    fig_caption: yes
    keep_md: yes
    theme: paper
    df_print: paged
  
  
pdf_document: 
    
    toc: true
    number_sections: true
    toc_depth: 2
    fig_width: 9
    fig_height: 6
    fig_caption: yes
    df_print: 
---

```{r load packages, warning = FALSE, message = FALSE, echo=FALSE}
  knitr::opts_chunk$set(warning = FALSE, message = FALSE)

suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(hablar))
suppressPackageStartupMessages(library(tsibble))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggbiplot))

```



## Original Dataset
```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
moduletwo <- read_excel( "~/Desktop/thesis_surveydata/political_factors_complete.xlsx")
save(moduletwo, file = "moduletwo.rda")
module2 <- data.frame(moduletwo)
module2[module2 == "Rather not say/ Don't know"] <- "Rather not say/Don't know"
module2 %>%
  filter(!row_number() %in% c(1,2))

# loaded data set for module 2 eco -pol variables and removes the rows with question number and question text
```


## Coded Dataset


```{r, eval =TRUE, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#This chunk contains the coding schemes of various scales used in survey one: eco-political factors, kahan scale and acceptance scale
codedmodule2 <- module2 %>%
  
#remove row 1
  filter(!row_number() %in% c(1,2)) %>% 
  
# replace risky likert scale with numbers
  mutate_at(vars(starts_with("Risky")), funs(case_when(. =="Not at all risky" ~ 1, 
                                                       . =="Slightly risky" ~ 2, 
                                                       . =="Moderately risky" ~ 3, 
                                                       . =="Very risky" ~ 4, 
                                                       . =="Extremely risky" ~ 5))) %>%

# replace beneficial likert scale with numbers  
  mutate_at(vars(starts_with("Ben")), funs(case_when(. =="Not at all beneficial" ~ 1,
                                                     . =="Slightly beneficial" ~ 2,
                                                     . =="Moderately beneficial" ~ 3,
                                                     . =="Very beneficial" ~ 4,
                                                     . =="Extremely beneficial" ~ 5 ))) %>%

# replace nuclear acceptance likert scale with numbers
  mutate_at(vars(N_accept,N_reluctantlyaccept,N_reject), funs(case_when(. == "Strongly disagree" ~ 1, 
                                                                        . == "Somewhat disagree" ~ 2,
                                                                        . == "Neither agree nor disagree" ~3,
                                                                        . == "Somewhat agree" ~ 4,
                                                                        . == "Strongly agree" ~ 5))) %>%
  
# code likert scale for variables for Kahan scale into numbers
  mutate_at(vars(starts_with (c("K_I","K_H","DISPLACE", "POLLUTE", "HEALTH", "JOBS", "BEAUTY", "PRIDE", "NPRIDE", "DEV", "PROSPER", "RELY"))), funs(case_when(. == "Strongly disagree" ~ 1, 
               . == "Somewhat disagree" ~ 2,
               . == "Neither agree nor disagree" ~3,
               . == "Somewhat agree" ~ 4,
               . == "Strongly agree" ~ 5))) %>%
  
# reverse code for likert scale for variables for Kahan scale into numbers
  mutate_at(vars(starts_with (c("K_S","K_E"))), funs(case_when(. == "Strongly disagree" ~ 5, 
                                                               . == "Somewhat disagree" ~ 4,
                                                               . == "Neither agree nor disagree" ~3,
                                                               . == "Somewhat agree" ~ 2,
                                                               . == "Strongly agree" ~ 1))) %>%

# code eco-pol scale variables into numbers
  mutate_at(vars(SYSTEMDEMO,SYSTEMRELIGION,SYSTEMTECHNO,SYSTEMTOTAL,WEALTHLIM,MECHANISATION,DECISIONDECEN,INDUSTRYLARGE,ECONOMYGLOBAL,OWNERPVT,OWNERNOREG), funs(case_when(. == "Strongly disagree" ~ 1, 
                        . == "Somewhat disagree" ~ 2,
                        . == "Neither agree nor disagree" ~3,
                        . == "Somewhat agree" ~ 4,
                        . == "Strongly agree" ~ 5))) %>%

# reverse code eco-pol scale variables into numbers 
 mutate_at(vars(DECISIONCEN, INDUSTRYSMALL, ECONOMYLOCAL, ENVOVERDEV,OWNERPUB, OWNERREG), funs(case_when(. == "Strongly disagree" ~ 5, 
                                                                                                         . == "Somewhat disagree" ~ 4,
                                                                                                         . == "Neither agree nor disagree" ~3,
                                                                                                         . == "Somewhat agree" ~ 2,
                                                                                                         . == "Strongly agree" ~ 1)))

codedmodule2
```


## Q1. Below is a list of various centrally managed sources of energy. How risky are each of these energy technologies according to you?  Please tell me whether you see each technology as: not at all risky, slightly risky, moderately risky, very risky, or extremely risky

```{r, eval=TRUE, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

# summary statistics for risks from different energy sources

risksumcentral <- codedmodule2 %>%
  dplyr::select(!starts_with(c("RISKY_IND")))%>%
  summarize_at(vars(starts_with(c("RISKY"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  #add row index so later spreading indexed correctly
  add_rownames()%>%
  #melt to long format
  gather(technology, value, -rowname) %>%
  # separate risky from variable suffix
  separate(technology, c("Risky", "var"), extra = "merge", fill = "left") %>%
  #separate mean from variable prefix
  separate(var, c("technology", "summary")) %>%
  # spread summary values back to wide form
  spread(summary,value) %>%
  #clean up
  dplyr::select(-rowname, -Risky) %>%
  arrange(mean) %>%
  setNames(paste0('perceivedrisk.', names(.))) %>%
  dplyr::rename(technology= perceivedrisk.technology)

risksumcentral


```




```{r, echo=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE)

risksumcentral %>%
  dplyr::select(technology, perceivedrisk.mean, perceivedrisk.sd) %>%
  mutate(technology = fct_reorder(technology, perceivedrisk.mean, .desc = FALSE))%>%
  ggplot(aes(x=technology, y= perceivedrisk.mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  ylim(0,5)+
  geom_errorbar(aes(ymin=perceivedrisk.mean-perceivedrisk.sd, ymax=perceivedrisk.mean + perceivedrisk.sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "Mean Values of Perceived Risk", x = "Energy Technologies")+
  ggtitle("Perceived risk from centrally managed energy technologies")+
  coord_flip()


```



## Q2. Following is a list of various individually or community-owned and managed sources of energy. How risky are each of these energy technologies according to you? Please tell me whether you see each technology as: not at all risky, slightly risky, moderately risky, very risky, or extremely risky. 

```{r, eval=TRUE, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

# summary statistics for risks from different energy sources

risksumIND <- codedmodule2 %>%
  summarize_at(vars(starts_with(c("RISKY_IND"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  #add row index so later spreading indexed correctly
  add_rownames()%>%
  #melt to long format
  gather(technology, value, -rowname) %>%
  # separate risky from variable suffix
  separate(technology, c("Risky", "var"), extra = "merge", fill = "left") %>%
  #separate mean from variable prefix
  separate(var, c("technology", "summary")) %>%
  # spread summary values back to wide form
  spread(summary,value) %>%
  #clean up
  dplyr::select(-rowname, -Risky) %>%
  arrange(mean) %>%
  setNames(paste0('perceivedrisk.', names(.))) %>%
  dplyr::rename(technology= perceivedrisk.technology)

risksumIND


```

```{r, echo=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE)

risksumIND %>%
  dplyr::select(technology, perceivedrisk.mean,perceivedrisk.sd) %>%
  mutate(technology = fct_reorder(technology, perceivedrisk.mean, .desc = FALSE))%>%
  ggplot(aes(x=technology, y= perceivedrisk.mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(ymin=perceivedrisk.mean-perceivedrisk.sd, ymax=perceivedrisk.mean + perceivedrisk.sd), width=.2,
                 position=position_dodge(.9))+
  ylim(0,5)+
  labs(y = "Mean Values of Perceived Risk", x = "Energy Technologies")+
  ggtitle("Perceived risk from individually or community owned energy technologies")+
  coord_flip()


```


## Q3. Following is a list of centrally managed sources of energy. How beneficial are each of these according to you? Please tell me whether you see each technology as: not at all beneficial, slightly beneficial, moderately beneficial, very beneficial, or extremely beneficial?

```{r, eval=TRUE, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

# summary statistics for risks from different energy sources

bensumcentral <- codedmodule2 %>%
  dplyr::select(!starts_with(c("Ben_IND")))%>%
  summarize_at(vars(starts_with(c("Ben"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  #add row index so later spreading indexed correctly
  add_rownames()%>%
  #melt to long format
  gather(technology, value, -rowname) %>%
  # separate risky from variable suffix
  separate(technology, c("Ben", "var"), extra = "merge", fill = "left") %>%
  #separate mean from variable prefix
  separate(var, c("technology", "summary")) %>%
  # spread summary values back to wide form
  spread(summary,value) %>%
  #clean up
  dplyr::select(-rowname, -Ben) %>%
  arrange(mean) %>%
  setNames(paste0('perceivedbenefit.', names(.))) %>%
  dplyr::rename(technology= perceivedbenefit.technology)

bensumcentral


```


```{r, echo=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE)

bensumcentral %>%
  dplyr::select(technology, perceivedbenefit.mean,perceivedbenefit.sd) %>%
  mutate(technology = fct_reorder(technology, perceivedbenefit.mean, .desc = FALSE))%>%
  ggplot(aes(x=technology, y= perceivedbenefit.mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
   geom_errorbar(aes(ymin=perceivedbenefit.mean-perceivedbenefit.sd, ymax=perceivedbenefit.mean + perceivedbenefit.sd), width=.2,
                 position=position_dodge(.9))+
  ylim(0,5)+
  labs(y = "Mean Values of Perceived Benefit", x = "Energy Technologies")+
  ggtitle("Perceived benefit from centrally managed energy technologies")+
  coord_flip()


```


## Q4. Following is a list of various individually or community owned and managed sources of energy. How beneficial are each of these according to you? Please tell me whether you see each technology as: not at all beneficial, slightly beneficial, moderately beneficial, very beneficial or extremely beneficial ?

```{r, eval=TRUE, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

# summary statistics for risks from different energy sources

bensumIND <- codedmodule2 %>%
  summarize_at(vars(starts_with(c("Ben_IND"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  #add row index so later spreading indexed correctly
  add_rownames()%>%
  #melt to long format
  gather(technology, value, -rowname) %>%
  # separate risky from variable suffix
  separate(technology, c("Ben", "var"), extra = "merge", fill = "left") %>%
  #separate mean from variable prefix
  separate(var, c("technology", "summary")) %>%
  # spread summary values back to wide form
  spread(summary,value) %>%
  #clean up
  dplyr::select(-rowname, -Ben) %>%
  arrange(mean) %>%
  setNames(paste0('perceivedbenefit.', names(.))) %>%
  dplyr::rename(technology= perceivedbenefit.technology)

bensumIND


```

```{r, echo=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE)

bensumIND %>%
  dplyr::select(technology, perceivedbenefit.mean, perceivedbenefit.sd) %>%
  mutate(technology = fct_reorder(technology, perceivedbenefit.mean, .desc = FALSE))%>%
  ggplot(aes(x=technology, y= perceivedbenefit.mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(ymin=perceivedbenefit.mean-perceivedbenefit.sd, ymax=perceivedbenefit.mean + perceivedbenefit.sd), width=.2,
                 position=position_dodge(.9))+
  ylim(0,5)+
  labs(y = "Mean Values of Perceived Benefit", x = "Energy Technologies")+
  ggtitle("Perceived benefit from individually or community owned energy technologies")+
  coord_flip()


```

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)


center_barplot <- full_join( bensumcentral,risksumcentral, by = NULL, copy = FALSE, keep = FALSE) %>%
 dplyr::select(technology, perceivedbenefit.mean, perceivedrisk.mean) %>%
  mutate(technology = fct_reorder(technology, perceivedbenefit.mean, .desc = FALSE))%>%
   gather(key = "level", value = "mean", perceivedbenefit.mean, perceivedrisk.mean)

center_barplot$level <- as.factor(center_barplot$level)                                          

 center_barplot%>% 
  ggplot(aes(x=technology, y= mean, fill =  (factor(center_barplot$level, levels = c("perceivedrisk.mean", "perceivedbenefit.mean")))))+
  geom_bar(stat="identity", position=position_dodge())+
  ylim(0,4)+
  scale_fill_manual("legend", values = c("perceivedbenefit.mean" = "palegreen3","perceivedrisk.mean" = "firebrick2"))+
  labs(y = "Mean Values", x = "Energy Technologies")+
  ggtitle("Perceived risk and benefit from centrally owned energy technologies")+
  coord_flip()


```



```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)


IND_barplot <- full_join(bensumIND,risksumIND, by = NULL, copy = FALSE, keep = FALSE) %>%
 dplyr::select(technology, perceivedbenefit.mean, perceivedrisk.mean) %>%
  mutate(technology = fct_reorder(technology, perceivedbenefit.mean, .desc = FALSE))%>%
  gather(key = "level", value = "mean", perceivedbenefit.mean, perceivedrisk.mean)
  
IND_barplot$level <- as.factor(IND_barplot$level)
    
IND_barplot%>%  ggplot(aes(x=technology, y= mean, fill = (factor(IND_barplot$level, levels = c("perceivedrisk.mean", "perceivedbenefit.mean")))))+
  geom_bar(stat="identity", position=position_dodge())+
  ylim(0,4)+
  scale_fill_manual("legend", values = c("perceivedbenefit.mean" = "palegreen3","perceivedrisk.mean" = "firebrick2"))+
  labs(y = "Mean Values", x = "Energy Technologies")+
  ggtitle("Perceived risk and benefit from individually owned energy technologies")+
  coord_flip()

```

\newpage

# **Kahan et al (2007) scale**

- **K_IINTRFER**	The government interferes far too much in our everyday lives.
- **K_IPRIVACY**	The government should stop telling people how to live their lives.
- **K_SHARM**	    Sometimes the government needs to make laws that keep people from hurting themselves.
- **K_IPROTECT**	It’s not the government’s business to try to protect people from themselves.
- **K_SLIMCHOI**	The government should put limits on the choices individuals can make so they don’t get in the way of what’s good for society.
- **K_SPROTECT**	The government should do more to advance society’s goals, even if that means limiting the freedom and choices of individuals.
- **K_HEQUAL**	  We have gone too far in pushing equal rights in this country.
- **K_HREVDIS1**	Nowadays it seems like there is just as much discrimination against upper castes as there is against Dalits.
- **K_EDISCRIM**	Discrimination against minorities is still a very serious problem in our society.
- **K_ERADEQ1**	  We need to dramatically reduce inequalities between the rich and the poor.
- **K_EWEALTH**	  Our society would be better off if the distribution of wealth was more equal.
- **K_ERADEQ2**	  We need to dramatically reduce inequalities between men and women.


## Cronbach's alpha test on the Kahan et al (2007) scale

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

library(ltm)

#cronbach alpha

Kahanscale <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_")))

cronbach.alpha(Kahanscale, na.rm = TRUE, CI=TRUE, standardized=TRUE)

```

## Principal Component Analysis on Kahan et al (2007) scale

```{r, echo=FALSE}


#PCA on Kahan scale
pcaresultsK <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_")))%>%
  na.omit()%>%
  prcomp(center = TRUE, scale. = TRUE)

rotations = pcaresultsK["rotation"]

#calculate total variance explained by each principal component
var_explainedK <- pcaresultsK$sdev^2 / sum(pcaresultsK$sdev^2)


rotationsK <- do.call(rbind.data.frame, rotations)%>%
              tibble::rownames_to_column("Variables") 
              
rotationsK


pcatableK  <- summary(pcaresultsK)

UnclassedK <- unclass(pcatableK)

ImportanceK <- UnclassedK["importance"]

varexplK <- do.call(rbind.data.frame, ImportanceK) 
 
KPCAtable <- data.frame(t(varexplK), row.names=names(varexplK))

as_tibble(KPCAtable) %>%
 add_column("Principal Components" = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9", "PC10", "PC11", "PC12"))%>%
 dplyr::select("Principal Components",  importance.Proportion.of.Variance, importance.Cumulative.Proportion ) %>%  
 dplyr::rename(Proportion_of_Variance = importance.Proportion.of.Variance, Cumulative_Proportion = importance.Cumulative.Proportion)


```




```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

qplot(c(1:12), var_explainedK) + 
  geom_line() + 
  xlab("Principal Component") + 
  ylab("Variance Explained") +
  ggtitle("Scree Plot") +
  ylim(0, 0.30)+
  xlim(1,7)


```

\newpage

# **The economic -political values of the perceiver scale**


- **DECISIONDECEN**	 Local politicians shouldn't have to ask permission from the central government to implement policies
- **DECISIONCEN**	   Laws and policies would be implemented more smoothly if more power lay with the central government.
- **SYSTEMTOTAL**	   It is good to have a strong leader who does not have to bother with elections.
- **SYSTEMTECHNO**	 Experts, not the government, should make decisions according to what they think is best for the country.
- **SYSTEMDEMO**	   It is very important to have a democratic political system because it ensures that no individual leader has too much power.
- **SYSTEMRELIGION** There should be a system governed by religious law.
- **INDUSTRYSMALL**	 Large corporations are destroying the local industries in India and benefiting only a handful of people.
- **INDUSTRYLARGE**	 Large scale industries are required for the development of the country that will benefit everyone
- **ECONOMYLOCAL**	 India would be better off if foreign companies didn't come to here
- **ECONOMYGLOBAL**	 Foreign companies have led to a range of benefits for the Indian people and society
- **DEVOVERENV**	   Economic growth and creating jobs should be prioritized over environmental protection
- **ENVOVERDEV**	   Polluting industries that spoil the environment should be shut down even if it costs people their jobs
- **OWNERPVT**	     All businesses and industries should be owned privately
- **OWNERPUB**	     The government should own most large businesses and industries
- **OWNERREG**	     Regardless of ownership, the government should pass strong regulations and implement them
- **OWNERNOREG**	   There is too much red-tape and the government should not interfere with businesses and industries
- **WEALTHLIM**	     A limit should be put to how much wealth a person can amass
- **MECHANISATION**	 Rapid mechanization of work is taking away jobs from workers in this country


## Cronbach's alpha test on the economic -political values of the perceiver
```{r, echo= FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
ecopolscalescores <- codedmodule2 %>%
 dplyr::select(starts_with(c("Risky","SYSTEMDEMO","SYSTEMRELIGION","SYSTEMTECHNO","SYSTEMTOTAL","WEALTHLIM","MECHANISATION","DECISIONDECEN","DECISIONCEN","INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL","ECONOMYLOCAL", "ENVOVERDEV","DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG", "Gender","Caste","Religion", "State")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(Pro_decentralisation = mean(c_across("DECISIONDECEN":"DECISIONCEN")))%>%
   dplyr::mutate(Pro_largescale = mean(c_across("INDUSTRYLARGE":"INDUSTRYSMALL")))%>%
   dplyr::mutate(Pro_global = mean(c_across("ECONOMYGLOBAL":"ECONOMYLOCAL")))%>%
   dplyr::mutate(Pro_ecogrowth = mean(c_across("ENVOVERDEV":"DEVOVERENV")))%>%
   dplyr::mutate(Pro_private = mean(c_across("OWNERPVT":"OWNERREG")))%>%
  dplyr::select(!c("DECISIONDECEN","DECISIONCEN", "INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL", "ECONOMYLOCAL","ENVOVERDEV",     "DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG"))

#cronbach alpha


cronbach.alpha(ecopolscalescores, na.rm = TRUE, CI=TRUE, standardized=TRUE)

```

## PCA on the economic -political values of the perceiver

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# PCA test on qualities of the perceiver

ecopolscalepca <- ecopolscalescores %>%
  dplyr::select(!starts_with(c("Risky","Gender","Caste","Religion","State")))%>%
  prcomp(center = TRUE,scale. = TRUE)


var_explained_ecopol = ecopolscalepca$sdev^2 / sum(ecopolscalepca$sdev^2)


pcatableecopol  <- summary(ecopolscalepca)

Unclassedecopol <- unclass(pcatableecopol)

Importanceecopol <- Unclassedecopol["importance"]

varexplecopol <- do.call(rbind.data.frame, Importanceecopol) 
 
ecopolPCAtable <- data.frame(t(varexplecopol), row.names=names(varexplecopol))

as_tibble(ecopolPCAtable) %>%
 add_column("Principal Components" = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9", "PC10", "PC11"))%>%
 dplyr::select("Principal Components",  importance.Proportion.of.Variance, importance.Cumulative.Proportion ) %>%  
 dplyr::rename(Proportion_of_Variance = importance.Proportion.of.Variance, Cumulative_Proportion = importance.Cumulative.Proportion)

```



## Variables in the PCs


```{r, echo=FALSE}

rotationsecopol = ecopolscalepca["rotation"]
rotationsDFecopol <- do.call(rbind.data.frame, rotationsecopol)
rotationsDFecopol
```


```{r, echo=FALSE}

qplot(c(1:11), var_explained_ecopol) + 
  geom_line() + 
  xlab("Principal Component") + 
  ylab("Variance Explained") +
  ggtitle("Scree Plot") +
  ylim(0.05, 0.20)+
  xlim(1,7)

```

\newpage

# **eco - pol characteristics of the technology scale-  Solar Energy and Nuclear Energy**


- **DISPLACESOLAR**	 Solar energy is leading to displacement of people from their land
- **POLLUTESOLAR**	 Solar energy increases pollution of air/water/land
- **HEALTHSOLAR**	   Solar energy poses a great risk to the health of people living around it
- **JOBSSOLAR**	     Solar energy will bring jobs to the local community
- **BEAUTYSOLAR**	   Solar energy spoils the natural beauty of the landscape
- **PRIDESOLAR**	   I would be proud if my community used solar energy
- **NPRIDESOLAR**	   Solar energy is a mark of pride for our nation
- **DEVSOLAR**	     Solar energy pushes forward the country's development
- **PROSPERSOLAR**	 Solar energy brings economic prosperity to the surrounding regions
- **RELYSOLAR**	     I don't like the idea that I have to rely on the government for electricity from (large scale) solar energy


## Cronbach's alpha test on eco-pol characteristics of the technology -  Solar Energy

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

#PCA on eco-pol characterisitics of the technology

Solar <- codedmodule2 %>%
 dplyr::select("DISPLACESOLAR":"RELYSOLAR") 

cronbach.alpha(Solar, na.rm = TRUE, CI=TRUE, standardized=TRUE)

ROOFS<- codedmodule2 %>%
 dplyr::select("DISPLACEROOFS":"RELYROOFS")




```

## PCA on eco-pol characteristics of the technology -  Solar Energy

```{r, echo = FALSE}

Solar.pca <- Solar %>%
  na.omit()%>%
  prcomp(center = TRUE, scale. = TRUE)

pcatablesolar  <- summary(Solar.pca)

Unclassedsolar <- unclass(pcatablesolar)

Importancesolar <- Unclassedsolar["importance"]

varexplsolar <- do.call(rbind.data.frame, Importancesolar) 
 
solarPCAtable <- data.frame(t(varexplsolar), row.names=names(varexplsolar))

as_tibble(solarPCAtable) %>%
 add_column("Principal Components" = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9", "PC10"))%>%
 dplyr::select("Principal Components",  importance.Proportion.of.Variance, importance.Cumulative.Proportion ) %>%  
 dplyr::rename(Proportion_of_Variance = importance.Proportion.of.Variance, Cumulative_Proportion = importance.Cumulative.Proportion)
```


```{r, echo=FALSE}


rotations = Solar.pca["rotation"]

#calculate total variance explained by each principal component
var_explainedSolar <- Solar.pca$sdev^2 / sum(Solar.pca$sdev^2)

rotationsSolar <- do.call(rbind.data.frame, rotations)
                  
rotationsSolar


```



```{r, echo=FALSE}

qplot(c(1:10), var_explainedSolar) + 
  geom_line() + 
  xlab("Principal Component") + 
  ylab("Variance Explained") +
  ggtitle("Scree Plot") +
  ylim(0.01, 0.40)+
  xlim(1,7)

```


## PCA on eco-pol characteristics of the technology -  Nuclear Energy


```{r, echo = FALSE}

Nuclear<- codedmodule2 %>%
 dplyr::select("DISPLACENUCLEAR":"RELYNUCLEAR")

cronbach.alpha(Nuclear, na.rm = TRUE, CI=TRUE, standardized=TRUE)

```

```{r, echo = FALSE}


Nuclear.pca <- Nuclear %>%
  na.omit()%>%
  prcomp(center = TRUE, scale. = TRUE)


pcatablenuclear  <- summary(Nuclear.pca)

Unclassednuclear <- unclass(pcatablenuclear)

Importancenuclear <- Unclassednuclear["importance"]

varexplnuclear <- do.call(rbind.data.frame, Importancenuclear) 
 
nuclearPCAtable <- data.frame(t(varexplnuclear), row.names=names(varexplnuclear))

as_tibble(nuclearPCAtable) %>%
 add_column("Principal Components" = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9", "PC10"))%>%
 dplyr::select("Principal Components",  importance.Proportion.of.Variance, importance.Cumulative.Proportion ) %>%  
 dplyr::rename(Proportion_of_Variance = importance.Proportion.of.Variance, Cumulative_Proportion = importance.Cumulative.Proportion)

```




```{r, echo=FALSE}


rotations = Nuclear.pca["rotation"]


#calculate total variance explained by each principal component
var_explainedNuclear <- Nuclear.pca$sdev^2 / sum(Nuclear.pca$sdev^2)


rotationsNuclear <- do.call(rbind.data.frame, rotations)
                  
rotationsNuclear

```

```{r, echo=FALSE}

qplot(c(1:10), var_explainedNuclear) + 
  geom_line() + 
  xlab("Principal Component") + 
  ylab("Variance Explained") +
  ggtitle("Scree Plot") +
  ylim(0.01, 0.30)+
  xlim(1,7)

```

