---
title: "Kahan scale and Economic Political value scale"
output:
  pdf_document:
    toc: yes
    toc_depth: 2
    keep_tex: yes
  header-includes:
  - \usepackage{dcolumn}
  - \usepackage{array}
  keep_md: yes
---
```{r load packages, warning = FALSE, message = FALSE, echo=FALSE}
  knitr::opts_chunk$set(warning = FALSE, message = FALSE)

suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(lavaan))
suppressPackageStartupMessages(library(tsibble))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(psych)) 
```

```{r setup, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

moduletwo <- read_excel(here::here("thesis_surveydata/political_factors_complete.xlsx"))
module2 <- data.frame(moduletwo)
module2[module2 == "Rather not say/ Don't know"] <- "Rather not say/Don't know"

# loaded data set for module 2 eco -pol variables and removes the rows with question number and question text
```

```{r, eval =TRUE, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#This chunk contains the coding schemes of various scales used in survey one: eco-political factors, kahan scale and acceptance scale
codedmodule2 <- module2 %>%
  
#remove row 1
  filter(!row_number() %in% c(1,2)) %>% 
  
# replace risky likert scale with numbers
  mutate_at(vars(starts_with("Risky")), funs(case_when(. =="Not at all risky" ~ 1, 
                                                       . =="Slightly risky" ~ 2, 
                                                       . =="Moderately risky" ~ 3, 
                                                       . =="Very risky" ~ 4, 
                                                       . =="Extremely risky" ~ 5))) %>%

# replace beneficial likert scale with numbers  
  mutate_at(vars(starts_with("Ben")), funs(case_when(. =="Not at all beneficial" ~ 1,
                                                     . =="Slightly beneficial" ~ 2,
                                                     . =="Moderately beneficial" ~ 3,
                                                     . =="Very beneficial" ~ 4,
                                                     . =="Extremely beneficial" ~ 5 ))) %>%

# replace nuclear acceptance likert scale with numbers
  mutate_at(vars(N_accept,N_reluctantlyaccept,N_reject), funs(case_when(. == "Strongly disagree" ~ 1, 
                                                                        . == "Somewhat disagree" ~ 2,
                                                                        . == "Neither agree nor disagree" ~3,
                                                                        . == "Somewhat agree" ~ 4,
                                                                        . == "Strongly agree" ~ 5))) %>%
  
# code likert scale for variables for Kahan scale into numbers
  mutate_at(vars(starts_with (c("K_I","K_H","DISPLACE", "POLLUTE", "HEALTH", "JOBS", "BEAUTY", "PRIDE", "NPRIDE", "DEV", "PROSPER", "RELY"))), funs(case_when(. == "Strongly disagree" ~ 1, 
               . == "Somewhat disagree" ~ 2,
               . == "Neither agree nor disagree" ~3,
               . == "Somewhat agree" ~ 4,
               . == "Strongly agree" ~ 5))) %>%
  
# reverse code for likert scale for variables for Kahan scale into numbers
  mutate_at(vars(starts_with (c("K_S","K_E"))), funs(case_when(. == "Strongly disagree" ~ 5, 
                                                               . == "Somewhat disagree" ~ 4,
                                                               . == "Neither agree nor disagree" ~3,
                                                               . == "Somewhat agree" ~ 2,
                                                               . == "Strongly agree" ~ 1))) %>%

# code eco-pol scale variables into numbers
  mutate_at(vars(SYSTEMDEMO,SYSTEMRELIGION,SYSTEMTECHNO,SYSTEMTOTAL,WEALTHLIM,MECHANISATION,DECISIONDECEN,INDUSTRYLARGE,ECONOMYGLOBAL,OWNERPVT,OWNERNOREG), funs(case_when(. == "Strongly disagree" ~ 1, 
                        . == "Somewhat disagree" ~ 2,
                        . == "Neither agree nor disagree" ~3,
                        . == "Somewhat agree" ~ 4,
                        . == "Strongly agree" ~ 5))) %>%

# reverse code eco-pol scale variables into numbers 
 mutate_at(vars(DECISIONCEN, INDUSTRYSMALL, ECONOMYLOCAL, ENVOVERDEV,OWNERPUB, OWNERREG), funs(case_when(. == "Strongly disagree" ~ 5, 
                                                                                                         . == "Somewhat disagree" ~ 4,
                                                                                                         . == "Neither agree nor disagree" ~3,
                                                                                                         . == "Somewhat agree" ~ 2,
                                                                                                         . == "Strongly agree" ~ 1))) %>%
  mutate_all(~ifelse(. == "Rather not say/ Don't know", "Rather not say/Don't know", .))%>%
  mutate_all(~ifelse(. == "West bengal", "West Bengal", .))%>%
  mutate_all(~ifelse(. == "WEST BENGAL", "West Bengal", .))%>%
  mutate_all(~ifelse(. == "Up", "Uttar Pradesh", .))%>%
  mutate_all(~ifelse(. == "Tamilnadu", "Tamil Nadu", .))%>%
  mutate_all(~ifelse(. == "UP", "Uttar Pradesh", .))
  

```


```{r, eval=TRUE, echo=FALSE}

moduleone <- read_excel(here::here("thesis_surveydata/livelihood_insecurity_complete.xlsx"))
module1 <- data.frame(moduleone)
# loaded data set for module 2 eco -pol variables and removes the rows with question number and question text
```


```{r, eval =TRUE, echo=FALSE}
#This chunk contains the coding schemes of various scales used in survey one: eco-political factors, kahan scale and acceptance scale
codedmodule1 <- module1 %>%

#remove row 1 and 2 
  filter(!row_number() %in% c(1,2)) %>% 
  
# replace risky likert scale with numbers
  mutate_at(vars(starts_with("Risky")), funs(case_when(. =="Not at all risky" ~ 1, 
                                                       . =="Slightly risky" ~ 2, 
                                                       . =="Moderately risky" ~ 3, 
                                                       . =="Very risky" ~ 4, 
                                                       . =="Extremely risky" ~ 5))) %>%

# replace beneficial likert scale with numbers  
  mutate_at(vars(starts_with("Ben")), funs(case_when(. =="Not at all beneficial" ~ 1,
                                                     . =="Slightly beneficial" ~ 2,
                                                     . =="Moderately beneficial" ~ 3,
                                                     . =="Very beneficial" ~ 4,
                                                     . =="Extremely beneficial" ~ 5 ))) %>%

# replace nuclear acceptance likert scale with numbers
  mutate_at(vars(N_accept,N_reluctantlyaccept,N_reject), funs(case_when(. == "Strongly disagree" ~ 1, 
                                                                        . == "Somewhat disagree" ~ 2,
                                                                        . == "Neither agree nor disagree" ~3,
                                                                        . == "Somewhat agree" ~ 4,
                                                                        . == "Strongly agree" ~ 5)))

```


```{r, echo = FALSE}

suppressPackageStartupMessages(library(tidyselect))
# combine codedmodule1 and codedmodule2

numcol2 <- codedmodule2 %>% add_column(Respondent = 1:1099, .before = "Language") 
numcol1 <- codedmodule1 %>% add_column(Respondent = 1099:2160, .before = "Language")

joineddf <-  full_join(numcol2, numcol1, by = c("Respondent", "Language", "Survey_Date", "State", "Risky_Hydro", "Risky_Solar", "Risky_Wind", "Risky_Nuclear", "Risky_Coal", "Risky_Gas", "Risky_Oil", "Risky_INDHydro", "Risky_INDSolar", "Risky_INDWind", "Risky_INDBiogas", "Risky_INDDiesel", "Risky_INDKerosene", "Risky_INDFirewoodetc", "Risky_INDLPG", "Ben_Hydro", "Ben_Solar", "Ben_Wind", "Ben_Nuclear", "Ben_Coal", "Ben_Gas", "Ben_Oil", "Ben_INDHydro", "Ben_INDSolar", "Ben_INDWind", "Ben_INDDiesel", "Ben_INDBiogas", "Ben_INDFirewoodetc", "Ben_INDLPG", "Ben_INDKerosene", "N_accept", "N_reluctantlyaccept", "N_reject", "age", "urban_rural", "gender", "caste", "religion", "religiontext")) 

numcolb <- module2 %>%   filter(!row_number() %in% c(1,2))%>% 
                        add_column(Respondent = 1:1099, .before = "Language") 
numcola <- module1 %>%   filter(!row_number() %in% c(1,2)) %>% 
                        add_column(Respondent = 1099:2160, .before = "Language")

uncodedjoineddf <- full_join(numcolb, numcola, by = c("Respondent", "Language", "Survey_Date", "State", "Risky_Hydro", "Risky_Solar", "Risky_Wind", "Risky_Nuclear", "Risky_Coal", "Risky_Gas", "Risky_Oil", "Risky_INDHydro", "Risky_INDSolar", "Risky_INDWind", "Risky_INDBiogas", "Risky_INDDiesel", "Risky_INDKerosene", "Risky_INDFirewoodetc", "Risky_INDLPG", "Ben_Hydro", "Ben_Solar", "Ben_Wind", "Ben_Nuclear", "Ben_Coal", "Ben_Gas", "Ben_Oil", "Ben_INDHydro", "Ben_INDSolar", "Ben_INDWind", "Ben_INDDiesel", "Ben_INDBiogas", "Ben_INDFirewoodetc", "Ben_INDLPG", "Ben_INDKerosene", "N_accept", "N_reluctantlyaccept", "N_reject", "age", "urban_rural", "gender", "caste", "religion", "religiontext")) %>%
  mutate_all(~ifelse(. == "Rather not say/ Don't know", "Rather not say/Don't know", .))%>%
  mutate_all(~ifelse(. == "West bengal", "West Bengal", .))%>%
  mutate_all(~ifelse(. == "WEST BENGAL", "West Bengal", .))%>%
  mutate_all(~ifelse(. == "Up", "Uttar Pradesh", .))%>%
  mutate_all(~ifelse(. == "Tamilnadu", "Tamil Nadu", .))%>%
  mutate_all(~ifelse(. == "UP", "Uttar Pradesh", .))

  

```

\newpage

# Characteristics of Sample

The following graph shows that distribution of different demographic variables in our sample of 2,160 from the combined dataset from both surveys. 

```{r, echo=FALSE}

library(dplyr)
library(tidyr)


sampledemos <- joineddf %>% select("State", "Language", "age", "urban_rural", "gender", "caste" ,"religion") %>%
              mutate_all(~ifelse(. == "Rather not say/ Don't know", "Rather not say/Don't know", .))%>%
              mutate_all(~ifelse(. == "OBC", "Other Backward Classes (OBC)", .))%>%
              mutate_all(~ifelse(. == "SC", "Scheduled caste (SC)", .))%>%
              mutate_all(~ifelse(. == "ST", "Scheduled tribe (ST)", .))%>%
              mutate_all(~ifelse(. == "MAR", "Marathi", .))%>%
              mutate_all(~ifelse(. == "TA", "Tamil", .)) %>%
              mutate_all(~ifelse(. == "EN", "English", .))%>%
              mutate_all(~ifelse(. == "BN", "Bengali", .))%>%
              mutate_all(~ifelse(. == "MAR", "Marathi", .))%>%
              mutate_all(~ifelse(. == "HI", "Hindi", .))%>%
              na.omit()

#changing factor levels for each variable from high to low n 

sampledemos$State <- factor(sampledemos$State, levels = c("Maharashtra","Rajasthan", "West Bengal" , "Tamil Nadu", "Uttar Pradesh"))
sampledemos$Language <- factor(sampledemos$Language, levels = c("Hindi","Marathi","Bengali","Tamil","English"))
sampledemos$age <- factor(sampledemos$age, levels = c( "18-24 years old" ,  "25-34 years old","35-44 years old", "45-54 years old", "55-64 years old","65-74 years old","75 years or older"  ))
sampledemos$urban_rural <- factor(sampledemos$urban_rural, levels = c("Rural","Urban"))
sampledemos$gender <- factor(sampledemos$gender, levels = c("Male","Female","Transgender/Transitioning","Rather not say"))
sampledemos$caste <- factor(sampledemos$caste, levels = c("Scheduled tribe (ST)", "Scheduled caste (SC)", "Other Backward Classes (OBC)", "General","Brahmin","Rather not say/Don't know"))
sampledemos$religion <- factor(sampledemos$religion, levels = c("Hinduism", "Islam", "Christanity","Buddhism" , "Sikhism", "Jainism","Agnostism/ Atheism","Other (Please mention)"))


```


```{r, echo=FALSE, fig.width=11, fig.height=14, out.width='70%', out.height='70%'}
library(dplyr)
library(tidyr)
library(ggplot2)
library(gridExtra)
library(forcats)

# Function to create bar plot
create_bar_plot <- function(data, variable_name) {
  data %>%
    filter(Variable == variable_name) %>%
    ggplot(aes(y = "", x = Percentage, fill = Category)) +
    geom_bar(position = "fill", stat = "identity", width = 1) +
    geom_text(aes(label = paste0(round(Percentage, 0), "%")), 
              position = position_fill(vjust = 0.5)) +
    scale_x_continuous(labels = scales::percent) +
    labs(y = NULL, x = "Percentage", fill = variable_name) +
    theme_classic() +
    theme(axis.text.y = element_blank(), strip.text = element_text(size = 8),  legend.position = "bottom")+
    scale_fill_brewer(palette = "Spectral")
}

# Gather data to long format and calculate counts and percentages
df_barplot <- sampledemos %>%
  gather(Variable, Category) %>%
  group_by(Variable, Category) %>%
  filter(!is.na(Category)) %>%
  summarise(n = n()) %>%
  mutate(Percentage = n / sum(n) * 100)

# Create separate plots for each variable
plot_state <- create_bar_plot(df_barplot, "State")
plot_language <- create_bar_plot(df_barplot, "Language")
plot_age <- create_bar_plot(df_barplot, "age")
plot_urban_rural <- create_bar_plot(df_barplot, "urban_rural")
plot_gender <- create_bar_plot(df_barplot, "gender")
plot_caste <- create_bar_plot(df_barplot, "caste")
plot_religion <- create_bar_plot(df_barplot, "religion")

# Combine the plots with spacing
combined_plot <- gridExtra::arrangeGrob(plot_state, plot_language, plot_age, plot_urban_rural, plot_gender, plot_caste, plot_religion, ncol = 1, heights = c(1, 1, 1, 1, 1, 1, 1))

# Print the combined plot
grid::grid.newpage()
grid::grid.draw(combined_plot)

# TO DO ---- add population distributions here. 

```



\newpage    

# State wise perceived risk and perceived benefit 

## Centrally managed energy technologies (n= 2160)
The percentages are rounded off to whole numbers. 

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Q1: how much is the awareness of energy technologies in India ? How does it relate to state specific data ? 
# summary of NA results from the combined sample of 2000 responses (simple percentage bar graphs)
# part 1- how much is the awareness of energy technologies in India - 


#plotting perceived risk from different technologies including rather not say don't know
colorsequence<- c("#8C4646","#D9695F","#F2A679","#F2D091","#5D8C7B","#808080")

#following is the data frame for making the barplot 
df_barplot <- uncodedjoineddf %>%
  dplyr::select(starts_with("RISKY"))%>%
  gather(Technology, Perceived_Risk, Risky_Hydro:Risky_INDLPG, factor_key = TRUE)%>%
  separate(Technology, c("Risky", "Technology"), extra = "merge", fill = "left")%>%
  dplyr::select(-Risky) %>% 
  group_by(Technology, Perceived_Risk) %>%
  dplyr::summarise(n=n())

#following data frame gives us percentage for each response 
df_barplot_percent<- df_barplot%>%
  group_by(Technology) %>%
  mutate(Percentage = round(n/sum(n)*100, 0)) %>%
  ungroup()

#plotting perceived benefit from different technologies including rather not say don't know

df_barplotben <- uncodedjoineddf %>%
  dplyr::select(starts_with("Ben"))%>%
  gather(Technology, Perceived_Benefit, Ben_Hydro:Ben_INDKerosene, factor_key = TRUE)%>%
  separate(Technology, c("Ben", "Technology"), extra = "merge", fill = "left")%>%
  dplyr::select(-Ben) %>% 
  group_by(Technology, Perceived_Benefit) %>%
  dplyr::summarise(n=n())

df_barplotben_percent<- df_barplotben%>%
  group_by(Technology) %>%
  mutate(Percentage = round(n/sum(n)*100, 0)) %>%
  ungroup()

#bar plot for likert responses perceived risk - centrally owned technologies 
df_barplot %>% ggplot(aes(fill= fct_rev(factor(Perceived_Risk, levels=c("Extremely risky", "Very risky","Moderately risky","Slightly risky","Not at all risky","Rather not say/Don't know"))), y=n , x=Technology)) + 
  geom_bar(position="fill",stat="identity")+
  geom_text(data = df_barplot_percent, aes(label=paste0(Percentage, "%"), y=n), position = position_fill(vjust=0.5), size=3) +
  scale_x_discrete(limits = c("Solar", "Wind" ,"Hydro", "Oil", "Coal","Gas", "Nuclear"))+
  scale_fill_manual("legend", values = c("Extremely risky" = "#8C4646", "Very risky" = "#D9695F", "Moderately risky" = "#F2A679", "Slightly risky" = "#F2D091","Not at all risky" = "#5D8C7B", "Rather not say/Don't know" = "grey94"))+
  labs( y = "Perceived Risk", x ="Centrally Managed Energy Technologies")+
  theme_classic()


#perceived benefit centrally owned technologies 

df_barplotben %>% ggplot(aes(fill= factor(Perceived_Benefit, levels=c("Rather not say/Don't know","Not at all beneficial","Slightly beneficial","Moderately beneficial","Very beneficial", "Extremely beneficial")), y=n , x=Technology)) + 
  geom_bar(position="fill",stat="identity")+
   geom_text(data = df_barplotben_percent, aes(label=paste0(Percentage, "%"), y=n), position = position_fill(vjust=0.5), size=3) +
  scale_fill_manual("legend", values = c("Rather not say/Don't know" = "grey94" ,"Not at all beneficial" = "orange","Slightly beneficial"="yellow" ,"Moderately beneficial" = "palegreen","Very beneficial"= "green3", "Extremely beneficial"= "green4"))+
  scale_x_discrete(limits = c("Solar", "Wind", "Hydro", "Oil", "Coal","Gas","Nuclear"))+
  labs( y = "Perceived Benefit", x ="Centrally Managed Energy Technologies")+
  theme_classic()

```

\newpage
## Individually/Community owned energy technologies (n= 2160)
The percentages are rounded off to whole numbers. 

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

#bar plot for likert responses perceived risk - individually owned technologies 
df_barplot %>% ggplot(aes(fill= fct_rev(factor(Perceived_Risk, levels=c("Extremely risky", "Very risky","Moderately risky","Slightly risky","Not at all risky","Rather not say/Don't know"))), y=n , x=Technology)) + 
  geom_bar(position="fill", stat = "identity")+
  geom_text(data = df_barplot_percent, aes(label=paste0(Percentage, "%"), y=n), position = position_fill(vjust=0.5), size=3) +
  scale_x_discrete(limits = c("INDSolar", "INDFirewoodetc","INDWind", "INDHydro", "INDDiesel" , "INDBiogas","INDKerosene", "INDLPG"))+
  scale_fill_manual("legend", values = c("Extremely risky" = "#8C4646", "Very risky" = "#D9695F", "Moderately risky" = "#F2A679", "Slightly risky" = "#F2D091","Not at all risky" = "#5D8C7B", "Rather not say/Don't know" = "grey94"))+
   labs( y = "Perceived Risk", x ="Individually Owned Energy Technologies")+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



#perceived benefit individually owned technologies 

df_barplotben %>% ggplot(aes(fill= factor(Perceived_Benefit, levels=c("Rather not say/Don't know","Not at all beneficial","Slightly beneficial","Moderately beneficial","Very beneficial", "Extremely beneficial")), y=n , x=Technology)) + 
  geom_bar(position="fill",stat="identity")+
   geom_text(data = df_barplotben_percent, aes(label=paste0(Percentage, "%"), y=n), position = position_fill(vjust=0.5), size=3) +
  scale_fill_manual("legend", values = c("Rather not say/Don't know" = "grey94" ,"Not at all beneficial" = "orange","Slightly beneficial"="yellow" ,"Moderately beneficial" = "palegreen","Very beneficial"= "green3", "Extremely beneficial"= "green4"))+
  scale_x_discrete(limits = c( "INDSolar", "INDFirewoodetc" , "INDLPG",  "INDWind", "INDHydro", "INDDiesel" , "INDBiogas","INDKerosene"))+
  labs( y = "Perceived Benefit", x ="Individually Owned Energy Technologies")+
  theme_classic()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


\newpage
# State Specific Differences. 

We see huge differences for perceived risk and perceived benefit for each technology from state to state. These graphs explore that. 
The number of respondents from each state are also reported below. 

## Perceived risk by State


```{r, echo=FALSE, fig.width=11, fig.height=14, out.width='80%', out.height='80%'}

# part 2: state specific data on perceived risk
state_risk <- uncodedjoineddf %>%
    dplyr::select(starts_with(c("RISKY", "State")))%>%
    gather(Technology, Perceived_Risk, Risky_Hydro:Risky_INDLPG, factor_key = TRUE)%>%
    separate(Technology, c("Risky", "Technology"), extra = "merge", fill = "left")%>%
    dplyr::select(-Risky) %>% 
    group_by(State, Technology, Perceived_Risk) %>%
    dplyr::summarise(n=n())

count<- uncodedjoineddf %>%
  dplyr::select(starts_with(c("RISKY", "State")))%>%
   group_by(State) %>%
  dplyr::summarise(n=n())

 state_risk_percent <- state_risk %>%
    group_by(Technology, State) %>%
    mutate(Percentage = round(n/sum(n)*100, 0)) %>%
    ungroup()
 
 # Create a named vector with the number of respondents for each state
respondents_per_state <- c("Maharashtra" = 653, "Rajasthan" = 677, "Tamil Nadu" = 320, "Uttar Pradesh" = 125, "West Bengal" = 386)

respondents_per_state

  
state_risk %>% ggplot(aes(fill= fct_rev(factor(Perceived_Risk, levels=c("Extremely risky", "Very risky","Moderately risky","Slightly risky","Not at all risky","Rather not say/Don't know"))), y=n , x=Technology)) + 
    geom_bar(position="fill",stat="identity")+
     geom_text(data = state_risk_percent, aes(label=paste0(Percentage, "%"), y=n), position = position_fill(vjust=0.5), size=5) +
    scale_x_discrete(limits = c("Solar", "Wind" ,"Hydro", "Oil", "Coal","Gas", "Nuclear"))+
    scale_fill_manual("legend", values = c("Extremely risky" = "#8C4646", "Very risky" = "#D9695F", "Moderately risky" = "#F2A679", "Slightly risky" = "#F2D091","Not at all risky" = "#5D8C7B", "Rather not say/Don't know" = "grey94"))+
    theme_classic()+ 
    facet_wrap(~ State, ncol = 2)+
    labs(x = "mean perceived risk", y = "energy technologies")+
    theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    theme(axis.text.x = element_text(angle = 45, hjust = 1, size=12),  # Increase x-axis text size
        axis.text.y = element_text(size=12),  # Increase y-axis text size
        strip.text = element_text(size=12))  # Increase facet label text size




```



\newpage

## Perceived Benefit by State

```{r, echo=FALSE, fig.width=12, fig.height=15, out.width='100%', out.height='100%'}
# part 2: state specific data on perceived benefit

state_ben <- uncodedjoineddf %>%
  select(starts_with(c("Ben", "State")))%>%
  gather(Technology, Perceived_Benefit, Ben_Hydro:Ben_INDKerosene, factor_key = TRUE)%>%
  separate(Technology, c("Ben", "Technology"), extra = "merge", fill = "left")%>%
  select(-Ben) %>% 
  group_by(State, Technology, Perceived_Benefit) %>%
  dplyr::summarise(n=n())

countben<- uncodedjoineddf %>%
  dplyr::select(starts_with(c("Ben", "State")))%>%
   group_by(State) %>%
  dplyr::summarise(n=n())

 
 # Create a named vector with the number of respondents for each state
respondents_per_state <- c("Maharashtra" = 653, "Rajasthan" = 677, "Tamil Nadu" = 320, "Uttar Pradesh" = 125, "West Bengal" = 386)

respondents_per_state

# Calculate percentages in each group
state_ben_percent <- state_ben %>%
  group_by(Technology, State) %>%
  mutate(Percentage = round(n/sum(n)*100, 0)) %>%
  ungroup()

#perceived benefit centrally owned technologies by state
state_ben %>% ggplot(aes(fill= factor(Perceived_Benefit, levels=c("Rather not say/Don't know","Not at all beneficial","Slightly beneficial","Moderately beneficial","Very beneficial", "Extremely beneficial")), y=n , x=Technology)) + 
  geom_bar(position="fill", stat = "identity")+
  geom_text(data = state_ben_percent, aes(label=paste0(Percentage, "%"), y=n), position = position_fill(vjust=0.5), size=5) +
  scale_fill_manual("legend", values = c("Rather not say/Don't know" = "grey94" ,"Not at all beneficial" = "orange","Slightly beneficial"="yellow" ,"Moderately beneficial" = "palegreen","Very beneficial"= "green3", "Extremely beneficial"= "green4"))+
  scale_x_discrete(limits = c("Solar", "Wind", "Hydro", "Oil", "Coal","Gas","Nuclear"))+
  theme_classic()+
  facet_wrap(~ State, ncol = 2)+
  labs(x = "mean perceived benefit", y = "energy technologies")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size=12), 
        axis.text.y = element_text(size=12), 
        strip.text = element_text(size=12))

```
\newpage

# How do perception of risk and perception of benefit compare with each other? 
  
  Mean Values are presented in the graphs below 

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# Q4: How do perception of risk and perception of benefit compare with each other? 

# what is this comparison telling us ? 

# summary statistics for risks from different energy sources
library(tidyverse)

# Filter variables of interest
joineddf_subset <- joineddf %>%
  dplyr::select(!starts_with(c("Ben_IND", "Risky_IND")))%>%
  select(starts_with("Risky"), 
         starts_with("Ben"))

# Melt the data frame to long format
long_format <- joineddf_subset %>% 
  pivot_longer(everything(), names_to = "technology", values_to = "value") %>%
  mutate(risk_or_benefit = if_else(str_detect(technology, "Risky"), "risk", "benefit"),
         technology = str_replace(technology, "Risky_|Ben_", ""))

# Calculate mean and sd for each technology and category (risk or benefit)
summary_df <- long_format %>%
  group_by(technology, risk_or_benefit) %>%
  summarise(mean = mean(value, na.rm = TRUE),
            sd = sd(value, na.rm = TRUE),
            .groups = "drop")


# Order technologies by mean risk
order_risk <- summary_df %>% 
  filter(risk_or_benefit == "risk") %>%
  arrange(mean) %>% 
  pull(technology)

# Change the levels of factor 'technology'
summary_df$technology <- factor(summary_df$technology, levels = order_risk)

# Plotting the data
ggplot(summary_df, aes(x = technology, y = mean, fill = risk_or_benefit)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd), width = 0.3, position = position_dodge(0.9)) +
  ylim(0, 5) +
  scale_fill_manual("legend", 
                    values = c("benefit" = "palegreen3", "risk" = "firebrick2"), 
                    labels = c("benefit" = "Perceived Benefit", "risk" = "Perceived Risk")) +
  labs(y = "Mean Values", x = "Energy Technologies", fill = "Perceived") +
  ggtitle("Perceived risk and benefit from centrally managed energy technologies") +
  coord_flip()


# add a star in front of all bars to show these differences are significant at 0.05 , also replace sd with standard error ()
```

\newpage

# T-tests 

## Pairwise T-test on mean perceived risk and benefit from energy technologies 

Q - How are the perceptions of the risk of producing energy from nuclear fission different from that of other conventional sources of energy like coal or hydro power in India?
H : Nuclear energy will be perceived as riskier than other sources of energy (coal or hydro) in India like in the west.

The p values from a pairwise t test are reported below 
The red and green pairs indicate that there is a statistically significant difference between the means of the two groups. 
White and grey indicate - no differences between the means of the two groups.

```{r, echo = FALSE, fig.width=14, fig.height=6}
#Q2 :How are the perceptions of the risk of producing energy from nuclear fission different from that of other conventional sources of energy like coal or hydro power in India?
#H : Nuclear energy will be perceived as riskier than other sources of energy (coal or hydro) in India like in the west.

perceivedriskc <-joineddf %>% select("Risky_Solar", "Risky_Hydro", "Risky_Wind", "Risky_Nuclear", "Risky_Coal", "Risky_Gas", "Risky_Oil") %>%
  gather(key = "technology", value = "perceived_risk") %>% 
  mutate(technology = gsub("Risky_", "", technology)) %>%
  na.omit()

result_ttest <- pairwise.t.test(perceivedriskc$perceived_risk, perceivedriskc$technology, p.adjust.method = "BH")

# visualising the pairwaise t test results. the non significant pairs are grey 

tidy_result_ttest <- broom::tidy(result_ttest)

heatmap1 <- ggplot(tidy_result_ttest, aes(x = group1, y = group2, fill = p.value)) + 
  geom_tile(color = "white") + 
  scale_fill_gradient2(low = "firebrick2", high = "white", midpoint = 0.025, 
                       limits = c(0, 0.05), space = "Lab", 
                       name = "P-value") + 
  theme_classic() + 
  labs(x = "Technology 1", y = "Technology 2") + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

#Question- Why there is significant difference statistically - if the medians are the same in the boxplot.
#Q3: How do perceptions of benefit from nuclear energy compare with other source of energy? 

# H : benefits from all energy technologies will be similar 
# include regression, heat maps, bar graphs? - decide which ones are good to include

perceivedbenefitc <-joineddf %>% select("Ben_Solar", "Ben_Hydro", "Ben_Wind", "Ben_Nuclear", "Ben_Coal", "Ben_Gas", "Ben_Oil") %>%
  gather(key = "technology", value = "perceived_benefit") %>% 
  mutate(technology = gsub("Ben_", "", technology)) %>%
  na.omit()


result_ttestben <- pairwise.t.test(perceivedbenefitc$perceived_benefit, perceivedbenefitc$technology, p.adjust.method = "BH")

# visualising the pairwaise t test results. the non significant pairs are grey 

tidy_resultbc <- broom::tidy(result_ttestben)

library(ggplot2)
heatmap2 <- ggplot(tidy_resultbc, aes(x = group1, y = group2, fill = p.value)) + 
  geom_tile(color = "white") + 
  scale_fill_gradient2(low = "palegreen3", high = "white", midpoint = 0.025, 
                       limits = c(0, 0.05), space = "Lab", 
                       name = "P-value") + 
  theme_classic() + 
  labs(x = "Technology 1", y = "Technology 2") + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1))


grid.arrange(heatmap1, heatmap2, ncol=2)

```



## Results from Paired t test used to compare the mean perceived risk and mean perceived benefit from each technology. 
Null hypothesis (H0): The mean difference between perceived risk and perceived benefit from each technology is zero.

All p values are less than 0.05 suggesting that the differences observed above in the graph are statistically significant. 

```{r, echo=FALSE}

# Convert character columns to factors
long_format$technology <- factor(long_format$technology)
long_format$risk_or_benefit <- factor(long_format$risk_or_benefit)

# Perform the t- Test for each technology
p_values <- long_format %>%
  split(.$technology) %>%
  lapply(function(x) t.test(x$value[x$risk_or_benefit == "risk"], x$value[x$risk_or_benefit == "benefit"], paired = TRUE)) %>%
  lapply(function(x) x$p.value)


p_values

```

# Perceived Benefit - Perceived Risk 

```{r, echo = FALSE}


# combining risk and benefit from each energy technology 

acceptance <- joineddf_subset %>%
  na.omit()%>%
  mutate(Nuclear = Ben_Nuclear - Risky_Nuclear,
         Hyrdo = Ben_Hydro - Risky_Hydro,
         Wind = Ben_Wind - Risky_Wind,
         Solar = Ben_Solar - Risky_Solar,
         Coal = Ben_Coal - Risky_Coal,
         Gas = Ben_Gas - Risky_Gas,
         Oil = Ben_Oil - Risky_Oil)%>%
  select(-starts_with(c("Risky", "Ben")))

str(acceptance)


# Compute the mean of each column
mean_acceptance <- data.frame(col = names(acceptance), mean_val = sapply(acceptance, mean))

# Compute standard error (not deviation)(divided by root of n)
sem <- function(x) sqrt(var(x, na.rm = TRUE) / length(na.omit(x)))
sem_acceptance <- data.frame(col = names(acceptance), sem_val = sapply(acceptance, sem))

mean_acceptance <- merge(mean_acceptance, sem_acceptance, by = "col")


# Plot
ggplot(mean_acceptance, aes(x = col, y = mean_val, fill = ifelse(mean_val >= 0, 'Above 0', 'Below 0'))) + 
  geom_bar(stat = "identity") +
  geom_errorbar(aes(ymin = mean_val - sem_val, ymax = mean_val + sem_val), width = 0.2) +
  geom_text(aes(label = round(mean_val, 2)), vjust = -0.9) +
  scale_fill_manual(values = c('Above 0' = 'palegreen3', 'Below 0' = 'firebrick2')) +
  labs(fill = "Legend") +
  xlab("Energy Technologies") +
  ylab("Mean Value") +
  ggtitle("Benefit- Risk for Each Energy Technology") +
  theme_minimal()+
  ylim(-0.5, 1.75)




```



\newpage

# Factor Analysis: Kahan Scale 

Factor Levels for demographic variables - State, age, gender, urban_rural, caste and religion
First level in each of the variables is the reference for linear regression models. 

```{r, echo = FALSE}
# Q5: Is there a parallel to white-male effect in India ? Upper-caste Hindu male effect? 
# regression with categorical variable Upper-cast Hindu male and others - look into how Kahan did it

# 1- running linear regression for demographic variable - state, age, gender, urban_rural, caste and religion

codedmodule2$State <- as.factor(codedmodule2$State)
levels(codedmodule2$State)

codedmodule2$age <- as.factor(codedmodule2$age)
levels(codedmodule2$age)

codedmodule2$gender <- as.factor(codedmodule2$gender)
levels(codedmodule2$gender)

codedmodule2$Urban <- as.factor(codedmodule2$urban_rural)
levels(codedmodule2$Urban)

joineddf$Urban <- as.factor(joineddf$urban_rural)
levels(joineddf$Urban)

codedmodule2$caste <- as.factor(codedmodule2$caste)
levels(codedmodule2$caste)

codedmodule2$religion <- as.factor(codedmodule2$religion)
levels(codedmodule2$religion)

# Pre-calculate the counts
count_data <- codedmodule2 %>%
  group_by(age, Risky_Nuclear) %>%
  summarize(count = n())

# Plot using the count column
#ggplot(count_data, aes(x = age, y = Risky_Nuclear, size = count)) +
  #labs(y = "Age categories", x = "perceived risk from nuclear energy") +
  #geom_point()

# # Convert `caste` into binary variable 'upper' (1) vs 'non-upper' (0)
joineddf$Uppercaste <- ifelse(joineddf$caste %in% c('Brahmin', 'General'), 1, 0)

# Convert `gender` into binary variable 'male' (1) vs 'female' (0)
joineddf$Male <- ifelse(joineddf$gender == 'Male', 1, 0)

# Convert `religion` into binary variable 'Hinduism' (1) vs 'Non-Hinduism' (0)
joineddf$Hindu <- ifelse(joineddf$religion == 'Hinduism', 1, 0)

# # Convert `caste` into binary variable 'upper' (1) vs 'non-upper' (0)
codedmodule2$Uppercaste <- ifelse(codedmodule2$caste %in% c('Brahmin', 'General'), 1, 0)

# Convert `gender` into binary variable 'male' (1) vs 'female' (0)
codedmodule2$Male <- ifelse(codedmodule2$gender == 'Male', 1, 0)

# Convert `religion` into binary variable 'Hinduism' (1) vs 'Non-Hinduism' (0)
codedmodule2$Hindu <- ifelse(codedmodule2$religion == 'Hinduism', 1, 0)


# most of these results indicate that there is no significant white male effect or upper caste male effect for risk perception from nuclear energy in India. 
# the coefficients are very small and so is the r squared - rsquared is minimal. 

```


Before fitting a linear regression model, I conducted factor analysis on the Kahan scale and the newly developed economic-political value scale. The results from the Factor Analysis are below. 

The Individualism items (indicated by K_I) were bringing down the cronbach's alpha values in the Kahan scale. The Alpha for INdividualism- Communitarian scale was 0.49. After removing the Individualism items (K_I) the alpha for this factor was 0.71. The reasons for this could be that the individualism items are not well adapted to the Indian population. 

I conducted confirmatory factor analysis (CFA) for the  Kahan scale (see Appendix 1) since this a well used scale with theoretical basis for factor distinctions and also previous studies have used this scale.  

```{r, echo=FALSE}
# Q6: Does the Kahan scale explain perception of risk from nuclear energy and other DVs ? 

# we conducted fa on the kahan scale 
# CFA for Kahan scale. We shouldn't do FA here since this a well used scale with theoretical basis for factor distinctions and also previous studies using the same scale 

library(lavaan)

fascales <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_","Risky_Nuclear","WEALTHLIM","MECHANISATION","DECISIONDECEN","DECISIONCEN","INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL","ECONOMYLOCAL", "ENVOVERDEV","DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG","DISPLACENUCLEAR",  "POLLUTENUCLEAR", "HEALTHNUCLEAR", "JOBSNUCLEAR", "BEAUTYNUCLEAR", "PRIDENUCLEAR", "NPRIDENUCLEAR", "DEVNUCLEAR", "PROSPERNUCLEAR", "RELYNUCLEAR", "Uppercaste", "Male", "Hindu", "Urban", "State","age")))%>%
  na.omit()

Kahan_fas <- '
  KahanS =~ K_SHARM + K_SLIMCHOI + K_SPROTECT 
  KahanH =~ K_HEQUAL+ K_ERADEQ1 + K_EWEALTH + K_ERADEQ2
'

# Run CFA
Kahan_cfa <- cfa(Kahan_fas, data = fascales, std.lv = TRUE)

# Print the summary of the CFA results, including fit measures
summary(Kahan_cfa, fit.measure= TRUE, standardized = TRUE)

# RMSEA - between 0.05 and 0.08 (reasonable fit), less than 0.05 close fit and greater than 0.10 is poor fit 
# CFI - greater than 0.90 or 0.95 indicates good fit
#TFI - CFI>TFI >0.90 - indicates good fit
#pvalue should be greater than 0.05 p > 0.0.5


# after having removed a few variables that had very low loading, the model is now a good fit, we have two latent variables - Hierarchy- egalitarian and Communitarian. Again we see that individualistic variables just don't fit here. 

# creating table of factor scores 

Kahan_scores <- predict(Kahan_cfa, newdata = fascales)

Kahan_Kscores <- cbind(fascales, Kahan_scores)

## RMSEA is still pretty big. 


```



RMSEA - between 0.05 and 0.08 (reasonable fit), less than 0.05 close fit and greater than 0.10 is poor fit 
CFI - greater than 0.90 or 0.95 indicates good fit
TFI - CFI>TFI >0.90 - indicates good fit


After having removed a few variables that had very low loading, the model is now a good fit. Some of the Individualistic variables just don't fit. Final scale variables:

KahanS(Individualism - Communitarian) = K_SHARM + K_SLIMCHOI + K_SPROTECT 
KahanH(Hierarchy- Egalitarian) =K_HEQUAL+ K_ERADEQ1 + K_EWEALTH + K_ERADEQ2

The Cronabch alpha for this final scale was 0.75. 
 
\newpage

# Factor Analysis: New Eco-political Scale

Then I conducted Factor Analysis on all eco-political values(see Appendix 2). The Cronbach's alpha for the scale was high at 0.785 (almost 0.8). 

The scale reduced to two factors which I named as 1) People Centered Development and 2) Nationalist Development.
The final scale with two factors include the following 

**MR1 People Centered Development: Pdevelop**

HEALTHNUCLEAR	-  Nuclear energy poses a great risk to the health of people living around it.

BEAUTYNUCLEAR	-  Nuclear energy spoils the natural beauty of the landscape.

MECHANISATION	-  Rapid mechanization of work is taking away jobs from workers in this country.

INDUSTRYSMALL	-  Large corporations are destroying the local industries in India and benefiting only a handful of people.

DISPLACENUCLEAR- Nuclear energy is leading to displacement of people from their land.

POLLUTENUCLEAR-  Nuclear energy increases pollution of air/water/land. 

OWNERREG-        Regardless of ownership, the government should pass strong regulations and implement them.


**MR2 Nationalist Development: Ndevelop**

DEVNUCLEAR	-  Nuclear energy pushes forward the country's development.

PRIDENUCLEAR-  I would be proud if my community used nuclear energy.

NPRIDENUCLEAR- Nuclear energy is a mark of pride for our nation.

PROSPERNUCLEAR-Nuclear energy brings economic prosperity to the surrounding regions.

INDUSTRYLARGE- Large scale industries are required for the development of the country that will benefit everyone.

The results of the factor analysis are below: 

```{r, echo=FALSE}

ecopolall <- fascales %>%
        dplyr::select("WEALTHLIM","MECHANISATION","DECISIONDECEN","DECISIONCEN","INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL","ECONOMYLOCAL", "ENVOVERDEV","DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG","DISPLACENUCLEAR",  "POLLUTENUCLEAR", "HEALTHNUCLEAR", "JOBSNUCLEAR", "BEAUTYNUCLEAR", "PRIDENUCLEAR", "NPRIDENUCLEAR", "DEVNUCLEAR", "PROSPERNUCLEAR", "RELYNUCLEAR")

ecopolall_alpha <- psych::alpha(ecopolall, check.keys = TRUE)

summary(ecopolall_alpha)

# when we combine both the scales the alpha is high at 0.785 (almost 0.8)

# FA on all ecopol variables except systems of governance 

ecopolall_cor <- cor(ecopolall)
PCA24 <- principal(ecopolall, nfactors = 24, rotate = "none") # no rotation to start with. 

#PCA24$loadings

#fa.parallel(ecopolall_cor)

# this suggests 2 factors if we go by FA or 8 by PCA. let's try both and see how they look conceptually 

ecopolall2.fa <- fa(ecopolall, nfactors = 2, rotate = "varimax")

print.psych(ecopolall2.fa, cut = 0.30, sort = TRUE)

#fa.diagram(ecopolall2.fa)

#cor(ecopolall)

# I don't know still doesn't make a lot of sense to me- the two factors make more sense - 1) people centered development 2) nationalist development

# So I am going to extract factor scores and bind them to the dataset

ecopolall_scores <- psych::factor.scores(ecopolall, ecopolall2.fa)

# The factor scores will be stored in the scores element of the returned list
scores1 <- ecopolall_scores$scores

#binding factor scores to the dataset

fascale_scores <- cbind(Kahan_Kscores, scores1) %>%
  rename(Pdevelop = MR1)%>%
  rename(Ndevelop = MR2) %>%
  select(!starts_with(c("K_","WEALTHLIM","MECHANISATION","DECISIONDECEN","DECISIONCEN","INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL","ECONOMYLOCAL", "ENVOVERDEV","DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG","DISPLACENUCLEAR",  "POLLUTENUCLEAR", "HEALTHNUCLEAR", "JOBSNUCLEAR", "BEAUTYNUCLEAR", "PRIDENUCLEAR", "NPRIDENUCLEAR", "DEVNUCLEAR", "PROSPERNUCLEAR", "RELYNUCLEAR")))

# 3 linear models - 1) lm with demographic variables except age and State
m1_demo <- lm(Risky_Nuclear ~ Uppercaste + Male + Hindu + Urban, data = fascale_scores)
# Print model summary
summary(m1_demo)
plot(m1_demo)

# lm suggests there is no significant white male effect or upper caste male effect for risk perception from nuclear energy in India. 
# the coefficients are very small and so is the r squared - rsquared is minimal. 

# 2) lm with all demographic variables
m2_demo<- lm(Risky_Nuclear ~ Uppercaste + Male + Hindu + Urban + age + State, data = fascale_scores)
# Print model summary
summary(m2_demo)
plot(m2_demo)

# States and some age have some impact on y variable. 

# 3) lm with kahan 
m1_kahan <- lm(Risky_Nuclear ~ Uppercaste + Male + Hindu + Urban + age + State + KahanS + KahanH , data = fascale_scores)
# Print model summary
summary(m1_kahan)
plot(m1_kahan)

# 4) lm with ecopolvars 
m1_allscales <- lm(Risky_Nuclear ~ Uppercaste + Male + Hindu + Urban + age + State+ KahanS + KahanH + Pdevelop + Ndevelop, data = fascale_scores)
# Print model summary
summary(m1_allscales)
plot(m1_allscales)

```
\newpage
# Nuclear Energy - Linear Regression models 

## Linear Regression model with all demographic variables

```{r, echo=FALSE}

alldemos <- joineddf %>%
            select(Risky_Nuclear,Uppercaste, Male, Hindu, Urban, age, State)%>%
            na.omit()

alldemoslm1 <- lm(Risky_Nuclear ~ Uppercaste + Male + Hindu + Urban, data = alldemos)
# Print model summary
#summary(alldemoslm1)
#plot(alldemoslm1)

# lm suggests there is no significant white male effect or upper caste male effect for risk perception from nuclear energy in India. 
# the coefficients are very small and so is the r squared - rsquared is minimal. 

# 2) lm with all demographic variables
alldemoslm2<- lm(Risky_Nuclear ~ Uppercaste + Male + Hindu + Urban + age + State, data = alldemos)
# Print model summary
#summary(alldemoslm2)
#plot(alldemoslm1)


```

```{r, echo=FALSE, results='asis'}
library(stargazer)


cat("\\begingroup")
cat("\\setlength{\\tabcolsep}{1pt}")
cat("\\renewcommand{\\arraystretch}{0.7}")
stargazer(alldemoslm1, alldemoslm2, 
          title = "Results from 2 linear regression models",
          type = "latex"
)
cat("\\endgroup")


```


# Linear Regression: 4 Models.

Then I ran 4 linear regression models adding more variables every time. The results of the linear regression models are below. 


```{r, echo=FALSE, results='asis'}
library(stargazer)


cat("\\begingroup")
cat("\\setlength{\\tabcolsep}{1pt}")
cat("\\renewcommand{\\arraystretch}{0.7}")
stargazer(m1_demo, m2_demo, m1_kahan, m1_allscales, 
          title = "Results from 4 linear regression models",
          type = "latex"
)
cat("\\endgroup")


```



Key observations:


**1. Demographic effects:** The impact of demographic characteristics on the perceived risk from Nuclear Energy appears to be small. The adjusted R-squared of the first model, which includes only demographic variables, is 0.023, indicating that these variables explain just over 2% of the variance in perceived risk.

**2. Age effects:** In Model 2, where age groups are added, there is a distinct change in the perceived risk from nuclear energy as age increases. Interestingly, only the age group 65-74 shows a significant increase in perceived risk, compared to the reference age group (18-25 years). 

**3. Gender effects:** In the initial model, being male is positively associated with higher perceived risk from nuclear energy. However, the significance of this association diminishes when age and state variables are included in the model, suggesting that the relationship between gender and perceived risk may be influenced by these factors.

**4. State effects:** Both exploratory visualizations and regression models strongly suggest that the respondents' state of residence significantly influences their perceived risk from nuclear energy. The comparison state is Maharashtra. The coefficients for the other states can be interpreted as the difference in perceived risk from each state compared to Maharashtra, holding all else constant.

**5. Kahan scale effects:** Among the Kahan scale variables, only the individualism factor is statistically significant in the third model. This suggests that individuals scoring high on the individualism scale perceive nuclear energy as less risky.

**6. Eco-political scale effects:** When we introduce the eco-political scale, the effect of the individualism factor from the Kahan scale loses its significance. This could suggest that the eco-political scale is capturing some aspect of the risk perception related to individualism. The two factors of the eco-political scale both have a statistically significant impact on the perceived risk, indicating that these eco-political beliefs play an important role in shaping risk perceptions. 


\newpage

# Solar Energy - Linear Regression models 

```{r, echo=FALSE}

salldemos <- joineddf %>%
            select(Risky_Solar,Uppercaste, Male, Hindu, Urban, age, State)%>%
            na.omit()

salldemoslm1 <- lm(Risky_Solar ~ Uppercaste + Male + Hindu + Urban, data = salldemos)
# Print model summary
summary(salldemoslm1)
#plot(alldemoslm1)

# lm suggests there is no significant white male effect or upper caste male effect for risk perception from nuclear energy in India. 
# the coefficients are very small and so is the r squared - rsquared is minimal. 

# 2) lm with all demographic variables
salldemoslm2<- lm(Risky_Solar ~ Uppercaste + Male + Hindu + Urban + age + State, data = salldemos)
# Print model summary
summary(salldemoslm2)
#plot(alldemoslm1)


```




```{r, echo=FALSE, results='asis'}
library(stargazer)

#stargazer code for all demographic variable lms 


cat("\\begingroup")
cat("\\setlength{\\tabcolsep}{1pt}")
cat("\\renewcommand{\\arraystretch}{0.7}")
stargazer(salldemoslm1, alldemoslm2, 
          title = "Results from 2 linear regression models",
          type = "latex"
)
cat("\\endgroup")


```


```{r, echo = FALSE}
# kahan scores for solar 
sfascales <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_","Risky_Solar","WEALTHLIM","MECHANISATION","DECISIONDECEN","DECISIONCEN","INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL","ECONOMYLOCAL", "ENVOVERDEV","DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG","DISPLACESOLAR",  "POLLUTESOLAR", "HEALTHSOLAR", "JOBSSOLAR", "BEAUTYSOLAR", "PRIDESOLAR", "NPRIDESOLAR", "DEVSOLAR", "PROSPERSOLAR", "RELYSOLAR", "Uppercaste", "Male", "Hindu", "Urban", "State","age")))%>%
  na.omit()

sKahan_fas <- '
  KahanS =~ K_SHARM + K_SLIMCHOI + K_SPROTECT 
  KahanH =~ K_HEQUAL+ K_ERADEQ1 + K_EWEALTH + K_ERADEQ2
'

# Run CFA
sKahan_cfa <- cfa(sKahan_fas, data = sfascales, std.lv = TRUE)

# Print the summary of the CFA results, including fit measures
#summary(sKahan_cfa, fit.measure= TRUE, standardized = TRUE)

# RMSEA - between 0.05 and 0.08 (reasonable fit), less than 0.05 close fit and greater than 0.10 is poor fit 
# CFI - greater than 0.90 or 0.95 indicates good fit
#TFI - CFI>TFI >0.90 - indicates good fit
#pvalue should be greater than 0.05 p > 0.0.5


# after having removed a few variables that had very low loading, the model is now a good fit, we have two latent variables - Hierarchy- egalitarian and Communitarian. Again we see that individualistic variables just don't fit here. 

# creating table of factor scores 

sKahan_scores <- predict(sKahan_cfa, newdata = sfascales)

sKahan_Kscores <- cbind(sfascales, sKahan_scores)

## RMSEA is still pretty big. 


```


```{r}
secopolall <- sfascales %>%
        dplyr::select("WEALTHLIM","MECHANISATION","DECISIONDECEN","DECISIONCEN","INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL","ECONOMYLOCAL", "ENVOVERDEV","DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG","DISPLACESOLAR",  "POLLUTESOLAR", "HEALTHSOLAR", "JOBSSOLAR", "BEAUTYSOLAR", "PRIDESOLAR", "NPRIDESOLAR", "DEVSOLAR", "PROSPERSOLAR", "RELYSOLAR")

secopolall_alpha <- psych::alpha(secopolall, check.keys = TRUE)

summary(secopolall_alpha)

# when we combine both the scales the alpha is high at 0.785 (almost 0.8)

# FA on all ecopol variables except systems of governance 

secopolall_cor <- cor(secopolall)
PCA24 <- principal(secopolall, nfactors = 24, rotate = "none") # no rotation to start with. 

#PCA24$loadings

#fa.parallel(ecopolall_cor)

# this suggests 2 factors if we go by FA or 8 by PCA. let's try both and see how they look conceptually 

secopolall2.fa <- fa(secopolall, nfactors = 2, rotate = "varimax")

print.psych(secopolall2.fa, cut = 0.30, sort = TRUE)
```


# Regression with acceptance scale? - explore


\newpage

#   Perceived risk by Support for Democratic government

```{r, echo=FALSE}

# **Perceived risk by Support for Democratic government**

#The following is a list of statements about governance. How strongly do you agree or disagree with each of these statements? Do you strongly disagree(1), somewhat disagree(2), neither agree nor disagree(3), somewhat agree(4) or strongly agree(5)? - It is very important to have a democratic political system because it ensures that no individual leader has too much power.

govtrisk <- codedmodule2 %>%
  select( Risky_Hydro, Risky_Solar, Risky_Wind, Risky_Nuclear, Risky_Coal, Risky_Gas, Risky_Oil, SYSTEMDEMO, SYSTEMTECHNO, SYSTEMRELIGION, SYSTEMTOTAL)

govtrisk$grouped_demo <- ifelse(govtrisk$SYSTEMDEMO %in% c(1,2), "low", ifelse(govtrisk$SYSTEMDEMO %in% c(4,5), "high", NA))

demorisk2 <- govtrisk %>%
  group_by(grouped_demo) %>%
  filter(grouped_demo %in% c("low", "high")) %>%
  summarize_at(vars(starts_with(c("RISKY"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  gather(key = "technology", value = "summary", Risky_Hydro_mean, Risky_Solar_mean, Risky_Wind_mean, Risky_Nuclear_mean, Risky_Coal_mean, Risky_Gas_mean, Risky_Oil_mean, Risky_Hydro_sd, Risky_Solar_sd, Risky_Wind_sd, Risky_Nuclear_sd, Risky_Coal_sd, Risky_Gas_sd, Risky_Oil_sd, Risky_Hydro_n, Risky_Solar_n, Risky_Wind_n, Risky_Nuclear_n, Risky_Coal_n, Risky_Gas_n, Risky_Oil_n) %>%
  dplyr::select(grouped_demo, technology, summary) %>%
  separate(technology, c("Risky", "var"), extra = "merge", fill = "left") %>%
  separate(var, c("technology", "meansd")) %>%
  spread(meansd,summary) %>%
  select(-Risky) %>%
  arrange(grouped_demo) 

data.frame(demorisk2)

demorisk2 <- demorisk2 %>%
  mutate(technology = reorder(technology, -mean))  # reorder based on -mean, to get high to low

d <- demorisk2 %>%
  group_by(technology) %>%
  ggplot(aes(x = technology, y= mean, group = grouped_demo))+
  geom_line(aes(colour = grouped_demo, line = grouped_demo)) +
  labs(y = "mean perceived risk", x = "energy technology", color = "Democratic Value") +
  ggtitle("Q:It is very important to have a democratic political system because\nit ensures that no individual leader has too much power.")

d
# High - agree and strongly agree, low - disagree and strongly disagree



```

```{r}
# logistic regression here fro democratic thing 
```



\newpage
# Appendix1 

**Kahan et al (2007) scale**

Individualism - Communitarinism 

- **K_IINTRFER**	The government interferes far too much in our everyday lives.
- **K_IPRIVACY**	The government should stop telling people how to live their lives.
- **K_IPROTECT**	Its not the governments business to try to protect people from themselves.
- **K_SHARM**	    Sometimes the government needs to make laws that keep people from hurting themselves.
- **K_SLIMCHOI**	The government should put limits on the choices individuals can make so they dont get in the way of whats good for society.
- **K_SPROTECT**	The government should do more to advance societys goals, even if that means limiting the freedom and choices of individuals.

Hierarchy -Egalitarianism

- **K_HEQUAL**	  We have gone too far in pushing equal rights in this country.
- **K_HREVDIS1**	Nowadays it seems like there is just as much discrimination against upper castes as there is against Dalits.
- **K_EDISCRIM**	Discrimination against minorities is still a very serious problem in our society.
- **K_ERADEQ1**	  We need to dramatically reduce inequalities between the rich and the poor.
- **K_EWEALTH**	  Our society would be better off if the distribution of wealth was more equal.
- **K_ERADEQ2**	  We need to dramatically reduce inequalities between men and women.

\newpage
# Appendix2 

 **New Eco-pol values scale**
 
- **DISPLACENUCLER** Nuclear energy is leading to displacement of people from their land
- **BEAUTYNUCLEAR**	 Nuclear energy spoils the natural beauty of the landscape
- **POLLUTENUCLEAR** Nuclear energy increases pollution of air/water/land
- **HEALTHNUCLEAR**	 Nuclear energy poses a great risk to the health of people living around it
- **JOBSNUCLEAR**	   Nuclear energy will bring jobs to the local community
- **PRIDENUCLEAR**	 I would be proud if my community used nuclear energy
- **NPRIDENUCLEAR**	 Nuclear energy is a mark of pride for our nation
- **DEVNUCLEAR**	   Nuclear energy pushes forward the country's development
- **PROSPERNUCLEAR** Nuclear energy brings economic prosperity to the surrounding regions
- **RELYNUCLEAR**	   I don't like the idea that I have to rely on the government for electricity from nuclear energy

- **DECISIONDECEN**	 Local politicians shouldn't have to ask permission from the central government to implement policies
- **DECISIONCEN**	   Laws and policies would be implemented more smoothly if more power lay with the central government.
- **INDUSTRYLARGE**	 Large scale industries are required for the development of the country that will benefit everyone
- **ECONOMYLOCAL**	 India would be better off if foreign companies didn't come to here
- **DEVOVERENV**	   Economic growth and creating jobs should be prioritized over environmental protection
- **INDUSTRYSMALL**	 Large corporations are destroying the local industries in India and benefiting only a handful of people.
- **WEALTHLIM**	     A limit should be put to how much wealth a person can amass
- **ECONOMYGLOBAL**	 Foreign companies have led to a range of benefits for the Indian people and society
- **OWNERPVT**	     All businesses and industries should be owned privatel
- **OWNERPUB**	     The government should own most large businesses and industrie
- **ENVOVERDEV**	   Polluting industries that spoil the environment should be shut down even if it costs people their jo
- **OWNERREG**	     Regardless of ownership, the government should pass strong regulations and implement them
- **MECHANISATION**	 Rapid mechanization of work is taking away jobs from workers in this country
- **OWNERNOREG**	   There is too much red-tape and the government should not interfere with businesses and industries


```{r, echo=FALSE}
# Q7 : political values scale - factor analysis - reduce dimensions and then run regression -logistic regression 
# Using logistic regression for the SYSTEM prefixed variables. 

#codedmodule2
#codedmodule2$SYSTEMDEMO <- as.factor(codedmodule2$SYSTEMDEMO)
#levels(codedmodule2$SYSTEMDEMO)

#codedmodule2$SYSTEMRELIGION <- as.factor(codedmodule2$SYSTEMRELIGION)
#levels(codedmodule2$SYSTEMRELIGION)

#codedmodule2$SYSTEMTOTAL <- as.factor(codedmodule2$SYSTEMTOTAL)
#levels(codedmodule2$SYSTEMTOTAL)

#codedmodule2$SYSTEMTECHNO <- as.factor(codedmodule2$SYSTEMTECHNO)
#levels(codedmodule2$SYSTEMTECHNO)

#codedmodule2$Risky_Nuclear <- as.factor(codedmodule2$Risky_Nuclear)
#levels(codedmodule2$Risky_Nuclear)

#fitrisky_nucleargm <- with(codedmodule2, clm(Risky_Nuclear ~ 1 + SYSTEMDEMO + SYSTEMRELIGION + SYSTEMTOTAL + SYSTEMTECHNO))


```








