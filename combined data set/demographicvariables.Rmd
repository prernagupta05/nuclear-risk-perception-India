---
title: "Demographic Variables Plotted Against DVs(combined dataset)"
output:
  html_document:
    fig_width: 9
    fig_height: 6
    fig_caption: yes
    keep_md: yes
    theme: paper
    df_print: paged
  pdf_document: 
    
    toc: yes
    number_sections: yes
    toc_depth: 2
    fig_width: 9
    fig_height: 6
    fig_caption: yes
---

```{r load packages, warning = FALSE, message = FALSE, echo=FALSE}
  knitr::opts_chunk$set(warning = FALSE, message = FALSE)

suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(ggplot2))

```


```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
moduletwo <- read_excel(here::here("thesis_surveydata/political_factors_complete.xlsx"))
module2 <- data.frame(moduletwo)
module2[module2 == "Rather not say/ Don't know"] <- "Rather not say/Don't know"

# loaded data set for module 2 eco -pol variables and removes the rows with question number and question text
```


```{r, eval =TRUE, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#This chunk contains the coding schemes of various scales used in survey one: eco-political factors, kahan scale and acceptance scale
codedmodule2 <- module2 %>%
  
#remove row 1
  filter(!row_number() %in% c(1,2)) %>% 
  
# replace risky likert scale with numbers
  mutate_at(vars(starts_with("Risky")), funs(case_when(. =="Not at all risky" ~ 1, 
                                                       . =="Slightly risky" ~ 2, 
                                                       . =="Moderately risky" ~ 3, 
                                                       . =="Very risky" ~ 4, 
                                                       . =="Extremely risky" ~ 5))) %>%

# replace beneficial likert scale with numbers  
  mutate_at(vars(starts_with("Ben")), funs(case_when(. =="Not at all beneficial" ~ 1,
                                                     . =="Slightly beneficial" ~ 2,
                                                     . =="Moderately beneficial" ~ 3,
                                                     . =="Very beneficial" ~ 4,
                                                     . =="Extremely beneficial" ~ 5 ))) %>%

# replace nuclear acceptance likert scale with numbers
  mutate_at(vars(N_accept,N_reluctantlyaccept,N_reject), funs(case_when(. == "Strongly disagree" ~ 1, 
                                                                        . == "Somewhat disagree" ~ 2,
                                                                        . == "Neither agree nor disagree" ~3,
                                                                        . == "Somewhat agree" ~ 4,
                                                                        . == "Strongly agree" ~ 5))) %>%
  
# code likert scale for variables for Kahan scale into numbers
  mutate_at(vars(starts_with (c("K_I","K_H","DISPLACE", "POLLUTE", "HEALTH", "JOBS", "BEAUTY", "PRIDE", "NPRIDE", "DEV", "PROSPER", "RELY"))), funs(case_when(. == "Strongly disagree" ~ 1, 
               . == "Somewhat disagree" ~ 2,
               . == "Neither agree nor disagree" ~3,
               . == "Somewhat agree" ~ 4,
               . == "Strongly agree" ~ 5))) %>%
  
# reverse code for likert scale for variables for Kahan scale into numbers
  mutate_at(vars(starts_with (c("K_S","K_E"))), funs(case_when(. == "Strongly disagree" ~ 5, 
                                                               . == "Somewhat disagree" ~ 4,
                                                               . == "Neither agree nor disagree" ~3,
                                                               . == "Somewhat agree" ~ 2,
                                                               . == "Strongly agree" ~ 1))) %>%

# code eco-pol scale variables into numbers
  mutate_at(vars(SYSTEMDEMO,SYSTEMRELIGION,SYSTEMTECHNO,SYSTEMTOTAL,WEALTHLIM,MECHANISATION,DECISIONDECEN,INDUSTRYLARGE,ECONOMYGLOBAL,OWNERPVT,OWNERNOREG), funs(case_when(. == "Strongly disagree" ~ 1, 
                        . == "Somewhat disagree" ~ 2,
                        . == "Neither agree nor disagree" ~3,
                        . == "Somewhat agree" ~ 4,
                        . == "Strongly agree" ~ 5))) %>%

# reverse code eco-pol scale variables into numbers 
 mutate_at(vars(DECISIONCEN, INDUSTRYSMALL, ECONOMYLOCAL, ENVOVERDEV,OWNERPUB, OWNERREG), funs(case_when(. == "Strongly disagree" ~ 5, 
                                                                                                         . == "Somewhat disagree" ~ 4,
                                                                                                         . == "Neither agree nor disagree" ~3,
                                                                                                         . == "Somewhat agree" ~ 2,
                                                                                                         . == "Strongly agree" ~ 1)))

```


```{r, eval=TRUE, echo=FALSE}

moduleone <- read_excel(here::here("thesis_surveydata/livelihood_insecurity_complete.xlsx"))
module1 <- data.frame(moduleone)

# loaded data set for module 2 eco -pol variables and removes the rows with question number and question text
```



```{r, eval =TRUE, echo=FALSE}
#This chunk contains the coding schemes of various scales used in survey one: eco-political factors, kahan scale and acceptance scale
codedmodule1 <- module1 %>%
  
#remove row 1
  filter(!row_number() %in% c(1,2)) %>% 
  
# replace risky likert scale with numbers
  mutate_at(vars(starts_with("Risky")), funs(case_when(. =="Not at all risky" ~ 1, 
                                                       . =="Slightly risky" ~ 2, 
                                                       . =="Moderately risky" ~ 3, 
                                                       . =="Very risky" ~ 4, 
                                                       . =="Extremely risky" ~ 5))) %>%

# replace beneficial likert scale with numbers  
  mutate_at(vars(starts_with("Ben")), funs(case_when(. =="Not at all beneficial" ~ 1,
                                                     . =="Slightly beneficial" ~ 2,
                                                     . =="Moderately beneficial" ~ 3,
                                                     . =="Very beneficial" ~ 4,
                                                     . =="Extremely beneficial" ~ 5 ))) %>%

# replace nuclear acceptance likert scale with numbers
  mutate_at(vars(N_accept,N_reluctantlyaccept,N_reject), funs(case_when(. == "Strongly disagree" ~ 1, 
                                                                        . == "Somewhat disagree" ~ 2,
                                                                        . == "Neither agree nor disagree" ~3,
                                                                        . == "Somewhat agree" ~ 4,
                                                                        . == "Strongly agree" ~ 5)))

```

```{r, echo = FALSE}

suppressPackageStartupMessages(library(tidyselect))
# combine codedmodule1 and codedmodule2

numcol2 <- codedmodule2 %>% add_column(Respondent = 1:1099, .before = "Language") 
numcol1 <- codedmodule1 %>% add_column(Respondent = 1099:2160, .before = "Language")

joineddf <-  full_join(numcol2, numcol1, by = c("Respondent", "Language", "Survey_Date", "State", "Risky_Hydro", "Risky_Solar", "Risky_Wind", "Risky_Nuclear", "Risky_Coal", "Risky_Gas", "Risky_Oil", "Risky_INDHydro", "Risky_INDSolar", "Risky_INDWind", "Risky_INDBiogas", "Risky_INDDiesel", "Risky_INDKerosene", "Risky_INDFirewoodetc", "Risky_INDLPG", "Ben_Hydro", "Ben_Solar", "Ben_Wind", "Ben_Nuclear", "Ben_Coal", "Ben_Gas", "Ben_Oil", "Ben_INDHydro", "Ben_INDSolar", "Ben_INDWind", "Ben_INDDiesel", "Ben_INDBiogas", "Ben_INDFirewoodetc", "Ben_INDLPG", "Ben_INDKerosene", "N_accept", "N_reluctantlyaccept", "N_reject", "age", "urban_rural", "gender", "caste", "religion", "religiontext")) 

```

\newpage

## Perceived Risk Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by gender and caste groups 

OBC = Other Backward Classes;
SC = Scheduled Castes;
ST = Scheduled Tribes

```{r, eval =TRUE, echo=FALSE}


castegendereffect <- joineddf %>%
  select(starts_with(c("Risky", "gender", "caste")))%>%
  unite("Gender_Caste", c("gender", "caste")) %>%
  na.omit() 


castegendereffect$Gender_Caste <- as.factor(castegendereffect$Gender_Caste)
#levels(castegendereffect$Gender_Caste)

 # mean risk from centrally controlled energy technologies

caste_gender <- castegendereffect %>%
  mutate(Gender_Caste = factor(castegendereffect$Gender_Caste, levels = c("Female_Brahmin", "Female_SC", "Female_OBC", "Male_SC","Male_ST", "Male_General", "Female_General","Female_ST" ,"Male_OBC", "Male_Brahmin")))%>%
  select(!starts_with(c("Risky_IND")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_Hydro:Risky_Oil))) %>%
  select(Gender_Caste, riskscore) %>%
  dplyr::group_by(Gender_Caste)%>%
  summarise(mean=mean(riskscore),median= median(riskscore), sd=sd(riskscore), n=n())%>%
  arrange(desc(mean))

data.frame(caste_gender)

caste_gender %>%  ggplot(aes(y = Gender_Caste, x = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(xmin=mean-sd, xmax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(x = "mean perceived risk", y = "GenderXCaste groups")

 


```

\newpage

## Perceived Benefit Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by gender and caste groups 

OBC = Other Backward Classes;
SC = Scheduled Castes;
ST = Scheduled Tribes;

```{r, eval =TRUE, echo=FALSE}


castegenderben <- joineddf %>%
  select(starts_with(c("Ben", "gender", "caste")))%>%
  unite("Gender_Caste", c("gender", "caste")) %>%
  na.omit()

caste_gender2 <- castegenderben%>%
  mutate(Gender_Caste = factor(castegenderben$Gender_Caste, levels = c("Male_OBC","Female_Brahmin","Male_SC","Male_ST", "Male_General", "Female_SC", "Female_OBC",  "Female_General" , "Male_Brahmin","Female_ST")))%>%
  select(!starts_with(c("Ben_IND")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_Hydro:Ben_Oil))) %>%
  select(Gender_Caste, benscore) %>%
  dplyr::group_by(Gender_Caste)%>%
  summarise(mean=mean(benscore), sd=sd(benscore), median = median (benscore), n= n())%>%
  arrange(desc(mean))

data.frame(caste_gender2)

 # mean benefit from centrally controlled energy technologies

caste_gender2 %>%
  ggplot(aes(y = Gender_Caste, x = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(xmin=mean-sd, xmax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(x = "mean perceived risk", y = "GenderXCaste groups")
 


```

\newpage

## Perceived Risk Scores for all individually or community owned energy technologies(small hydro, rooftop solar, windmill, biogas, diesel, kerosene,Firewood/cow dung/crop residue/ coal/charcoal, LPG) by gender and caste groups 

OBC = Other Backward Classes
SC = Scheduled Castes
ST = Scheduled Tribes


```{r, eval =TRUE, echo=FALSE}

# mean risk from individually or community owned energy technologies

caste_gender3 <- castegendereffect %>%
  mutate(Gender_Caste = factor(Gender_Caste, levels = c("Female_OBC","Female_SC", "Female_ST" ,"Female_Brahmin", "Male_ST",  "Male_SC","Female_General", "Male_General", "Male_OBC", "Male_Brahmin")))%>%
  select(starts_with(c("Risky_IND", "Gender_Caste")))%>%
  #select("Risky_Hydro", "Risky_Nuclear", "Risky_Coal","Gender_Caste")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_INDHydro:Risky_INDLPG))) %>%
  select(Gender_Caste, riskscore) %>%
  dplyr::group_by(Gender_Caste)%>%
  summarise(mean=mean(riskscore), sd=sd(riskscore))%>%
  arrange(desc(mean))

data.frame(caste_gender3)

caste_gender3%>%
  ggplot(aes(y = Gender_Caste, x = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(xmin=mean-sd, xmax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(x = "mean perceived risk", y = "GenderXCaste groups")


#%>%
 
#group_by("Gender_Caste") %>%
 #summarise_at(vars("Risky_Nuclear"), list(Riskscore = mean))
    #mutate(Gender_Caste = factor(Gender_Caste, levels = c("Male_Brahmin", "Male_General","Male_OBC", "Male_SC", "Male_ST","Female_Brahmin", "Female_General", "Female_OBC","Female_SC", "Female_ST")))

```

\newpage 

## Perceived Benefit Scores for all individually or community owned energy technologies(small hydro, rooftop solar, windmill, biogas, diesel, kerosene,Firewood/cow dung/crop residue/ coal/charcoal, LPG) by gender and caste groups 

OBC = Other Backward Classes;
SC = Scheduled Castes;
ST = Scheduled Tribes

```{r, eval =TRUE, echo=FALSE}

# mean benefit from individually or community owned energy technologies


caste_gender4 <- castegenderben %>%
  mutate(Gender_Caste = factor(Gender_Caste, levels = c("Male_OBC","Female_SC","Female_Brahmin","Female_OBC","Male_SC", "Male_General","Male_ST","Female_General","Male_Brahmin", "Female_ST")))%>%
  select(starts_with(c("Ben_IND", "Gender_Caste")))%>%
  #select("Risky_Hydro", "Risky_Nuclear", "Risky_Coal","Gender_Caste")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_INDHydro:Ben_INDLPG))) %>%
  select(Gender_Caste, benscore) %>%
  dplyr::group_by(Gender_Caste)%>%
  summarise(mean=mean(benscore), sd=sd(benscore), median= median(benscore), n = n())%>%
  arrange(desc(mean))

data.frame(caste_gender4)


caste_gender4%>%
  ggplot(aes(y = Gender_Caste, x = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(xmin=mean-sd, xmax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(x = "mean perceived benefit", y = "GenderXCaste groups")


```

\newpage
## Perceived Risk Scores for centrally managed hydroelectric dams by gender and caste groups 

OBC = Other Backward Classes;
SC = Scheduled Castes;
ST = Scheduled Tribes


```{r, echo=FALSE}

caste_genderh <- castegendereffect %>%
  mutate(Gender_Caste = factor(Gender_Caste, levels = c("Female_Brahmin","Male_ST","Male_Brahmin", "Male_SC","Female_General","Male_General", "Female_OBC", "Female_ST","Female_SC", "Male_OBC")))%>%
  select(!starts_with(c("Risky_IND")))%>%
  select("Risky_Hydro", "Risky_Nuclear", "Risky_Coal","Gender_Caste")%>%
  na.omit()%>%
  dplyr::group_by(Gender_Caste)%>%
  summarise(hydro_m=mean(Risky_Hydro), hydro_sd=sd(Risky_Hydro), nuclear_m=mean(Risky_Nuclear), nuclear_sd=sd(Risky_Nuclear),            coal_m=mean(Risky_Coal),   coal_sd=sd(Risky_Coal))%>%
  arrange(desc(hydro_m))

data.frame(caste_genderh)

caste_genderh%>%
  ggplot(aes(y = Gender_Caste, x = hydro_m))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(xmin=hydro_m-hydro_sd, xmax=hydro_m + hydro_sd), width=.2,
                 position=position_dodge(.9))+
  labs(x = "mean perceived risk", y = "GenderXCaste groups")
```

\newpage

## Perceived Benefit Scores for centrally managed hydroelectric dams by gender and caste groups 

OBC = Other Backward Classes;
SC = Scheduled Castes;
ST = Scheduled Tribes


```{r, echo=FALSE}

caste_genderh2 <- castegenderben %>%
  mutate(Gender_Caste = factor(Gender_Caste, levels = c("Male_OBC","Male_ST", "Female_Brahmin","Male_SC","Male_General", "Female_SC","Female_General","Female_OBC","Male_Brahmin",  "Female_ST")))%>%
  select(!starts_with(c("Ben_IND")))%>%
  select("Ben_Hydro", "Ben_Nuclear", "Ben_Coal","Gender_Caste")%>%
  na.omit()%>%
  dplyr::group_by(Gender_Caste)%>%
  summarise(hydro_m=mean(Ben_Hydro), hydro_sd=sd(Ben_Hydro), nuclear_m=mean(Ben_Nuclear), nuclear_sd=sd(Ben_Nuclear),            coal_m=mean(Ben_Coal),   coal_sd=sd(Ben_Coal))%>%
  arrange(desc(hydro_m))

data.frame(caste_genderh2)

caste_genderh2 %>%
  ggplot(aes(y = Gender_Caste, x = hydro_m))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(xmin=hydro_m-hydro_sd, xmax=hydro_m + hydro_sd), width=.2,
                 position=position_dodge(.9))+
  labs(x = "mean perceived benefit", y = "GenderXCaste groups")
```

\newpage
## Perceived Risk Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by urban or rural location of the respondent 

```{r, echo=FALSE}

joineddf$urban_rural <- as.factor(joineddf$urban_rural)
#class(joineddf$urban_rural)
#levels(joineddf$urban_rural)


urbanrural <- joineddf %>%
  select(starts_with(c("Risky", "urban_rural")))%>%
  select(!starts_with(c("Risky_IND")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_Hydro:Risky_Oil))) %>%
  select(urban_rural, riskscore) %>%
  dplyr::group_by(urban_rural)%>%
  summarise(mean=mean(riskscore), sd=sd(riskscore), median = median (riskscore), n=n())%>%
  arrange(desc(mean))

data.frame(urbanrural)

urbanrural%>%
  ggplot(aes(x= urban_rural, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(x = "urban or rural", y = "mean risk")
```

\newpage
## Perceived Benefit Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by urban or rural location of the respondent 


```{r, echo=FALSE}

urbanrural2 <- joineddf %>%
  select(starts_with(c("Ben", "urban_rural")))%>%
  select(!starts_with(c("Ben_IND")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_Hydro:Ben_Oil))) %>%
  select(urban_rural, benscore) %>%
  dplyr::group_by(urban_rural)%>%
  summarise(mean=mean(benscore), sd=sd(benscore), median= median(benscore), n= n())%>%
  arrange(desc(mean))


data.frame(urbanrural2)

urbanrural2%>%
  ggplot(aes(x= urban_rural, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(x = "urban or rural", y = "mean benefit")
```

\newpage

## Perceived Risk Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by gender

```{r, echo =FALSE}

joineddf$gender <- as.factor(joineddf$gender)
#class(joineddf$gender)
#levels(joineddf$gender)


genderrisk <- joineddf %>%
  select(starts_with(c("Risky", "gender")))%>%
  select(!starts_with(c("Risky_IND")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_Hydro:Risky_Oil))) %>%
  select(gender, riskscore) %>%
  dplyr::group_by(gender)%>%
  summarise(mean=mean(riskscore), sd=sd(riskscore), median= median(riskscore), n=n())%>%
  arrange(desc(mean))

data.frame(genderrisk)


genderrisk%>%
  ggplot(aes(x= gender, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "mean risk")
```

\newpage

## Perceived Benefit Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by gender


```{r, echo =FALSE}

genderben <- joineddf %>%
  select(starts_with(c("Ben", "gender")))%>%
  select(!starts_with(c("Ben_IND")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_Hydro:Ben_Oil))) %>%
  select(gender, benscore) %>%
  dplyr::group_by(gender)%>%
  summarise(mean=mean(benscore), sd=sd(benscore), median = median(benscore), n=n())%>%
  arrange(desc(mean))

data.frame(genderben)

genderben %>%
  ggplot(aes(x= gender, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "mean benefit")
```

\newpage

## Perceived Risk Scores for all individually or community owned energy technologies(small hydro, rooftop solar, windmill, biogas, diesel, kerosene,Firewood/cow dung/crop residue/ coal/charcoal, LPG) by gender. 


```{r, echo=FALSE}

joineddf$gender <- as.factor(joineddf$gender)
#class(joineddf$gender)
#levels(joineddf$gender)



genderrisk2 <- joineddf %>%
  select(starts_with(c("Risky", "gender")))%>%
  select(starts_with(c("Risky_IND", "gender")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_INDHydro:Risky_INDLPG))) %>%
  select(gender, riskscore) %>%
  dplyr::group_by(gender)%>%
  summarise(mean=mean(riskscore), sd=sd(riskscore), median= median(riskscore), n=n())%>%
  arrange(desc(mean))

data.frame(genderrisk2)

genderrisk2%>%
  ggplot(aes(x= gender, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "mean risk")
```

\newpage

## Perceived Benefit Scores for all individually or community owned energy technologies(small hydro, rooftop solar, windmill, biogas, diesel, kerosene,Firewood/cow dung/crop residue/ coal/charcoal, LPG) by gender. 

```{r, echo=FALSE}

genderben2 <- joineddf %>%
  select(starts_with(c("Ben", "gender")))%>%
  select(starts_with(c("Ben_IND", "gender")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_INDHydro:Ben_INDLPG))) %>%
  select(gender, benscore) %>%
  dplyr::group_by(gender)%>%
  summarise(mean=mean(benscore), sd=sd(benscore), median = median (benscore), n=n())%>%
  arrange(desc(mean))

data.frame(genderben2)

genderben2%>%
  ggplot(aes(x= gender, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "mean benefit")
```

\newpage

## Perceived Risk Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by religion


```{r, echo=FALSE}

joineddf$religion <- as.factor(joineddf$religion)
#class(joineddf$religion)
#levels(joineddf$religion)



religionrisk1 <- joineddf %>%
  select(starts_with(c("Risky", "religion")))%>%
  select(!starts_with(c("Risky_IND", "religiontext")))%>%
 mutate(religion = factor(religion, levels = c("Agnostism/ Atheism","Other (Please mention)" ,  "Jainism", "Buddhism", "Islam",              "Hinduism", "Christanity", "Sikhism"))) %>%
  #select("Risky_Hydro", "Risky_Solar", "Risky_Nuclear","urban_rural")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_Hydro:Risky_Oil))) %>%
  select(religion, riskscore) %>%
  dplyr::group_by(religion)%>%
  summarise(mean=mean(riskscore), sd=sd(riskscore), median= median(riskscore), n=n())%>%
  arrange(desc(mean))

data.frame(religionrisk1)

religionrisk1%>%
  ggplot(aes(x= religion, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y= "mean perceived risk")+
  coord_flip()
```

\newpage

## Perceived Benefit Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by religion

```{r, echo=FALSE}

religionben1 <- joineddf %>%
  select(starts_with(c("Ben", "religion")))%>%
  select(!starts_with(c("Ben_IND", "religiontext")))%>%
 mutate(religion = factor(religion, levels = c("Other (Please mention)" ,"Agnostism/ Atheism",  "Christanity","Hinduism", "Islam","Jainism", "Sikhism" ,"Buddhism"))) %>%
  #select("Risky_Hydro", "Risky_Solar", "Risky_Nuclear","urban_rural")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_Hydro:Ben_Oil))) %>%
  select(religion, benscore) %>%
  dplyr::group_by(religion)%>%
  summarise(mean=mean(benscore), sd=sd(benscore), median=median(benscore), n=n())%>%
  arrange(desc(mean))

data.frame(religionben1)

religionben1%>%
  ggplot(aes(x= religion, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y= "mean perceived benefit")+
  coord_flip()
```

\newpage

## Perceived Risk Scores for all individually or community owned energy technologies(small hydro, rooftop solar, windmill, biogas, diesel, kerosene,Firewood/cow dung/crop residue/ coal/charcoal, LPG) by religion. 

```{r, echo=FALSE}

joineddf$religion <- as.factor(joineddf$religion)
#class(joineddf$religion)
#levels(joineddf$religion)



religionrisk2 <- joineddf %>%
  select(!starts_with(c("religiontext")))%>%
  select(starts_with(c("Risky_IND", "religion")))%>%
 mutate(religion = factor(religion, levels = c("Agnostism/ Atheism", "Jainism","Other (Please mention)" ,  "Buddhism", "Islam",              "Hinduism", "Christanity", "Sikhism"))) %>%
  #select("Risky_Hydro", "Risky_Solar", "Risky_Nuclear","urban_rural")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_INDHydro:Risky_INDLPG))) %>%
  select(religion, riskscore) %>%
  dplyr::group_by(religion)%>%
  summarise(mean=mean(riskscore), sd=sd(riskscore), median = median(riskscore), n=n())%>%
  arrange(desc(mean))

data.frame(religionrisk2)

religionrisk2%>%
  ggplot(aes(x= religion, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y= "mean perceived risk")+
  coord_flip()
```

\newpage
## Perceived Benefit Scores for all individually or community owned energy technologies(small hydro, rooftop solar, windmill, biogas, diesel, kerosene,Firewood/cow dung/crop residue/ coal/charcoal, LPG) by religion. 


```{r, echo=FALSE}

religionben2 <- joineddf %>%
  select(!starts_with(c("religiontext")))%>%
  select(starts_with(c("Ben_IND", "religion")))%>%
 mutate(religion = factor(religion, levels = c( "Jainism","Other (Please mention)" , "Hinduism","Agnostism/ Atheism", "Islam",   "Christanity","Buddhism", "Sikhism"))) %>%
  #select("Risky_Hydro", "Risky_Solar", "Risky_Nuclear","urban_rural")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_INDHydro:Ben_INDLPG))) %>%
  select(religion, benscore) %>%
  dplyr::group_by(religion)%>%
  summarise(mean=mean(benscore), sd=sd(benscore), median = median(benscore), n=n())%>%
  arrange(desc(mean))

data.frame(religionben2)

religionben2%>%
  ggplot(aes(x= religion, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y= "mean perceived benefit")+
  coord_flip()
```


\newpage

## Perceived Risk Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by age

```{r, echo=FALSE}

joineddf$age <- as.factor(joineddf$age)
#class(joineddf$age)
#levels(joineddf$age)



agerisk1<- joineddf %>%
  select(starts_with(c("Risky", "age")))%>%
  select(!starts_with(c("Risky_IND")))%>%
 mutate(age = factor(age, levels = c("18-24 years old", "25-34 years old", "35-44 years old", "45-54 years old" , "55-64 years old" ,  "65-74 years old", "75 years or older"))) %>%
  #select("Risky_Hydro", "Risky_Solar", "Risky_Nuclear","urban_rural")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_Hydro:Risky_Oil))) %>%
  select(age, riskscore) %>%
  dplyr::group_by(age)%>%
  summarise(mean=mean(riskscore), sd=sd(riskscore), median= median(riskscore), n=n())%>%
  arrange(desc(mean))

data.frame(agerisk1)

agerisk1%>%
  ggplot(aes(x= age, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "mean perceived risk")+
  coord_flip()
```

\newpage

## Perceived Benefit Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by age
```{r, echo=FALSE}

ageben1 <- joineddf %>%
  select(starts_with(c("Ben", "age")))%>%
  select(!starts_with(c("Ben_IND")))%>%
 mutate(age = factor(age, levels = c("18-24 years old", "25-34 years old", "35-44 years old", "45-54 years old" , "55-64 years old" ,  "65-74 years old", "75 years or older"))) %>%
  #select("Risky_Hydro", "Risky_Solar", "Risky_Nuclear","urban_rural")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_Hydro:Ben_Oil))) %>%
  select(age, benscore) %>%
  dplyr::group_by(age)%>%
  summarise(mean=mean(benscore), sd=sd(benscore),median= median(benscore), n=n())%>%
  arrange(desc(mean))

data.frame(ageben1)


ageben1%>%
  ggplot(aes(x= age, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "mean perceived benefit")+
  coord_flip()
```


\newpage

## Perceived Risk Scores for all individually or community owned energy technologies(small hydro, rooftop solar, windmill, biogas, diesel, kerosene,Firewood/cow dung/crop residue/ coal/charcoal, LPG) by age. 

```{r, echo=FALSE}

agerisk2 <- joineddf %>%
  select(starts_with(c("Risky", "age")))%>%
  select(starts_with(c("Risky_IND", "age")))%>%
 mutate(age = factor(age, levels = c("18-24 years old", "25-34 years old", "35-44 years old", "45-54 years old" , "55-64 years old" ,  "65-74 years old", "75 years or older"))) %>%
  #select("Risky_Hydro", "Risky_Solar", "Risky_Nuclear","urban_rural")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(riskscore = mean(c_across(Risky_INDHydro:Risky_INDLPG))) %>%
  select(age, riskscore) %>%
  dplyr::group_by(age)%>%
  summarise(mean=mean(riskscore), sd=sd(riskscore), median= median(riskscore), n=n())%>%
  arrange(desc(mean))

data.frame(agerisk2)


agerisk2%>%
  ggplot(aes(x= age, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "firebrick2")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "mean perceived risk")+
  coord_flip()
```

\newpage

## Perceived Benefit Scores for all individually or community owned energy technologies(small hydro, rooftop solar, windmill, biogas, diesel, kerosene,Firewood/cow dung/crop residue/ coal/charcoal, LPG) by age. 

```{r, echo=FALSE}

ageben2 <- joineddf %>%
  select(starts_with(c("Ben", "age")))%>%
  select(starts_with(c("Ben_IND", "age")))%>%
 mutate(age = factor(age, levels = c("18-24 years old", "25-34 years old", "35-44 years old", "45-54 years old" , "55-64 years old" ,  "65-74 years old", "75 years or older"))) %>%
  #select("Risky_Hydro", "Risky_Solar", "Risky_Nuclear","urban_rural")%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(benscore = mean(c_across(Ben_INDHydro:Ben_INDLPG))) %>%
  select(age, benscore) %>%
  dplyr::group_by(age)%>%
  summarise(mean=mean(benscore), sd=sd(benscore), median=median(benscore), n=n())%>%
  arrange(desc(mean))

data.frame(ageben2)


ageben2%>%
  ggplot(aes(x= age, y = mean))+
  geom_bar(stat="identity", position=position_dodge(), fill = "palegreen3")+
  geom_errorbar(aes(ymin=mean-sd, ymax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  labs(y = "mean perceived benefit")+
  coord_flip()
```

\newpage

## Perceived Risk Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by state

```{r, echo=FALSE}
cenrisksummary <- joineddf %>%
  group_by(State)%>%
  summarize_at(vars(starts_with(c("RISKY"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  #melt to long format
  gather(key = "technology", value = "summary", Risky_Hydro_mean, Risky_Solar_mean, Risky_Wind_mean, Risky_Nuclear_mean, Risky_Coal_mean, Risky_Gas_mean, Risky_Oil_mean, Risky_Hydro_sd, Risky_Solar_sd, Risky_Wind_sd, Risky_Nuclear_sd, Risky_Coal_sd, Risky_Gas_sd, Risky_Oil_sd,  Risky_Hydro_median, Risky_Solar_median, Risky_Wind_median, Risky_Nuclear_median, Risky_Coal_median, Risky_Gas_median, Risky_Oil_median, Risky_Hydro_n, Risky_Solar_n, Risky_Wind_n, Risky_Nuclear_n, Risky_Coal_n, Risky_Gas_n, Risky_Oil_n,) %>%
  select(State, technology, summary) %>%
  # separate risky from variable suffix
  separate(technology, c("Risky", "var"), extra = "merge", fill = "left") %>%
  #separate mean from variable prefix
  separate(var, c("technology", "meansd")) %>%
  # spread summary values back to wide form
  spread(meansd,summary) %>%
  #clean up
  select(-Risky)%>%
  arrange(State) #%>%
  #setNames(paste0('perceivedrisk.', names(.))) %>%
  #dplyr::rename(technology= perceivedrisk.technology)

data.frame(cenrisksummary)

```



```{r, echo=FALSE}

joineddf$State <- as.factor(joineddf$State)
#class(joineddf$State)
#levels(joineddf$State)

cenrisksummary %>%
  mutate(technology = fct_reorder(technology, mean, .desc = TRUE))%>%
  ggplot(aes(y= technology, x= mean, fill = technology))+
  geom_bar(stat="identity", position=position_dodge())+
  theme_minimal()+
  geom_errorbar(aes(xmin=mean-sd, xmax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  scale_fill_manual(values=c("#74238B", "#FEF102","#484349","#BA5C12", "#4D9DE0","#CFEBDF", "#FA6728"))+
  xlim(0,5)+
  facet_wrap(~ State)+
  labs(x = "mean perceived risk", y = "energy technologies")
  #scale_fill_manual(y, values =))+


```

\newpage
## Perceived Benefit Scores for all centrally managed energy technologies(nuclear energy, hydroelectric dam, solar energy, wind energy, coal, gas and oil) by state


```{r, echo=FALSE}
cenbensummary <- joineddf %>%
  group_by(State)%>%
  summarize_at(vars(starts_with(c("Ben"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  #melt to long format
  gather(key = "technology", value = "summary", Ben_Hydro_mean, Ben_Solar_mean, Ben_Wind_mean, Ben_Nuclear_mean, Ben_Coal_mean, Ben_Gas_mean, Ben_Oil_mean, Ben_Hydro_sd, Ben_Solar_sd, Ben_Wind_sd, Ben_Nuclear_sd, Ben_Coal_sd, Ben_Gas_sd, Ben_Oil_sd, Ben_Hydro_median, Ben_Solar_median, Ben_Wind_median, Ben_Nuclear_median, Ben_Coal_median, Ben_Gas_median, Ben_Oil_median, Ben_Hydro_n, Ben_Solar_n, Ben_Wind_n, Ben_Nuclear_n, Ben_Coal_n, Ben_Gas_n, Ben_Oil_n) %>%
  select(State, technology, summary) %>%
  # separate risky from variable suffix
  separate(technology, c("Ben", "var"), extra = "merge", fill = "left") %>%
  #separate mean from variable prefix
  separate(var, c("technology", "meansd")) %>%
  # spread summary values back to wide form
  spread(meansd,summary) %>%
  #clean up
  select(-Ben)%>%
  arrange(State) #%>%
  #setNames(paste0('perceivedrisk.', names(.))) %>%
  #dplyr::rename(technology= perceivedrisk.technology)

data.frame(cenbensummary)

```


```{r, echo=FALSE}

joineddf$State <- as.factor(joineddf$State)
#class(joineddf$State)
#levels(joineddf$State)

cenbensummary %>%
  mutate(technology = fct_reorder(technology, mean, .desc = TRUE))%>%
  ggplot(aes(y= technology, x= mean, fill = technology))+
  geom_bar(stat="identity", position=position_dodge())+
  theme_minimal()+
  geom_errorbar(aes(xmin=mean-sd, xmax=mean + sd), width=.2,
                 position=position_dodge(.9))+
  scale_fill_manual(values=c("#74238B", "#FEF102","#484349","#BA5C12", "#4D9DE0","#CFEBDF", "#FA6728"))+
  xlim(0,5)+
  facet_wrap(~ State)+
  labs(x = "mean perceived benefit", y = "energy technologies")
  #scale_fill_manual(y, values =))+


```





```{r, echo=FALSE}
#INDrisksummary <- joineddf %>%
  #group_by(State)%>%
 # summarize_at(vars(starts_with(c("RISKY_IND"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  #melt to long format
  #gather(key = "technology", value = "summary", Risky_INDHydro_mean, Risky_INDSolar_mean, Risky_INDWind_mean, Risky_INDDiesel_mean, Risky_INDKerosene_mean, Risky_INDFirewoodetc_mean, Risky_INDLPG_mean,  Risky_INDBiogas_mean, Risky_INDHydro_sd, Risky_INDSolar_sd, Risky_INDWind_sd, Risky_INDDiesel_sd, Risky_INDKerosene_sd, Risky_INDBiogas_sd, Risky_INDKerosene_sd, Risky_INDFirewoodetc_sd, Risky_INDLPG_sd) %>%
  #select(State, technology, summary) %>%
  # separate risky from variable suffix
  #separate(technology, c("Risky", "var"), extra = "merge", fill = "left") %>%
  #separate mean from variable prefix
  #separate(var, c("technology", "meansd")) %>%
  # spread summary values back to wide form
  #spread(meansd,summary) %>%
  #clean up
  #select(-Risky)%>%
  #arrange(mean) #%>%
  #setNames(paste0('perceivedrisk.', names(.))) %>%
  #dplyr::rename(technology= perceivedrisk.technology)

```


```{r, echo=FALSE}
INDbensummary <- joineddf %>%
  group_by(State)%>%
  summarize_at(vars(starts_with(c("Ben_IND"))), list(~mean(., na.rm = TRUE), ~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE), ~n())) %>%
  #melt to long format
  gather(key = "technology", value = "summary", Ben_INDHydro_mean, Ben_INDSolar_mean, Ben_INDWind_mean, Ben_INDDiesel_mean, Ben_INDKerosene_mean, Ben_INDFirewoodetc_mean, Ben_INDLPG_mean,  Ben_INDBiogas_mean, Ben_INDHydro_sd, Ben_INDSolar_sd, Ben_INDWind_sd, Ben_INDDiesel_sd, Ben_INDKerosene_sd, Ben_INDBiogas_sd, Ben_INDKerosene_sd, Ben_INDFirewoodetc_sd, Ben_INDLPG_sd) %>%
  select(State, technology, summary) %>%
  # separate risky from variable suffix
  separate(technology, c("Ben", "var"), extra = "merge", fill = "left") %>%
  #separate mean from variable prefix
  separate(var, c("technology", "meansd")) %>%
  # spread summary values back to wide form
  spread(meansd,summary) %>%
  #clean up
  select(-Ben)%>%
  arrange(mean) #%>%
  #setNames(paste0('perceivedrisk.', names(.))) %>%
  #dplyr::rename(technology= perceivedrisk.technology)

```


```{r, echo=FALSE}


#INDrisksummary %>%
  #mutate(technology = fct_reorder(technology, mean, .desc = TRUE))%>%
  #ggplot(aes(y= technology, x= mean, fill = technology))+
  #geom_bar(stat="identity", position=position_dodge())+
  #theme_minimal()+
  #geom_errorbar(aes(xmin=mean-sd, xmax=mean + sd), width=.2,
                 #position=position_dodge(.9))+
  #scale_fill_manual(values=c("red","#74238B", "#4D9DE0", "#CFEBDF","#FEF102","#484349","#BA5C12", "#FA6728"))+
  #xlim(0,5)+
  #facet_wrap(~ State)+
  #labs(x = "mean perceived risk", y = "energy technologies")
  #scale_fill_manual(y, values =))+


```




```{r, echo=FALSE}


#INDbensummary %>%
  #mutate(technology = fct_reorder(technology, mean, .desc = TRUE))%>%
  #ggplot(aes(y= technology, x= mean, fill = technology))+
  #geom_bar(stat="identity", position=position_dodge())+
  #theme_minimal()+
  #geom_errorbar(aes(xmin=mean-sd, xmax=mean + sd), width=.2,
                # position=position_dodge(.9))+
  #scale_fill_manual(values=c("red","#74238B", "#4D9DE0", "#CFEBDF","#FEF102","#484349","#BA5C12", "#FA6728"))+
 # xlim(0,5)+
 # facet_wrap(~ State)+
 # labs(x = "mean perceived benefit", y = "energy technologies")
  #scale_fill_manual(y, values =))+


```



