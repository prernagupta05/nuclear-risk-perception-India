---
title: "moduleoneanalysis"
output:
  pdf_document: default
  html_document:
    fig_width: 7
    fig_height: 6
    fig_caption: yes
    keep_md: yes
    theme: paper
    df_print: paged
---

```{r load packages, warning = FALSE, message = FALSE}
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(psych))

```



```{r, eval=TRUE, echo = FALSE}

moduleone <- read_excel(here::here("thesis_surveydata/livelihood_insecurity_complete.xlsx"))
save(moduleone, file = "moduleone.rda")
module1 <- data.frame(moduleone)



# loaded data set for module 2 eco -pol variables and removes the rows with question number and question text
```


```{r, warning = FALSE, echo = FALSE}
#This chunk contains the coding schemes of various scales used in survey one: eco-political factors, kahan scale and acceptance scale
codedmodule1 <- module1 %>%
  #remove row 1
  filter(!row_number() %in% c(1,2)) %>%

  # replace risky likert scale with numbers
  mutate(across(starts_with("Risky"), ~case_when(. =="Not at all risky" ~ 1, 
                                                 . =="Slightly risky" ~ 2, 
                                                 . =="Moderately risky" ~ 3, 
                                                 . =="Very risky" ~ 4, 
                                                 . =="Extremely risky" ~ 5))) %>%

  # replace beneficial likert scale with numbers  
  mutate(across(starts_with("Ben"), ~case_when(. =="Not at all beneficial" ~ 1,
                                               . =="Slightly beneficial" ~ 2,
                                               . =="Moderately beneficial" ~ 3,
                                               . =="Very beneficial" ~ 4,
                                               . =="Extremely beneficial" ~ 5 ))) %>%

  # replace nuclear acceptance likert scale with numbers
  mutate(across(c(N_accept,N_reluctantlyaccept,N_reject), ~case_when(. == "Strongly disagree" ~ 1, 
                                                                     . == "Somewhat disagree" ~ 2,
                                                                     . == "Neither agree nor disagree" ~3,
                                                                     . == "Somewhat agree" ~ 4,
                                                                     . == "Strongly agree" ~ 5))) %>%

  mutate(across(Livelihood_Income, ~case_when(. == "(a) own farming/fishing/animal rearing/business" ~ "LSI", 
                                              . == "(b) employed for wages/salary" ~ "ISI",
                                              . == "(c) student" ~"other",
                                              . == "(d) currently unemployed" ~ "other",
                                              . == "(e) homemaker" ~ "homemaker",
                                              . == "(f) retired" ~ "other",
                                              . == "(g) unable to work" ~ "other" ))) %>%

  # coding education
  mutate(across(education, ~case_when(. == "No schooling completed" ~ 0, 
                                      . == "Primary school" ~ 1,
                                      . == "Grade 10th" ~ 2,
                                      . == "Grade 12th" ~ 3,
                                      . == "Some college, no degree" ~ 4,
                                      . == "Trade/technical/vocational training" ~ 5,
                                      . == "Bachelor's degree" ~ 6,
                                      . == "Master's degree" ~ 7,
                                      . == "Professional degree" ~ 8,
                                      . == "Doctorate degree" ~ 9 ))) %>%

  # coding yes and no questions
  mutate(across(c(Lassociation,Iassociation, govtscheme, wateravail, polposition, polparty), ~case_when(.== "Yes" ~ 1,
                                                                                                        .== "No" ~ 0))) %>%
  # reverse coding yes and no questions
  mutate(across(c(illness,severeillness), ~case_when(.== "Yes" ~ 0,
                                                     .== "No" ~ 1))) %>%

  # coding How confident are you that you can continue your current livelihood if you want to? 
  mutate(across(Lconfidence, ~case_when(. == "Not at all confident" ~ 1, 
                                        . == "Not much confident" ~ 2,
                                        . == "Neutral" ~3,
                                        . == "Somewhat confident" ~ 4,
                                        . == "Very confident" ~ 5))) %>%

  mutate(across(c(Lboat, houseown), ~case_when(.== "Own it" ~ 1,
                                               .== "Rent it" ~ 0))) %>%

  # J security index coding
  mutate(across(JISRkeep, ~case_when(. == "Strongly disagree" ~ 1, 
                                     . == "Somewhat disagree" ~ 2,
                                     . == "Neither agree nor disagree" ~3,
                                     . == "Somewhat agree" ~ 4,
                                     . == "Strongly agree" ~ 5))) %>%

  # reverse code JIS 
  mutate(across(c(JISlosefuture, JISlose, JISfuture), ~case_when(. == "Strongly disagree" ~ 5, 
                                                                 . == "Somewhat disagree" ~ 4,
                                                                 . == "Neither agree nor disagree" ~3,
                                                                 . == "Somewhat agree" ~ 2,
                                                                 . == "Strongly agree" ~ 1))) %>%

  mutate(across(c(totalincome, otherincome), ~case_when(. == "Less than Rs 1,00,000" ~ 1,
                                                        . == "Rs 1,00,000 to Rs 2,50,000"  ~ 2,
                                                        . == "Rs 2,50,001 to Rs 5,00,000" ~ 3,
                                                        . == "Rs 5,00,001 to Rs 10,00,000" ~ 4,
                                                        . == "Rs 10,00,001 and above"  ~ 5,
                                                        . == "Doesn't apply" ~ 0))) %>%

  mutate(across(c(workknowledge, subsidyknow), ~case_when(. == "Very poor" ~ 1, 
                                                          . == "Poor" ~ 2,
                                                          . == "Fair" ~3,
                                                          . == "Good" ~ 4,
                                                          . == "Very good" ~ 5))) %>%

  mutate(across(c(drinkingwater, cookingwater), ~case_when(. == "Bottled water/ Filtered Water" ~ 1,                                       
                                                           .  == "Piped into dwelling" ~ 2,                                                  
                                                           .  == "Piped to neighbour" ~ 3,                                                   
                                                           .  == "Piped to yard/plot" ~ 4, 
                                                           .  == "Protected well" ~ 5, 
                                                           .  == "Public tap/standpipe" ~6,
                                                           .  == "Surface Water  (River/Dam/Lake/Pond/Stream/Canal/Irrigation Channel)" ~7, 
                                                           .  == "Tanker Truck" ~ 8,
                                                           .  == "Tubewell/borehole" ~ 9,
                                                           .  == "Unprotected Spring" ~ 10))) %>%
  
  mutate(across(toilet, ~case_when(. == "No facility/bush/field" ~ 1,                                       
                                   .  == "Hanging toilet/hanging latrine" ~ 2,                                             
                                   .  == "Bucket toilet"  ~ 3,                                                   
                                   .  == "Composting toilet"  ~ 4, 
                                   .  == "Pit latrine without slab/open pit" ~ 5, 
                                   .  == "Pit latrine with slab" ~6,
                                   .  == "Ventilated improved pit laterine"  ~7, 
                                   .  == "Flush to somewhere else"  ~ 8,
                                   .  == "Flush to pit latrine"  ~ 9,
                                   .  == "Flush to septic tank" ~ 10,
                                   .  == "Flush to piped sewer system" ~ 11))) %>%

  mutate(across(house, ~case_when(. == "Hut made of mud, bamboo, straw etc. (kutcha house)" ~ 1, 
                                  . == "Permanent single story house (pukka house)" ~ 2,
                                  . == "Apartment/Flat in a multi-story building"  ~3,
                                  . == "Multi-story house" ~ 4))) %>% 

  mutate(across(foodtrouble, ~case_when(. == "8 or more months" ~ 1,                                       
                                        .  == "6-8 months"  ~ 2,                                                  
                                        .  == "4-6 months"  ~ 3,                                                   
                                        .  == "2-4 months"  ~ 4, 
                                        .  == "1-2 months" ~ 5, 
                                        .  == "0 months"  ~6))) %>%
  
  mutate(across(foodadequacy, ~case_when(. == "Extremely inadequate" ~ 1, 
                                         . == "Moderately inadequate" ~ 2,
                                         . == "Slightly inadequate" ~3,
                                         . == "Neither adequate nor inadequate" ~ 4,
                                         . == "Slightly adequate" ~ 5,
                                         . == "Moderately adequate" ~ 6,
                                         . == "Extremely adequate" ~ 7))) %>%

  # separating cooking, vehicle and food cols into separate entries
  separate(col = cookstove, into = c("cook1", "cook2", "cook3", "cook4"), sep = ",") %>%
  separate(col = vehicle, into = c("vehicle1", "vehicle2", "vehicle3", "vehicle4"), sep = ",") %>%
  separate(col = foodsource, into = c("food1", "food2", "food3", "food4"), sep = ",") %>%

  
  mutate(across(c(cook1, cook2, cook3, cook4), ~case_when(. == "Three Stone Stove/Open Fire" ~ 1, 
                                  . == "Traditional Solid Fuel Stove" ~ 2,
                                  . == "Liquid Fuel Stove" ~3,
                                  . == "Biogas Stove" ~ 4,
                                  . == "Piped Natural Gas Stove" ~ 5,
                                  . == "Liquefied Petroleum Gas (LPG)/Cooking gas stove" ~ 6,
                                  . == "Solar Cooker" ~ 7,
                                  . == "Electric Stove" ~ 7,
                                  is.na(.) ~ 0))) %>%
  
  
  mutate(across(c(vehicle1, vehicle2, vehicle3, vehicle4, vehicletext), ~case_when(. == "Bicycle" ~ 1, 
                                    . == "Animal Drawn Cart" ~ 2,
                                    . == "Motorcycle/Scooter" ~3,
                                    . == "Car" ~ 4,
                                    . == "Truck" ~ 4,
                                    . == "Boat with Motor" ~ 4,
                                    . == "Tractor" ~ 4,
                                    . == "E-rickshaw" ~ 1,
                                    . == "Tempo" ~ 3,
                                    . == "Nothing" ~ 0,
                                    . == "Other (Please Specify)" ~ 0,
                                    is.na(.) ~ 0))) %>%
  

  
  mutate(across(c(food1, food2, food3,food4), ~case_when(. == "Forest" ~ 1, 
                                  . == "Own Farm" ~ 2,
                                  . == "Market" ~4,
                                  . == "Own livestock" ~ 2,
                                  . == "Subsidised ration shops" ~ 3,
                                  is.na(.) ~ 0)))

codedmodule1$gender <- factor(codedmodule1$gender, levels = c("Male","Female"))

#converting relevant variables to factors 
#codedmodule1 <- codedmodule1 %>%
  #mutate_at(vars(Lassociation, Lboat, Iassociation, totalincome, otherincome, govtscheme, education, subsidyknow, drinkingwater, cookingwater, wateravail, toilet,
                # house, houseown, cook1, cook2, cook3, cook4, vehicle1, vehicle2, vehicle3, vehicle4, vehicletext, polposition, polparty,  food1, food2, food3, food4, foodadequacy, foodtrouble, #illness, severeillness, age, urban_rural, gender, caste, religion), 
                 #~factor(.))
#converting relevant variables to Numeric

```


```{r, echo=FALSE}

colnames(codedmodule1)
addedcols <- codedmodule1 %>%
  mutate_at(vars(Lassociation, Lboat, Iassociation, totalincome, otherincome, govtscheme, education, subsidyknow, drinkingwater, cookingwater, wateravail, toilet, house, houseown, cook1, cook2, cook3, cook4, vehicle1, vehicle2, vehicle3, vehicle4, vehicletext, polposition, polparty, food1, food2, food3, food4, foodadequacy, foodtrouble, illness, severeillness, Llenght, Lfarmbigha, Lanimalcowbull, Lanimalcattle, Lanimalhorses, Lanimalgoats, Lanimalsheep, Lanimalpoultry, Ilenght, Ipropvalue, farwatermins, healthdist), as.numeric) %>%
  mutate(stove = cook1 + cook2 + cook3 + cook4, 
        vehicle = vehicle1 + vehicle2 + vehicle3 + vehicle4 + vehicletext,
        food = food1 + food2 + food3 + food4,
        #income = totalincome + otherincome,
        animals = Lanimalcowbull + Lanimalcattle + Lanimalhorses + Lanimalgoats + Lanimalsheep + Lanimalpoultry) %>%
  dplyr::select(-cook1, -cook2, -cook3, -cook4, -vehicle1, -vehicle2, -vehicle3, -vehicle4, -vehicletext, -food1, -food2, -food3, -food4, -Lanimalcowbull, -Lanimalcattle, -Lanimalhorses, -Lanimalgoats, -Lanimalsheep, -Lanimalpoultry) %>%
  unite("LIlenght", c(Llenght,Ilenght), na.rm = TRUE, remove = TRUE)%>%
  unite("LIassociation", c(Lassociation,Iassociation), na.rm = TRUE, remove = TRUE) 

```


\newpage

The total n for this survey is 1062. However, the sample is divided by the type of work people do as below:

```{r, echo=FALSE}

count <- module1 %>% count(Livelihood_Income)

count <- count[1:(nrow(count) - 2), ]

count

```





# The Problem of large NAs


```{r, echo=FALSE}

# Count the number of NAs in each column
num_NAs <- colSums(is.na(addedcols))

# Print the result
print(num_NAs)



```



```{r, echo = FALSE}

nuclear_LI <- addedcols %>% 
  dplyr::select(Risky_Nuclear,State, gender, caste, religion, urban_rural, age,  Livelihood_Income,education, workknowledge,LIlenght, subsidyknow, drinkingwater,cookingwater,farwatermins, wateravail,toilet, house,stove, vehicle, houseown, polposition, LIassociation,polparty, govtscheme, totalincome, Lfarmbigha,  Ipropvalue, Lboat, animals, foodadequacy, foodtrouble,food, healthdist, illness, severeillness)

# checking NAs in LSI part 
assetcheck <- addedcols %>% filter(Livelihood_Income == "LSI") %>%
            dplyr::select(Lfarmland,Lfarmbigha,animals)


num_NAs2 <- colSums(is.na(assetcheck))


#print(num_NAs2)

codedmodule1 %>% count(Livelihood_Income)
addedcols %>% count(Livelihood_Income)
codedmodule1 %>% count(Lfarmbigha)
codedmodule1 %>% filter(Livelihood_Income == "LSI") %>% count(Lfarmland)
addedcols %>% filter(Livelihood_Income == "LSI") %>% count(animals)
codedmodule1 %>% count(Lboat)


addedcols %>% filter(Livelihood_Income == "LSI") %>% filter(Lfarmland == "Doesn't apply") %>% count(Lboat)
addedcols %>% filter(Livelihood_Income == "LSI") %>% filter(Lfarmland == "Doesn't apply") %>% count(animals)

addedcols %>% filter(Livelihood_Income == "ISI") %>% count(Iproperty)

# checking NAs in ISI part 

module1 %>% filter(!row_number() %in% c(1,2)) %>% filter(Livelihood_Income != "(a) own farming/fishing/animal rearing/business") %>% count(Iproperty)

# there are only 4 people who said they own a boat but not a farmland when looking at those people who answered LSI part of the survey. So we will just look at boat as  another livelihood asset and remove the 4 responses by removing Doesn't apply values in the Lfarmland part. 


```



```{r, echo = FALSE}
# Nuclear dataframe for LSI/ISI with standardized values 



# Convert columns to numeric starting from 'education'
cols_to_convert <- names(nuclear_LI)[which(names(nuclear_LI) == 'education'):length(names(nuclear_LI))]
nuclear_LI[cols_to_convert] <- lapply(nuclear_LI[cols_to_convert], as.numeric)


nuclear_LI$LIassociation <- as.numeric(nuclear_LI$LIassociation)
nuclear_LI$LIlenght <- as.numeric(nuclear_LI$LIlenght)
# Standardize the values
standardize <- function(x) {
  (x - min(x, na.rm = TRUE)) / (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))
}

nuclear_LI[cols_to_convert] <- lapply(nuclear_LI[cols_to_convert], standardize)

# Displaying the first few rows of the dataframe
#head(nuclear_LI)


```

```{r, echo = FALSE}


# first make two different groups in the data by Livelihood_Income variable. - homemaker, ISI, LSI, other (retired, student, unable to work, unemployed)

str(nuclear_LI)


# For 'homemaker'
homemaker_df <- nuclear_LI %>% filter(Livelihood_Income == "homemaker") %>%
                dplyr::select (Risky_Nuclear, State,education, workknowledge, LIlenght, drinkingwater,cookingwater,farwatermins, wateravail,toilet, house,stove, vehicle, houseown, polposition, LIassociation, polparty, govtscheme, totalincome, foodadequacy, foodtrouble,food, healthdist, illness, severeillness) %>%
  na.omit()


num_NAs3 <- colSums(is.na(homemaker_df))

# For 'ISI'
ISI_df <- nuclear_LI %>% filter(Livelihood_Income == "ISI") %>%
  dplyr::select(Risky_Nuclear,State, education, workknowledge,LIlenght, drinkingwater,cookingwater,farwatermins, wateravail,toilet, house,stove, vehicle, houseown, polposition, LIassociation,polparty, govtscheme, totalincome, foodadequacy, foodtrouble,food, healthdist, illness, severeillness) %>%
   na.omit()

num_NAs4 <- colSums(is.na(ISI_df))


# For 'LSI'
LSI_df <- nuclear_LI %>% filter(Livelihood_Income == "LSI")  %>% 
  dplyr::select(Risky_Nuclear,State, education, workknowledge,LIlenght, drinkingwater,cookingwater,farwatermins, wateravail,toilet, house,stove, vehicle, houseown, polposition, LIassociation,polparty, govtscheme, totalincome, animals, foodadequacy, foodtrouble,food, healthdist, illness, severeillness) %>%
  na.omit()

num_NAs5 <- colSums(is.na(LSI_df))

# For 'other'
other_df <- nuclear_LI %>% filter(Livelihood_Income == "other")%>% 
  dplyr::select(Risky_Nuclear,State, education, workknowledge,LIlenght, drinkingwater,cookingwater,farwatermins, wateravail,toilet, house,stove, vehicle, houseown, polposition, LIassociation,polparty, govtscheme, totalincome, foodadequacy, foodtrouble,food, healthdist, illness, severeillness)%>%
  na.omit()

num_NAs6 <- colSums(is.na(other_df))

# problem of small sample size - how to deal with it ? 


```


```{r, echo = FALSE}

library(dplyr)

# now aggregating LSI/ISI for different groups. 

homemaker <- homemaker_df %>%
  mutate(
    human_asset = rowMeans(dplyr::select(., education, workknowledge, LIlenght), na.rm = TRUE),
    physical_asset = rowMeans(dplyr::select(., drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown), na.rm = TRUE),
    social_asset = rowMeans(dplyr::select(., polposition, LIassociation, polparty, govtscheme), na.rm = TRUE),
    financial_asset = totalincome,
    food_security = rowMeans(dplyr::select(., foodadequacy, foodtrouble, food), na.rm = TRUE),
    health_status = rowMeans(dplyr::select(., healthdist, illness, severeillness), na.rm = TRUE)
  )%>%
 dplyr::select(
    -c(education, workknowledge, LIlenght, 
      drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown, 
      polposition, LIassociation, polparty, govtscheme, 
      foodadequacy, foodtrouble, food,
      healthdist, illness, severeillness,
      totalincome)
  )%>%
  mutate(
    score = rowMeans(dplyr::select(., human_asset, physical_asset, social_asset, financial_asset, food_security, health_status), na.rm = TRUE)
  )


ISI <- ISI_df%>%
  mutate(
    human_asset = rowMeans(dplyr::select(., education, workknowledge, LIlenght), na.rm = TRUE),
    physical_asset = rowMeans(dplyr::select(., drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown), na.rm = TRUE),
    social_asset = rowMeans(dplyr::select(., polposition, LIassociation, polparty, govtscheme), na.rm = TRUE),
    financial_asset = totalincome,
    food_security = rowMeans(dplyr::select(., foodadequacy, foodtrouble, food), na.rm = TRUE),
    health_status = rowMeans(dplyr::select(., healthdist, illness, severeillness), na.rm = TRUE)
  )%>%
  dplyr::select(
    -c(education, workknowledge, LIlenght, 
      drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown, 
      polposition, LIassociation, polparty, govtscheme, 
      foodadequacy, foodtrouble, food,
      healthdist, illness, severeillness,
      totalincome)
  )%>%
  mutate(
    score = rowMeans(dplyr::select(., human_asset, physical_asset, social_asset, financial_asset, food_security, health_status), na.rm = TRUE)
  )


LSI <- LSI_df%>%
  mutate(
    human_asset = rowMeans(dplyr::select(., education, workknowledge, LIlenght), na.rm = TRUE),
    physical_asset = rowMeans(dplyr::select(., drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown), na.rm = TRUE),
    social_asset = rowMeans(dplyr::select(., polposition, LIassociation, polparty, govtscheme), na.rm = TRUE),
    financial_asset = totalincome,
    food_security = rowMeans(dplyr::select(., foodadequacy, foodtrouble, food), na.rm = TRUE),
    health_status = rowMeans(dplyr::select(., healthdist, illness, severeillness), na.rm = TRUE)
  )%>%
  dplyr::select(
    -c(education, workknowledge, LIlenght, 
      drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown, 
      polposition, LIassociation, polparty, govtscheme, 
      foodadequacy, foodtrouble, food,
      healthdist, illness, severeillness,
      totalincome)
  )%>%
  mutate(
    score = rowMeans(dplyr::select(., human_asset, physical_asset, social_asset, financial_asset, food_security, health_status), na.rm = TRUE)
  )


other <- other_df%>%
  mutate(
    human_asset = rowMeans(dplyr::select(., education, workknowledge, LIlenght), na.rm = TRUE),
    physical_asset = rowMeans(dplyr::select(., drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown), na.rm = TRUE),
    social_asset = rowMeans(dplyr::select(., polposition, LIassociation, polparty, govtscheme), na.rm = TRUE),
    financial_asset = totalincome,
    food_security = rowMeans(dplyr::select(., foodadequacy, foodtrouble, food), na.rm = TRUE),
    health_status = rowMeans(dplyr::select(., healthdist, illness, severeillness), na.rm = TRUE)
  )%>%
  dplyr::select(
    -c(education, workknowledge, LIlenght, 
      drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown, 
      polposition, LIassociation, polparty, govtscheme, 
      foodadequacy, foodtrouble, food,
      healthdist, illness, severeillness,
      totalincome)
  )%>%
  mutate(
    score = rowMeans(dplyr::select(., human_asset, physical_asset, social_asset, financial_asset, food_security, health_status), na.rm = TRUE)
  )


```




```{r, echo = FALSE}

# lms now for each category and then putting them into a single table using stargazer 



nuclear_model <- nuclear_LI %>%  
  mutate(
    human_asset = rowMeans(dplyr::select(., education, workknowledge, LIlenght), na.rm = TRUE),
    physical_asset = rowMeans(dplyr::select(., drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown), na.rm = TRUE),
    social_asset = rowMeans(dplyr::select(., polposition, LIassociation, polparty, govtscheme), na.rm = TRUE),
    financial_asset = totalincome,
    food_security = rowMeans(dplyr::select(., foodadequacy, foodtrouble, food), na.rm = TRUE),
    health_status = rowMeans(dplyr::select(., healthdist, illness, severeillness), na.rm = TRUE)
  )%>%
  dplyr::select(
    -c(education, workknowledge, LIlenght, 
      drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown, 
      polposition, LIassociation, polparty, govtscheme, 
      foodadequacy, foodtrouble, food,
      healthdist, illness, severeillness,
      totalincome, Lfarmbigha, Ipropvalue, Lboat, animals)
  )%>%
  mutate(LIscore = rowMeans(dplyr::select(., human_asset, physical_asset, social_asset,financial_asset, food_security,health_status), na.rm = TRUE))



nuclearLI_lm <- lm(Risky_Nuclear ~ caste + gender + urban_rural + human_asset + physical_asset + social_asset + financial_asset + food_security + health_status , data = nuclear_model)

nuclearLI_lm2 <- lm(Risky_Nuclear ~ caste + gender + urban_rural + LIscore , data = nuclear_model)


summary(nuclearLI_lm)
summary(nuclearLI_lm2)
#plot(nuclearLI_lm)


```


```{r, echo=FALSE}
solar_LI <- addedcols %>% 
  dplyr::select(Risky_Solar,State, gender, caste, religion, urban_rural, age,  Livelihood_Income,education, workknowledge,LIlenght, subsidyknow, drinkingwater,cookingwater,farwatermins, wateravail,toilet, house,stove, vehicle, houseown, polposition, LIassociation,polparty, govtscheme, totalincome, Lfarmbigha,  Ipropvalue, Lboat, animals, foodadequacy, foodtrouble,food, healthdist, illness, severeillness)


# Solar dataframe for LSI/ISI with standardized values 

# Convert columns to numeric starting from 'education'
cols_to_convert <- names(solar_LI)[which(names(solar_LI) == 'education'):length(names(solar_LI))]
solar_LI[cols_to_convert] <- lapply(solar_LI[cols_to_convert], as.numeric)


# Standardize the values
standardize <- function(x) {
  (x - min(x, na.rm = TRUE)) / (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))
}

solar_LI[cols_to_convert] <- lapply(solar_LI[cols_to_convert], standardize)

# Displaying the first few rows of the dataframe
head(solar_LI)


solar_model <- solar_LI %>%  
  mutate(
    human_asset = rowMeans(dplyr::select(., education, workknowledge, LIlenght), na.rm = TRUE),
    physical_asset = rowMeans(dplyr::select(., drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown), na.rm = TRUE),
    social_asset = rowMeans(dplyr::select(., polposition, LIassociation, polparty, govtscheme), na.rm = TRUE),
    financial_asset = totalincome,
    food_security = rowMeans(dplyr::select(., foodadequacy, foodtrouble, food), na.rm = TRUE),
    health_status = rowMeans(dplyr::select(., healthdist, illness, severeillness), na.rm = TRUE)
  )%>%
  dplyr::select(
    -c(education, workknowledge, LIlenght, 
      drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown, 
      polposition, LIassociation, polparty, govtscheme, 
      foodadequacy, foodtrouble, food,
      healthdist, illness, severeillness,
      totalincome, Lfarmbigha, Ipropvalue, Lboat, animals)
  )%>%
  mutate(LIscore = rowMeans(dplyr::select(., human_asset, physical_asset, social_asset,financial_asset, food_security,health_status), na.rm = TRUE))

solarLI_lm <- lm(Risky_Solar ~ caste + gender + urban_rural + human_asset + physical_asset + social_asset + financial_asset + food_security + health_status , data = solar_model)

solarLI_lm2 <- lm(Risky_Solar ~ caste + gender + urban_rural + LIscore , data = solar_model)
summary(solarLI_lm)
summary(solarLI_lm2)
#plot(solarLI_lm)




```

```{r, echo = FALSE}
coal_LI <- addedcols %>% 
  dplyr::select(Risky_Coal, State, gender, caste, religion, urban_rural, age,  Livelihood_Income, education, workknowledge, LIlenght, subsidyknow, drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown, polposition, LIassociation, polparty, govtscheme, totalincome, Lfarmbigha,  Ipropvalue, Lboat, animals, foodadequacy, foodtrouble, food, healthdist, illness, severeillness)


# Coal dataframe for LSI/ISI with standardized values 

# Convert columns to numeric starting from 'education'
cols_to_convert <- names(coal_LI)[which(names(coal_LI) == 'education'):length(names(coal_LI))]
coal_LI[cols_to_convert] <- lapply(coal_LI[cols_to_convert], as.numeric)


# Standardize the values
standardize <- function(x) {
  (x - min(x, na.rm = TRUE)) / (max(x, na.rm = TRUE) - min(x, na.rm = TRUE))
}

coal_LI[cols_to_convert] <- lapply(coal_LI[cols_to_convert], standardize)

# Displaying the first few rows of the dataframe
#head(coal_LI)


coal_model <- coal_LI %>%  
  mutate(
    human_asset = rowMeans(dplyr::select(., education, workknowledge, LIlenght), na.rm = TRUE),
    physical_asset = rowMeans(dplyr::select(., drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown), na.rm = TRUE),
    social_asset = rowMeans(dplyr::select(., polposition, LIassociation, polparty, govtscheme), na.rm = TRUE),
    financial_asset = totalincome,
    food_security = rowMeans(dplyr::select(., foodadequacy, foodtrouble, food), na.rm = TRUE),
    health_status = rowMeans(dplyr::select(., healthdist, illness, severeillness), na.rm = TRUE)
  )%>%
  dplyr::select(
    -c(education, workknowledge, LIlenght, 
      drinkingwater, cookingwater, farwatermins, wateravail, toilet, house, stove, vehicle, houseown, 
      polposition, LIassociation, polparty, govtscheme, 
      foodadequacy, foodtrouble, food,
      healthdist, illness, severeillness,
      totalincome, Lfarmbigha, Ipropvalue, Lboat, animals)
  )%>%
  mutate(LIscore = rowMeans(dplyr::select(., human_asset, physical_asset, social_asset,financial_asset, food_security,health_status), na.rm = TRUE)) 




coalLI_lm <- lm(Risky_Coal ~ caste + gender + urban_rural + human_asset + physical_asset + social_asset + financial_asset + food_security + health_status, data = coal_model)

coalLI_lm2 <- lm(Risky_Coal ~ caste + gender + urban_rural + LIscore, data = coal_model)

summary(coalLI_lm)
summary(coalLI_lm2)
#plot(coalLI_lm)




```


\newpage

# Linear Regression Models with asset groups

```{r, echo=FALSE, results='asis'}
library(stargazer)

#stargazer code for all demographic variable lms 


cat("\\begingroup")
cat("\\setlength{\\tabcolsep}{1pt}")
cat("\\renewcommand{\\arraystretch}{0.7}")
stargazer(nuclearLI_lm, solarLI_lm, coalLI_lm,
          title = "Assets",
          type = "latex"
)
cat("\\endgroup")


```


# Linear Regression Models with livelihood security and income security indeces

```{r, echo=FALSE, results='asis'}
library(stargazer)

#stargazer code for all demographic variable lms 


cat("\\begingroup")
cat("\\setlength{\\tabcolsep}{1pt}")
cat("\\renewcommand{\\arraystretch}{0.7}")
stargazer(nuclearLI_lm2, solarLI_lm2, coalLI_lm2,
          title = "Livelihood and Income Security",
          type = "latex"
)
cat("\\endgroup")


```



```{r, echo = FALSE}
#  Cronbach's alpha test and CFA on JIS scale 


JIS <- codedmodule1 %>%
  dplyr::select(JISRkeep,JISlosefuture, JISlose, JISfuture)%>%
  na.omit()

JIS_alpha <- psych::alpha(JIS, check.keys = TRUE)

# alpha = 0.69 - not bad - not too good. 


library(lavaan)

JIS_fas <- '
  JISs =~ JISRkeep + JISlosefuture + JISlose + JISfuture 
  '

# Run CFA
JIS_cfa <- cfa(JIS_fas, data = JIS , std.lv = TRUE)

# Print the summary of the CFA results, including fit measures
summary(JIS_cfa, fit.measure= TRUE, standardized = TRUE)


# RMSEA - between 0.05 and 0.08 (reasonable fit), less than 0.05 close fit and greater than 0.10 is poor fit 
# CFI - greater than 0.90 or 0.95 indicates good fit
#TFI - CFI>TFI >0.90 - indicates good fit



JIS_scores <- predict(JIS_cfa, newdata = JIS)

JIS_data <- codedmodule1 %>% select(Risky_Nuclear, gender, caste, urban_rural, religion, JISRkeep, JISlosefuture, JISlose, JISfuture) %>%
  filter(!is.na(JISRkeep) & !is.na(JISlosefuture)  & !is.na(JISlose)  & !is.na(JISfuture))
  

JIS_Jscores <- cbind(JIS_data, JIS_scores)


JIS_lm1 <- lm(Risky_Nuclear ~ caste + gender + urban_rural+ JIS_scores, data = JIS_Jscores)

summary(JIS_lm1) 



```

```{r, echo=FALSE}

LSI2 <- codedmodule1 %>% select(Risky_Nuclear, Risky_Solar, Risky_Coal, gender, caste, urban_rural, religion, Lconfidence) %>%
  filter(!is.na(Lconfidence))


LSI2_lm1 <- lm(Risky_Nuclear ~ caste + gender + urban_rural+ Lconfidence, data = LSI2)

summary(LSI2_lm1) 

```

# Linear Regression Models with perceived livelihood and income security 



```{r, echo=FALSE, results='asis'}
library(stargazer)

#stargazer code for all demographic variable lms 


cat("\\begingroup")
cat("\\setlength{\\tabcolsep}{1pt}")
cat("\\renewcommand{\\arraystretch}{0.7}")
stargazer(JIS_lm1, LSI2_lm1, 
          title = "Perceived livelihood or job security",
          type = "latex"
)
cat("\\endgroup")


```




\newpage

#Extra


```{r, echo = FALSE}

##checking stuff
codedmodule1 

codedmodule1 %>%
  filter(Livelihood_Income == "LSI") %>%
  count(Lfarmland)
codedmodule1 %>%
  count(Iproperty)

lapply(codedmodule1, unique)
ncol(codedmodule1)
colnames(codedmodule1)

str(codedmodule1)



```














# Livelihood/Income Security scale adapted from Kamaruddin and Samsudin(2014)

Human Asset

education - 	    What is the highest level of education you have received? If currently enrolled, highest degree received.

workknowledge -   How would you rate your level of knowledge about your work ?

LIlenght-         How long have you been in your current line of work?

subsidyknow -     How would you rate your knowledge concerning how to obtain information about subsidies or aid from the government or any other agencies ?

Physical Asset 

drinkingwater   	What is the main source of drinking water for the members of your household?
cookingwater      What is the main source of water used by your\r\nhousehold for other purposes such as cooking and\r\nhandwashing?
farwatermins      How long does it take to go there, get water, and come\r\nback? 
toilet            What kind of toilet facility do members of your\r\nhousehold usually use?
house
stove
vehicle
houseown



Social Asset

polposition
LIassociation
polparty


Financial Asset

Income 

Natural Asset

Lfarmland
Lfarmbigha
Iproperty
Ipropvalue
Lboat
animals

Livelihood Outcomes

Foodsecurity 

foodadequacy 
foodtrouble


Health Status

healthdist
illness
severeillness





