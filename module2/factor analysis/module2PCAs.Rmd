---
title: "PCAs"
output: word_document

---

```{r load packages, warning = FALSE, message = FALSE, echo=FALSE}
  knitr::opts_chunk$set(warning = FALSE, message = FALSE)

suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(readxl))

suppressPackageStartupMessages(library(tsibble))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(DT))

suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(psych)) # psychometrics

```



```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
moduletwo <- read_excel(here::here("thesis_surveydata/political_factors_complete.xlsx"))
save(moduletwo, file = "moduletwo.rda")
module2 <- data.frame(moduletwo)
module2[module2 == "Rather not say/ Don't know"] <- "Rather not say/Don't know"
#module2 %>% filter(!row_number() %in% c(1,2))

# loaded data set for module 2 eco -pol variables and removes the rows with question number and question text
```


```{r, eval =TRUE, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
#This chunk contains the coding schemes of various scales used in survey one: eco-political factors, kahan scale and acceptance scale
codedmodule2 <- module2 %>%
  
#remove row 1
  filter(!row_number() %in% c(1,2)) %>% 
  
# replace risky likert scale with numbers
  mutate_at(vars(starts_with("Risky")), funs(case_when(. =="Not at all risky" ~ 1, 
                                                       . =="Slightly risky" ~ 2, 
                                                       . =="Moderately risky" ~ 3, 
                                                       . =="Very risky" ~ 4, 
                                                       . =="Extremely risky" ~ 5))) %>%

# replace beneficial likert scale with numbers  
  mutate_at(vars(starts_with("Ben")), funs(case_when(. =="Not at all beneficial" ~ 1,
                                                     . =="Slightly beneficial" ~ 2,
                                                     . =="Moderately beneficial" ~ 3,
                                                     . =="Very beneficial" ~ 4,
                                                     . =="Extremely beneficial" ~ 5 ))) %>%

# replace nuclear acceptance likert scale with numbers
  mutate_at(vars(N_accept,N_reluctantlyaccept,N_reject), funs(case_when(. == "Strongly disagree" ~ 1, 
                                                                        . == "Somewhat disagree" ~ 2,
                                                                        . == "Neither agree nor disagree" ~3,
                                                                        . == "Somewhat agree" ~ 4,
                                                                        . == "Strongly agree" ~ 5))) %>%
  
# code likert scale for variables for Kahan scale into numbers
  mutate_at(vars(starts_with (c("K_I","K_H","DISPLACE", "POLLUTE", "HEALTH", "JOBS", "BEAUTY", "PRIDE", "NPRIDE", "DEV", "PROSPER", "RELY"))), funs(case_when(. == "Strongly disagree" ~ 1, 
               . == "Somewhat disagree" ~ 2,
               . == "Neither agree nor disagree" ~3,
               . == "Somewhat agree" ~ 4,
               . == "Strongly agree" ~ 5))) %>%
  
# reverse code for likert scale for variables for Kahan scale into numbers
mutate_at(vars(starts_with (c("K_S","K_E"))), funs(case_when(. == "Strongly disagree" ~ 1, 
                                                               . == "Somewhat disagree" ~ 2,
                                                               . == "Neither agree nor disagree" ~3,
                                                               . == "Somewhat agree" ~ 4,
                                                               . == "Strongly agree" ~ 5))) %>%

# code eco-pol scale variables into numbers
  mutate_at(vars(SYSTEMDEMO,SYSTEMRELIGION,SYSTEMTECHNO,SYSTEMTOTAL,WEALTHLIM,MECHANISATION,DECISIONDECEN,INDUSTRYLARGE,ECONOMYGLOBAL,OWNERPVT,OWNERNOREG), funs(case_when(. == "Strongly disagree" ~ 1, 
                        . == "Somewhat disagree" ~ 2,
                        . == "Neither agree nor disagree" ~3,
                        . == "Somewhat agree" ~ 4,
                        . == "Strongly agree" ~ 5))) %>%

# reverse code eco-pol scale variables into numbers 
 mutate_at(vars(DECISIONCEN, INDUSTRYSMALL, ECONOMYLOCAL, ENVOVERDEV,OWNERPUB, OWNERREG), funs(case_when(. == "Strongly disagree" ~ 1, 
                                                                                                         . == "Somewhat disagree" ~ 2,
                                                                                                         . == "Neither agree nor disagree" ~3,
                                                                                                         . == "Somewhat agree" ~ 4,
                                                                                                         . == "Strongly agree" ~ 5)))
```

**Kahan et al (2007) scale**

Individualism - Communitarinism 

- **K_IINTRFER**	The government interferes far too much in our everyday lives.
- **K_IPRIVACY**	The government should stop telling people how to live their lives.
- **K_SHARM**	    Sometimes the government needs to make laws that keep people from hurting themselves.
- **K_IPROTECT**	It’s not the government’s business to try to protect people from themselves.
- **K_SLIMCHOI**	The government should put limits on the choices individuals can make so they don’t get in the way of what’s good for society.
- **K_SPROTECT**	The government should do more to advance society’s goals, even if that means limiting the freedom and choices of individuals.

Hierarchy -Egalitarianism

- **K_HEQUAL**	  We have gone too far in pushing equal rights in this country.
- **K_HREVDIS1**	Nowadays it seems like there is just as much discrimination against upper castes as there is against Dalits.
- **K_EDISCRIM**	Discrimination against minorities is still a very serious problem in our society.
- **K_ERADEQ1**	  We need to dramatically reduce inequalities between the rich and the poor.
- **K_EWEALTH**	  Our society would be better off if the distribution of wealth was more equal.
- **K_ERADEQ2**	  We need to dramatically reduce inequalities between men and women.


Cronbach's alpha test on the Kahan et al (2007) scale

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

library(ltm)

#cronbach alpha

KahanS <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_S", "K_I")))%>%
  na.omit()


KahanI <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_I")))%>%
  na.omit()

#K_S items produce a strong alpha but not K_I

KahanI.alpha <- psych::alpha(KahanI)

KahanS.alpha <- psych::alpha(KahanS, check.keys = TRUE)

KahanE <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_H", "K_E")))%>%
  na.omit()

KahanE.alpha <- psych::alpha(KahanE, check.keys = TRUE)

```


Factor Analysis on Kahan et al (2007) scale: 2 factor spaces

```{r, echo=FALSE}


#factor analysis on Kahan scale: 2 factor spaces
Kahan <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_")))%>%
  na.omit()

Kahan.fa <- fa(Kahan, nfactors=2, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(Kahan.fa, cut = 0.3, sort = TRUE)
#fa.diagram(Kahan.fa)

loadingskahan <- unclass(Kahan.fa$loadings)

loadingstablekahan <- cbind(loadingskahan) 

twofakahan <- as_tibble(loadingstablekahan) %>%
add_column("Items" = c("The government interferes far too much in our everyday lives", 
"The government should stop telling people how to live their lives", 
"Sometimes the government needs to make laws that keep people from hurting themselves" , 
"It’s not the government’s business to try to protect people from themselves", 
"The government should put limits on the choices individuals can make so they don’t get in the way of what’s good for society", 
"The government should do more to advance society’s goals, even if that means limiting the freedom and choices of individuals", 
"We have gone too far in pushing equal rights in this country",
"Nowadays it seems like there is just as much discrimination against upper castes as there is against Dalits",
"Discrimination against minorities is still a very serious problem in our society", 
"We need to dramatically reduce inequalities between the rich and the poor",
"Our society would be better off if the distribution of wealth was more equal",
"We need to dramatically reduce inequalities between men and women")) %>%
dplyr::select("Items",  PA1, PA2) %>%
  arrange(desc(PA1))
  
knitr::kable(twofakahan, digits = 2)
  
VarexplK <- unclass(Kahan.fa$Vaccounted)

knitr::kable(VarexplK, digits = 2)
```


Factor Analysis on Kahan et al (2007) scale: 4 factor spaces

```{r, echo=FALSE}
#factor analysis on Kahan scale: 4 factor spaces 
Kahan <- codedmodule2 %>%
  dplyr::select(starts_with(c("K_")))%>%
  na.omit()

fourKahan.fa <- fa(Kahan, nfactors=4, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(Kahan.fa, cut = 0.3, sort = TRUE)
#fa.diagram(Kahan.fa)


fourloadingskahan <- unclass(fourKahan.fa$loadings)

fourloadingstablekahan <- cbind(fourloadingskahan) 

fourfakahan <- as_tibble(fourloadingstablekahan) %>%
add_column("Items" = c("The government interferes far too much in our everyday lives", 
"The government should stop telling people how to live their lives", 
"Sometimes the government needs to make laws that keep people from hurting themselves" , 
"It’s not the government’s business to try to protect people from themselves", 
"The government should put limits on the choices individuals can make so they don’t get in the way of what’s good for society", 
"The government should do more to advance society’s goals, even if that means limiting the freedom and choices of individuals", 
"We have gone too far in pushing equal rights in this country",
"Nowadays it seems like there is just as much discrimination against upper castes as there is against Dalits",
"Discrimination against minorities is still a very serious problem in our society", 
"We need to dramatically reduce inequalities between the rich and the poor",
"Our society would be better off if the distribution of wealth was more equal",
"We need to dramatically reduce inequalities between men and women")) %>%
dplyr::select("Items",  PA1, PA2, PA3, PA4)%>%
  arrange(desc(PA1))

  
knitr::kable(fourfakahan, digits= 2)
  
VarexplK <- unclass(fourKahan.fa$Vaccounted)

knitr::kable(VarexplK, digits = 2)
```



**The economic -political values of the perceiver scale**


- **DECISIONDECEN**	 Local politicians shouldn't have to ask permission from the central government to implement policies
- **DECISIONCEN**	   Laws and policies would be implemented more smoothly if more power lay with the central government.
- **SYSTEMTOTAL**	   It is good to have a strong leader who does not have to bother with elections.
- **SYSTEMTECHNO**	 Experts, not the government, should make decisions according to what they think is best for the country.
- **SYSTEMDEMO**	   It is very important to have a democratic political system because it ensures that no individual leader has too much power.
- **SYSTEMRELIGION** There should be a system governed by religious law.
- **INDUSTRYSMALL**	 Large corporations are destroying the local industries in India and benefiting only a handful of people.
- **INDUSTRYLARGE**	 Large scale industries are required for the development of the country that will benefit everyone
- **ECONOMYLOCAL**	 India would be better off if foreign companies didn't come to here
- **ECONOMYGLOBAL**	 Foreign companies have led to a range of benefits for the Indian people and society
- **DEVOVERENV**	   Economic growth and creating jobs should be prioritized over environmental protection
- **ENVOVERDEV**	   Polluting industries that spoil the environment should be shut down even if it costs people their jobs
- **OWNERPVT**	     All businesses and industries should be owned privately
- **OWNERPUB**	     The government should own most large businesses and industries
- **OWNERREG**	     Regardless of ownership, the government should pass strong regulations and implement them
- **OWNERNOREG**	   There is too much red-tape and the government should not interfere with businesses and industries
- **WEALTHLIM**	     A limit should be put to how much wealth a person can amass
- **MECHANISATION**	 Rapid mechanization of work is taking away jobs from workers in this country




Cronbach's alpha test on the economic -political values of the perceiver


```{r, echo= FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
ecopolscalescores <- codedmodule2 %>%
 dplyr::select(starts_with(c("SYSTEMDEMO","SYSTEMRELIGION","SYSTEMTECHNO","SYSTEMTOTAL","WEALTHLIM","MECHANISATION","DECISIONDECEN","DECISIONCEN","INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL","ECONOMYLOCAL", "ENVOVERDEV","DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG")))%>%
  rowwise()%>%
  na.omit()#%>%
  #dplyr::mutate(Pro_decentralisation = mean(c_across("DECISIONDECEN":"DECISIONCEN")))%>%
   #dplyr::mutate(Pro_largescale = mean(c_across("INDUSTRYLARGE":"INDUSTRYSMALL")))%>%
   #dplyr::mutate(Pro_global = mean(c_across("ECONOMYGLOBAL":"ECONOMYLOCAL")))%>%
   #dplyr::mutate(Pro_ecogrowth = mean(c_across("ENVOVERDEV":"DEVOVERENV")))%>%
   #dplyr::mutate(Pro_private = mean(c_across("OWNERPVT":"OWNERREG")))%>%
  #dplyr::select(!c("DECISIONDECEN","DECISIONCEN", "INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL", "ECONOMYLOCAL","ENVOVERDEV",     "DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG"))

#cronbach alpha

psych::alpha(ecopolscalescores, check.keys = TRUE)

```



Factor Analysis on the economic and political values scale: 2 factor spaces


```{r, echo=FALSE}

#factor analysis with 2, 4 and 6 factor spaces

ecopolscale.fa <- fa(ecopolscalescores, nfactors=2, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(ecopolscale.fa, cut = 0.3, sort = TRUE)
#fa.diagram(ecopolscale.fa)

loadingsecopol <- unclass(ecopolscale.fa$loadings)

loadingstableecopol <- cbind(loadingsecopol) 

twofaecopol <- as_tibble(loadingstableecopol) %>%
add_column("Items" = c("Local politicians shouldn't have to ask permission from the central government to implement policies",
 "Laws and policies would be implemented more smoothly if more power lay with the central government",
"It is good to have a strong leader who does not have to bother with elections", 
 "Experts, not the government, should make decisions according to what they think is best for the country" , 
"It is very important to have a democratic political system because it ensures that no individual leader has too much power" , 
"There should be a system governed by religious law" , 
"Large corporations are destroying the local industries in India and benefiting only a handful of people" , 
"Large scale industries are required for the development of the country that will benefit everyone" , 
"India would be better off if foreign companies didn't come to here" , 
"Foreign companies have led to a range of benefits for the Indian people and society", 
"Economic growth and creating jobs should be prioritized over environmental protection" , 
"Polluting industries that spoil the environment should be shut down even if it costs people their jobs", 
"All businesses and industries should be owned privately", 
"The government should own most large businesses and industries", 
"Regardless of ownership, the government should pass strong regulations and implement them", 
"There is too much red-tape and the government should not interfere with businesses and industries" , 
"A limit should be put to how much wealth a person can amass",
 "Rapid mechanization of work is taking away jobs from workers in this country"))%>%
dplyr::select("Items",PA1, PA2)%>%
arrange(desc(PA1))
  
knitr::kable(twofaecopol, digits= 2)
  
Varexplecopol <- unclass(ecopolscale.fa$Vaccounted)

knitr::kable(Varexplecopol, digits = 2)




```

Factor Analysis on the economic and political values scale: 4 factor spaces

```{r, echo=FALSE}
#factor analysis with 4 factor spaces

ecopolscale4.fa <- fa(ecopolscalescores, nfactors=4, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(ecopolscale.fa, cut = 0.3, sort = TRUE)
#fa.diagram(ecopolscale.fa)

loadingsecopol4 <- unclass(ecopolscale4.fa$loadings)

loadingstableecopol4 <- cbind(loadingsecopol4) 

faecopol4 <- as_tibble(loadingstableecopol4) %>%
add_column("Items" = c("Local politicians shouldn't have to ask permission from the central government to implement policies",
 "Laws and policies would be implemented more smoothly if more power lay with the central government",
"It is good to have a strong leader who does not have to bother with elections", 
 "Experts, not the government, should make decisions according to what they think is best for the country" , 
"It is very important to have a democratic political system because it ensures that no individual leader has too much power" , 
"There should be a system governed by religious law" , 
"Large corporations are destroying the local industries in India and benefiting only a handful of people" , 
"Large scale industries are required for the development of the country that will benefit everyone" , 
"India would be better off if foreign companies didn't come to here" , 
"Foreign companies have led to a range of benefits for the Indian people and society", 
"Economic growth and creating jobs should be prioritized over environmental protection" , 
"Polluting industries that spoil the environment should be shut down even if it costs people their jobs", 
"All businesses and industries should be owned privately", 
"The government should own most large businesses and industries", 
"Regardless of ownership, the government should pass strong regulations and implement them", 
"There is too much red-tape and the government should not interfere with businesses and industries" , 
"A limit should be put to how much wealth a person can amass",
 "Rapid mechanization of work is taking away jobs from workers in this country"))%>%
dplyr::select("Items",PA1, PA2, PA3, PA4) %>%
  arrange(desc(PA1))
  
knitr::kable(faecopol4, digits= 2)
  
Varexplecopol4 <- unclass(ecopolscale4.fa$Vaccounted)

knitr::kable(Varexplecopol4, digits = 2)


```



Factor Analysis on the economic and political values scale: 6 factor spaces


```{r, echo=FALSE}

ecopolscale6.fa <- fa(ecopolscalescores, nfactors=6, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(ecopolscale.fa, cut = 0.3, sort = TRUE)
#fa.diagram(ecopolscale.fa)

loadingsecopol6 <- unclass(ecopolscale6.fa$loadings)
 
loadingstableecopol6 <- cbind(loadingsecopol6) 

faecopol6 <- as_tibble(loadingstableecopol6) %>%
add_column("Items" = c("Local politicians shouldn't have to ask permission from the central government to implement policies",
 "Laws and policies would be implemented more smoothly if more power lay with the central government",
"It is good to have a strong leader who does not have to bother with elections", 
 "Experts, not the government, should make decisions according to what they think is best for the country" , 
"It is very important to have a democratic political system because it ensures that no individual leader has too much power" , 
"There should be a system governed by religious law" , 
"Large corporations are destroying the local industries in India and benefiting only a handful of people" , 
"Large scale industries are required for the development of the country that will benefit everyone" , 
"India would be better off if foreign companies didn't come to here" , 
"Foreign companies have led to a range of benefits for the Indian people and society", 
"Economic growth and creating jobs should be prioritized over environmental protection" , 
"Polluting industries that spoil the environment should be shut down even if it costs people their jobs", 
"All businesses and industries should be owned privately", 
"The government should own most large businesses and industries", 
"Regardless of ownership, the government should pass strong regulations and implement them", 
"There is too much red-tape and the government should not interfere with businesses and industries" , 
"A limit should be put to how much wealth a person can amass",
 "Rapid mechanization of work is taking away jobs from workers in this country"))%>%
dplyr::select("Items",PA1, PA2, PA3, PA4, PA5, PA6) %>%
  arrange(desc(PA1))
  
knitr::kable(faecopol6, digits= 2)
  
Varexplecopol6 <- unclass(ecopolscale6.fa$Vaccounted)

knitr::kable(Varexplecopol6, digits = 2)
```





**Economic and Political characteristics of the energy technology scale -  Solar Energy and rooftop solar energy**


- **DISPLACESOLAR**	 Solar energy is leading to displacement of people from their land
- **POLLUTESOLAR**	 Solar energy increases pollution of air/water/land
- **HEALTHSOLAR**	   Solar energy poses a great risk to the health of people living around it
- **JOBSSOLAR**	     Solar energy will bring jobs to the local community
- **BEAUTYSOLAR**	   Solar energy spoils the natural beauty of the landscape
- **PRIDESOLAR**	   I would be proud if my community used solar energy
- **NPRIDESOLAR**	   Solar energy is a mark of pride for our nation
- **DEVSOLAR**	     Solar energy pushes forward the country's development
- **PROSPERSOLAR**	 Solar energy brings economic prosperity to the surrounding regions
- **RELYSOLAR**	     I don't like the idea that I have to rely on the government for electricity from (large scale) solar energy




Cronbach's alpha test on the Eco-Pol characteristics of the technology -  Solar Energy

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

#alpha test on Eco-pol characteristics of the technology

Solar <- codedmodule2 %>%
dplyr::select("DISPLACESOLAR":"RELYSOLAR") %>%
dplyr::rename("Solar energy is leading to displacement of people from their land" = "DISPLACESOLAR") %>%
dplyr::rename("Solar energy increases pollution of air/water/land" = "POLLUTESOLAR")%>%
dplyr::rename("Solar energy poses a great risk to the health of people living around it" = "HEALTHSOLAR")%>%
dplyr::rename("Solar energy will bring jobs to the local community" = "JOBSSOLAR")%>%
dplyr::rename("Solar energy spoils the natural beauty of the landscape" = "BEAUTYSOLAR")%>%
dplyr::rename("I would be proud if my community used solar energy" = "PRIDESOLAR")%>%
dplyr::rename("Solar energy is a mark of pride for our nation" = "NPRIDESOLAR") %>%
dplyr::rename("Solar energy pushes forward the country's development" = "DEVSOLAR")%>%
dplyr::rename("Solar energy brings economic prosperity to the surrounding regions" = "PROSPERSOLAR")%>%
dplyr::rename("I don't like the idea that I have to rely on the government for electricity from (large scale solar energy)" = "RELYSOLAR")%>%
  na.omit()


psych::alpha(Solar, check.keys = TRUE)




```



Factor Analysis on the eco- pol characteristics of the technology, Solar Energy : 2 factor spaces


```{r, echo=FALSE}

#factor analysis with 2 factor spaces

solar.fa <- fa(Solar, nfactors=2, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(solar.fa, cut = 0.4, sort = TRUE)
#fa.diagram(solar.fa)

loadingssolar <- unclass(solar.fa$loadings)

loadingstablesolar <- cbind(loadingssolar) 

fasolar <- as_tibble(loadingstablesolar) %>%
add_column("Items" = c("Solar energy is leading to displacement of people from their land",
"Solar energy increases pollution of air/water/land",
"Solar energy poses a great risk to the health of people living around it",
"Solar energy will bring jobs to the local community",
"Solar energy spoils the natural beauty of the landscape",
"I would be proud if my community used solar energy",
"Solar energy is a mark of pride for our nation",
"Solar energy pushes forward the country's development",
"Solar energy brings economic prosperity to the surrounding regions",
"I don't like the idea that I have to rely on the government for electricity from (large scale) solar energy"))%>%
dplyr::select("Items",PA1, PA2)%>%
arrange(desc(PA1))
  
knitr::kable(fasolar, digits= 2)
  
Varexplsolar <- unclass(solar.fa$Vaccounted)

knitr::kable(Varexplsolar, digits = 2)
```



Factor Analysis on the eco- pol characteristics of the technology, Solar Energy : 4 factor spaces


```{r, echo=FALSE}

#factor analysis with  4 a factor spaces

solar4.fa <- fa(Solar, nfactors=4, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(solar.fa, cut = 0.4, sort = TRUE)
#fa.diagram(solar.fa)

loadingssolar4 <- unclass(solar4.fa$loadings)

loadingstablesolar4 <- cbind(loadingssolar4) 

fasolar4 <- as_tibble(loadingstablesolar4) %>%
add_column("Items" = c("Solar energy is leading to displacement of people from their land",
"Solar energy increases pollution of air/water/land",
"Solar energy poses a great risk to the health of people living around it",
"Solar energy will bring jobs to the local community",
"Solar energy spoils the natural beauty of the landscape",
"I would be proud if my community used solar energy",
"Solar energy is a mark of pride for our nation",
"Solar energy pushes forward the country's development",
"Solar energy brings economic prosperity to the surrounding regions",
"I don't like the idea that I have to rely on the government for electricity from (large scale) solar energy"))%>%
dplyr::select("Items",PA1, PA2, PA3, PA4) %>%
  arrange(desc(PA1))
  
knitr::kable(fasolar4, digits= 2)
  
Varexplsolar4 <- unclass(solar4.fa$Vaccounted)

knitr::kable(Varexplsolar4, digits = 2)
```



```{r, echo=FALSE}
ROOFS<- codedmodule2 %>%
 dplyr::select("DISPLACEROOFS":"RELYROOFS")

psych::alpha(ROOFS, check.keys = TRUE)

```



```{r, echo=FALSE}
#factor analysis with 2, 4 and 6 factor spaces

roofs.fa <- fa(ROOFS, nfactors=2, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(roofs.fa, cut = 0.4, sort = TRUE)
#fa.diagram(roofs.fa)

loadingsroofs <- unclass(roofs.fa$loadings)

loadingstableroofs <- cbind(loadingsroofs) 

faroofs <- as_tibble(loadingstableroofs) %>%
add_column("Items" = c("Rooftop solar is leading to displacement of people from their land",
"Rooftop solar increases pollution of air/water/land", 
"Rooftop solar poses a great risk to the health of people living around it",
"Rooftop solar will bring jobs to the local community",
"Rooftop solar spoils the natural beauty of the landscape" , 
"I would be proud if my community used Rooftop solar" , 
"Rooftop solar is a mark of pride for our nation", 
"Rooftop solar pushes forward the country's development" , 
"Rooftop solar brings economic prosperity to the surrounding regions" , 
"I don't like the idea that I have to rely on the government for electricity from (large scale) Rooftop solar")) %>%
dplyr::select("Items",  PA1, PA2)%>%
  arrange(desc(PA1))
  
knitr::kable(faroofs, digits = 2)
  

Varexplroofs <- unclass(roofs.fa$Vaccounted)

knitr::kable(Varexplroofs, digits = 2)

```










