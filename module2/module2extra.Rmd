---
title: "module2extra"
output:
  html_document:
    fig_width: 7
    fig_height: 6
    fig_caption: yes
    keep_md: yes
    theme: paper
    df_print: paged
---

```{r}

likertmodule2 <- module2%>%
  filter(!row_number() %in% c(1,2)) %>% 
  select(starts_with("Ben"))%>%
  gather(Technology, Perceived_Benefit, Ben_Hydro:Ben_INDKerosene)%>%
  separate(Technology, c("Ben", "Technology"), extra = "merge", fill = "left")%>%
  select(-Ben) %>% 
  group_by(Technology, Perceived_Benefit) %>%
  dplyr::summarise(n=n())%>%
  mutate(Perceived_Benefit = factor(Perceived_Benefit,  levels = c("Rather not say/Don't know","Not at all beneficial","Slightly beneficial","Moderately beneficial","Very beneficial", "Extremely beneficial")))%>%
  pivot_wider(names_from = Perceived_Benefit, values_from = n)%>%
  rename("NA1"="Rather not say/Don't know")%>%
  select("Technology","Not at all beneficial","Slightly beneficial","Moderately beneficial","Very beneficial", "Extremely beneficial", "NA1","NA")%>%
  unite("Rather not say/Don't know", "NA1":"NA", na.rm = TRUE, remove = FALSE)%>%
  select(!c("NA1","NA"))

```


```{r}
#summary statistics for nuclear energy accept, reject and reluctantly accept scale
codedmodule2 %>%
  summarize_at(vars(N_accept,N_reject,N_reluctantlyaccept), list(~mean(., na.rm = TRUE),~median(., na.rm = TRUE), ~sd(.,na.rm = TRUE),~var(.,na.rm = TRUE),~n())) %>%
  add_rownames() %>%
  gather(acceptance, value, -rowname) %>%
  separate(acceptance, c("N_accept", "var") ,  extra = "merge", fill = "left") %>%
  separate(var, c("Acceptance", "summary")) %>%
  spread(summary, value) %>%
  select(-rowname, -N_accept)%>%
  arrange(mean)

```


```{r}

# chi square test for risk perception from nuclear energy and gender, race 

# first combine gender and caste variables

chitest <- codedmodule2 %>%
  select(Risky_Nuclear,Risky_Hydro, Risky_Hydro, Risky_Solar,Urban_Rural, Gender, Caste) %>%
  na.omit() %>%
  filter(!Caste=="Rather not say/Don't know")%>%
  unite(gendercaste, Gender, Caste, sep = "_", remove = FALSE)

chitest

```



```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

KPC_var <-data.frame(var_explainedK, row.names=names(rotationsK)) %>%
          tibble::rownames_to_column("PC")

KPC_var

  
```


```{r}
#%>%
  #separate(Var, c("prefix", "Var", "technology"), sep = c(0,-5), remove = T)%>%
 # select(!"prefix")
# %>%
  #pivot_longer(cols ="DISPLACEROOFS":"RELYROOFS", names_to = "Var", values_to = "score") %>%
  #separate(Var, c("prefix", "Var", "technology"), sep = c(0,-5), remove = T)%>%
  #select(!"prefix")
  
#DIESEL<- codedmodule2 %>%
  #select("DISPLACEDIESEL":"RELYDIESEL")%>%
  #pivot_longer(cols ="DISPLACEDIESEL":"RELYDIESEL", names_to = "Var", values_to = "score") %>%
  #separate(Var, c("prefix", "Var", "technology"), sep = c(0,-6), remove = T)%>%
  #select(!"prefix")
```


```{r}
rotations = pcaresultsK["rotation"]

#calculate total variance explained by each principal component
var_explainedK <- pcaresultsK$sdev^2 / sum(pcaresultsK$sdev^2)


rotationsK <- do.call(rbind.data.frame, rotations)%>%
              tibble::rownames_to_column("Variables") 
              
rotationsK


pcatableK  <- summary(pcaresultsK)

UnclassedK <- unclass(pcatableK)

ImportanceK <- UnclassedK["importance"]

varexplK <- do.call(rbind.data.frame, ImportanceK) 
 
KPCAtable <- data.frame(t(varexplK), row.names=names(varexplK))

as_tibble(KPCAtable) %>%
 add_column("Principal Components" = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9", "PC10", "PC11", "PC12"))%>%
 dplyr::select("Principal Components",  importance.Proportion.of.Variance, importance.Cumulative.Proportion ) %>%  
 dplyr::rename(Proportion_of_Variance = importance.Proportion.of.Variance, Cumulative_Proportion = importance.Cumulative.Proportion)
```

\newpage






```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

qplot(c(1:12), var_explainedK) + 
  geom_line() + 
  xlab("Principal Component") + 
  ylab("Variance Explained") +
  ggtitle("Scree Plot") +
  ylim(0, 0.30)+
  xlim(1,7)


```

\newpage

# **The economic -political values of the perceiver scale**


- **DECISIONDECEN**	 Local politicians shouldn't have to ask permission from the central government to implement policies
- **DECISIONCEN**	   Laws and policies would be implemented more smoothly if more power lay with the central government.
- **SYSTEMTOTAL**	   It is good to have a strong leader who does not have to bother with elections.
- **SYSTEMTECHNO**	 Experts, not the government, should make decisions according to what they think is best for the country.
- **SYSTEMDEMO**	   It is very important to have a democratic political system because it ensures that no individual leader has too much power.
- **SYSTEMRELIGION** There should be a system governed by religious law.
- **INDUSTRYSMALL**	 Large corporations are destroying the local industries in India and benefiting only a handful of people.
- **INDUSTRYLARGE**	 Large scale industries are required for the development of the country that will benefit everyone
- **ECONOMYLOCAL**	 India would be better off if foreign companies didn't come to here
- **ECONOMYGLOBAL**	 Foreign companies have led to a range of benefits for the Indian people and society
- **DEVOVERENV**	   Economic growth and creating jobs should be prioritized over environmental protection
- **ENVOVERDEV**	   Polluting industries that spoil the environment should be shut down even if it costs people their jobs
- **OWNERPVT**	     All businesses and industries should be owned privately
- **OWNERPUB**	     The government should own most large businesses and industries
- **OWNERREG**	     Regardless of ownership, the government should pass strong regulations and implement them
- **OWNERNOREG**	   There is too much red-tape and the government should not interfere with businesses and industries
- **WEALTHLIM**	     A limit should be put to how much wealth a person can amass
- **MECHANISATION**	 Rapid mechanization of work is taking away jobs from workers in this country


## Cronbach's alpha test on the economic -political values of the perceiver
```{r, echo= FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
ecopolscalescores <- codedmodule2 %>%
 dplyr::select(starts_with(c("Risky","SYSTEMDEMO","SYSTEMRELIGION","SYSTEMTECHNO","SYSTEMTOTAL","WEALTHLIM","MECHANISATION","DECISIONDECEN","DECISIONCEN","INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL","ECONOMYLOCAL", "ENVOVERDEV","DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG", "Gender","Caste","Religion", "State")))%>%
  rowwise()%>%
  na.omit()%>%
  dplyr::mutate(Pro_decentralisation = mean(c_across("DECISIONDECEN":"DECISIONCEN")))%>%
   dplyr::mutate(Pro_largescale = mean(c_across("INDUSTRYLARGE":"INDUSTRYSMALL")))%>%
   dplyr::mutate(Pro_global = mean(c_across("ECONOMYGLOBAL":"ECONOMYLOCAL")))%>%
   dplyr::mutate(Pro_ecogrowth = mean(c_across("ENVOVERDEV":"DEVOVERENV")))%>%
   dplyr::mutate(Pro_private = mean(c_across("OWNERPVT":"OWNERREG")))%>%
  dplyr::select(!c("DECISIONDECEN","DECISIONCEN", "INDUSTRYLARGE","INDUSTRYSMALL","ECONOMYGLOBAL", "ECONOMYLOCAL","ENVOVERDEV",     "DEVOVERENV","OWNERPVT","OWNERNOREG","OWNERPUB", "OWNERREG"))

#cronbach alpha


cronbach.alpha(ecopolscalescores, na.rm = TRUE, CI=TRUE, standardized=TRUE)

```

## PCA on the economic -political values of the perceiver

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
# PCA test on qualities of the perceiver

ecopolscalepca <- ecopolscalescores %>%
  dplyr::select(!starts_with(c("Risky","Gender","Caste","Religion","State")))%>%
  prcomp(center = TRUE,scale. = TRUE)


var_explained_ecopol = ecopolscalepca$sdev^2 / sum(ecopolscalepca$sdev^2)


pcatableecopol  <- summary(ecopolscalepca)

Unclassedecopol <- unclass(pcatableecopol)

Importanceecopol <- Unclassedecopol["importance"]

varexplecopol <- do.call(rbind.data.frame, Importanceecopol) 
 
ecopolPCAtable <- data.frame(t(varexplecopol), row.names=names(varexplecopol))

as_tibble(ecopolPCAtable) %>%
 add_column("Principal Components" = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9", "PC10", "PC11"))%>%
 dplyr::select("Principal Components",  importance.Proportion.of.Variance, importance.Cumulative.Proportion ) %>%  
 dplyr::rename(Proportion_of_Variance = importance.Proportion.of.Variance, Cumulative_Proportion = importance.Cumulative.Proportion)

```



## Variables in the PCs


```{r, echo=FALSE}

rotationsecopol = ecopolscalepca["rotation"]
rotationsDFecopol <- do.call(rbind.data.frame, rotationsecopol)
rotationsDFecopol
```


```{r, echo=FALSE}

qplot(c(1:11), var_explained_ecopol) + 
  geom_line() + 
  xlab("Principal Component") + 
  ylab("Variance Explained") +
  ggtitle("Scree Plot") +
  ylim(0.05, 0.20)+
  xlim(1,7)

```

\newpage

# **eco - pol characteristics of the technology scale-  Solar Energy and Nuclear Energy**


- **DISPLACESOLAR**	 Solar energy is leading to displacement of people from their land
- **POLLUTESOLAR**	 Solar energy increases pollution of air/water/land
- **HEALTHSOLAR**	   Solar energy poses a great risk to the health of people living around it
- **JOBSSOLAR**	     Solar energy will bring jobs to the local community
- **BEAUTYSOLAR**	   Solar energy spoils the natural beauty of the landscape
- **PRIDESOLAR**	   I would be proud if my community used solar energy
- **NPRIDESOLAR**	   Solar energy is a mark of pride for our nation
- **DEVSOLAR**	     Solar energy pushes forward the country's development
- **PROSPERSOLAR**	 Solar energy brings economic prosperity to the surrounding regions
- **RELYSOLAR**	     I don't like the idea that I have to rely on the government for electricity from (large scale) solar energy


## Cronbach's alpha test on eco-pol characteristics of the technology -  Solar Energy

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

#PCA on eco-pol characterisitics of the technology

Solar <- codedmodule2 %>%
 dplyr::select("DISPLACESOLAR":"RELYSOLAR") 

cronbach.alpha(Solar, na.rm = TRUE, CI=TRUE, standardized=TRUE)

ROOFS<- codedmodule2 %>%
 dplyr::select("DISPLACEROOFS":"RELYROOFS")




```

## PCA on eco-pol characteristics of the technology -  Solar Energy

```{r, echo = FALSE}

Solar.pca <- Solar %>%
  na.omit()%>%
  prcomp(center = TRUE, scale. = TRUE)

pcatablesolar  <- summary(Solar.pca)

Unclassedsolar <- unclass(pcatablesolar)

Importancesolar <- Unclassedsolar["importance"]

varexplsolar <- do.call(rbind.data.frame, Importancesolar) 
 
solarPCAtable <- data.frame(t(varexplsolar), row.names=names(varexplsolar))

as_tibble(solarPCAtable) %>%
 add_column("Principal Components" = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9", "PC10"))%>%
 dplyr::select("Principal Components",  importance.Proportion.of.Variance, importance.Cumulative.Proportion ) %>%  
 dplyr::rename(Proportion_of_Variance = importance.Proportion.of.Variance, Cumulative_Proportion = importance.Cumulative.Proportion)
```


```{r, echo=FALSE}


rotations = Solar.pca["rotation"]

#calculate total variance explained by each principal component
var_explainedSolar <- Solar.pca$sdev^2 / sum(Solar.pca$sdev^2)

rotationsSolar <- do.call(rbind.data.frame, rotations)
                  
rotationsSolar


```



```{r, echo=FALSE}

qplot(c(1:10), var_explainedSolar) + 
  geom_line() + 
  xlab("Principal Component") + 
  ylab("Variance Explained") +
  ggtitle("Scree Plot") +
  ylim(0.01, 0.40)+
  xlim(1,7)

```


## PCA on eco-pol characteristics of the technology -  Nuclear Energy


```{r, echo = FALSE}

Nuclear<- codedmodule2 %>%
 dplyr::select("DISPLACENUCLEAR":"RELYNUCLEAR")

cronbach.alpha(Nuclear, na.rm = TRUE, CI=TRUE, standardized=TRUE)

```

```{r, echo = FALSE}


Nuclear.pca <- Nuclear %>%
  na.omit()%>%
  prcomp(center = TRUE, scale. = TRUE)


pcatablenuclear  <- summary(Nuclear.pca)

Unclassednuclear <- unclass(pcatablenuclear)

Importancenuclear <- Unclassednuclear["importance"]

varexplnuclear <- do.call(rbind.data.frame, Importancenuclear) 
 
nuclearPCAtable <- data.frame(t(varexplnuclear), row.names=names(varexplnuclear))

as_tibble(nuclearPCAtable) %>%
 add_column("Principal Components" = c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9", "PC10"))%>%
 dplyr::select("Principal Components",  importance.Proportion.of.Variance, importance.Cumulative.Proportion ) %>%  
 dplyr::rename(Proportion_of_Variance = importance.Proportion.of.Variance, Cumulative_Proportion = importance.Cumulative.Proportion)

```




```{r, echo=FALSE}


rotations = Nuclear.pca["rotation"]


#calculate total variance explained by each principal component
var_explainedNuclear <- Nuclear.pca$sdev^2 / sum(Nuclear.pca$sdev^2)


rotationsNuclear <- do.call(rbind.data.frame, rotations)
                  
rotationsNuclear

```

```{r, echo=FALSE}

qplot(c(1:10), var_explainedNuclear) + 
  geom_line() + 
  xlab("Principal Component") + 
  ylab("Variance Explained") +
  ggtitle("Scree Plot") +
  ylim(0.01, 0.30)+
  xlim(1,7)

```

```{r}
#trying to work with likert packages here 

likertstack <- module2%>%
  filter(!row_number() %in% c(1,2)) %>% 
  select(starts_with("RISKY"))%>%
  gather(Technology, Perceived_Risk, Risky_Hydro:Risky_INDLPG, factor_key = TRUE)%>%
  separate(Technology, c("Risky", "Technology"), extra = "merge", fill = "left")%>%
  select(-Risky) %>% 
  group_by(Technology, Perceived_Risk) %>%
  summarise(n=n()) %>%
  pivot_wider(names_from = "Perceived_Risk", values_from = "n")


likert(Measure ~ ., data=likertstack, ylab=NULL,
       ReferenceZero=3, as.percent=TRUE,
       positive.order=TRUE, 
       main = list("Pereived risk from energy technologies in India",x=unit(.55, "npc")), 
       sub= list("Perceived risk",x=unit(.57, "npc")), 
       xlim=c(-40,-20,0,20,40,60,80,100),
       strip=FALSE, 
       par.strip.text=list(cex=.7))
```



Factor Analysis on the economic and political values scale: 4 factor spaces

```{r, echo=FALSE}
#factor analysis with 4 factor spaces

ecopolscale4.fa <- fa(ecopolscalescores, nfactors=4, scores=TRUE, rotate="varimax", fm="pa")
print.psych(ecopolscale4.fa, cut = 0.3, sort = TRUE)
fa.diagram(ecopolscale4.fa)

loadingsecopol4 <- unclass(ecopolscale4.fa$loadings)

loadingstableecopol4 <- cbind(loadingsecopol4) 

faecopol4 <- as_tibble(loadingstableecopol4) %>%
add_column("Items" = c("Local politicians shouldn't have to ask permission from the central government to implement policies",
 "Laws and policies would be implemented more smoothly if more power lay with the central government",
"It is good to have a strong leader who does not have to bother with elections", 
 "Experts, not the government, should make decisions according to what they think is best for the country" , 
"It is very important to have a democratic political system because it ensures that no individual leader has too much power" , 
"There should be a system governed by religious law" , 
"Large corporations are destroying the local industries in India and benefiting only a handful of people" , 
"Large scale industries are required for the development of the country that will benefit everyone" , 
"India would be better off if foreign companies didn't come to here" , 
"Foreign companies have led to a range of benefits for the Indian people and society", 
"Economic growth and creating jobs should be prioritized over environmental protection" , 
"Polluting industries that spoil the environment should be shut down even if it costs people their jobs", 
"All businesses and industries should be owned privately", 
"The government should own most large businesses and industries", 
"Regardless of ownership, the government should pass strong regulations and implement them", 
"There is too much red-tape and the government should not interfere with businesses and industries" , 
"A limit should be put to how much wealth a person can amass",
 "Rapid mechanization of work is taking away jobs from workers in this country"))%>%
dplyr::select("Items",PA1, PA2, PA3, PA4) %>%
  arrange(desc(PA1))
  
knitr::kable(faecopol4, digits= 2)
  
Varexplecopol4 <- unclass(ecopolscale4.fa$Vaccounted)

knitr::kable(Varexplecopol4, digits = 2)


```

Factor Analysis on the economic and political values scale: 6 factor spaces


```{r, echo=FALSE}

ecopolscale3.fa <- fa(ecopolscalescores, nfactors=3, scores=TRUE, rotate="varimax", fm="pa")
print.psych(ecopolscale3.fa, cut = 0.3, sort = TRUE)
fa.diagram(ecopolscale3.fa)

loadingsecopol3 <- unclass(ecopolscale3.fa$loadings)
 
loadingstableecopol3 <- cbind(loadingsecopol3) 

faecopol3 <- as_tibble(loadingstableecopol3) %>%
add_column("Items" = c("Local politicians shouldn't have to ask permission from the central government to implement policies",
 "Laws and policies would be implemented more smoothly if more power lay with the central government",
"It is good to have a strong leader who does not have to bother with elections", 
 "Experts, not the government, should make decisions according to what they think is best for the country" , 
"It is very important to have a democratic political system because it ensures that no individual leader has too much power" , 
"There should be a system governed by religious law" , 
"Large corporations are destroying the local industries in India and benefiting only a handful of people" , 
"Large scale industries are required for the development of the country that will benefit everyone" , 
"India would be better off if foreign companies didn't come to here" , 
"Foreign companies have led to a range of benefits for the Indian people and society", 
"Economic growth and creating jobs should be prioritized over environmental protection" , 
"Polluting industries that spoil the environment should be shut down even if it costs people their jobs", 
"All businesses and industries should be owned privately", 
"The government should own most large businesses and industries", 
"Regardless of ownership, the government should pass strong regulations and implement them", 
"There is too much red-tape and the government should not interfere with businesses and industries" , 
"A limit should be put to how much wealth a person can amass",
 "Rapid mechanization of work is taking away jobs from workers in this country"))%>%
dplyr::select("Items",PA1, PA2, PA3) %>%
  arrange(desc(PA1))
  
knitr::kable(faecopol3, digits= 2)
  
Varexplecopol3 <- unclass(ecopolscale3.fa$Vaccounted)

knitr::kable(Varexplecopol3, digits = 2)
```


```{r, echo=FALSE}

#factor analysis with 2, 4 and 6 factor spaces

ecopolscale.fa <- fa(ecopolscalescores, nfactors=2, scores=TRUE, rotate="varimax", fm="pa")
print.psych(ecopolscale.fa, cut = 0.3, sort = TRUE)
fa.diagram(ecopolscale.fa)

# Calculate eigenvalues
ecopol.eigenvalues <- ecopolscale.fa$values

loadingsecopol <- unclass(ecopolscale.fa$loadings)

loadingstableecopol <- cbind(loadingsecopol) 

twofaecopol <- as_tibble(loadingstableecopol) %>%
add_column("Items" = c("Local politicians shouldn't have to ask permission from the central government to implement policies",
 "Laws and policies would be implemented more smoothly if more power lay with the central government",
"It is good to have a strong leader who does not have to bother with elections", 
 "Experts, not the government, should make decisions according to what they think is best for the country" , 
"It is very important to have a democratic political system because it ensures that no individual leader has too much power" , 
"There should be a system governed by religious law" , 
"Large corporations are destroying the local industries in India and benefiting only a handful of people" , 
"Large scale industries are required for the development of the country that will benefit everyone" , 
"India would be better off if foreign companies didn't come to here" , 
"Foreign companies have led to a range of benefits for the Indian people and society", 
"Economic growth and creating jobs should be prioritized over environmental protection" , 
"Polluting industries that spoil the environment should be shut down even if it costs people their jobs", 
"All businesses and industries should be owned privately", 
"The government should own most large businesses and industries", 
"Regardless of ownership, the government should pass strong regulations and implement them", 
"There is too much red-tape and the government should not interfere with businesses and industries" , 
"A limit should be put to how much wealth a person can amass",
 "Rapid mechanization of work is taking away jobs from workers in this country"))%>%
dplyr::select("Items",PA1, PA2)%>%
arrange(desc(PA1))
  
knitr::kable(twofaecopol, digits= 2)
  
Varexplecopol <- unclass(ecopolscale.fa$Vaccounted)

knitr::kable(Varexplecopol, digits = 2)




```

**Economic and Political characteristics of the energy technology scale -  Solar Energy and rooftop solar energy**


- **DISPLACESOLAR**	 Solar energy is leading to displacement of people from their land
- **POLLUTESOLAR**	 Solar energy increases pollution of air/water/land
- **HEALTHSOLAR**	   Solar energy poses a great risk to the health of people living around it
- **JOBSSOLAR**	     Solar energy will bring jobs to the local community
- **BEAUTYSOLAR**	   Solar energy spoils the natural beauty of the landscape
- **PRIDESOLAR**	   I would be proud if my community used solar energy
- **NPRIDESOLAR**	   Solar energy is a mark of pride for our nation
- **DEVSOLAR**	     Solar energy pushes forward the country's development
- **PROSPERSOLAR**	 Solar energy brings economic prosperity to the surrounding regions
- **RELYSOLAR**	     I don't like the idea that I have to rely on the government for electricity from (large scale) solar energy




Cronbach's alpha test on the Eco-Pol characteristics of the technology -  Solar Energy

```{r, echo=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)

#alpha test on Eco-pol characteristics of the technology

Solar <- codedmodule2 %>%
dplyr::select("DISPLACESOLAR":"RELYSOLAR") %>%
dplyr::rename("Solar energy is leading to displacement of people from their land" = "DISPLACESOLAR") %>%
dplyr::rename("Solar energy increases pollution of air/water/land" = "POLLUTESOLAR")%>%
dplyr::rename("Solar energy poses a great risk to the health of people living around it" = "HEALTHSOLAR")%>%
dplyr::rename("Solar energy will bring jobs to the local community" = "JOBSSOLAR")%>%
dplyr::rename("Solar energy spoils the natural beauty of the landscape" = "BEAUTYSOLAR")%>%
dplyr::rename("I would be proud if my community used solar energy" = "PRIDESOLAR")%>%
dplyr::rename("Solar energy is a mark of pride for our nation" = "NPRIDESOLAR") %>%
dplyr::rename("Solar energy pushes forward the country's development" = "DEVSOLAR")%>%
dplyr::rename("Solar energy brings economic prosperity to the surrounding regions" = "PROSPERSOLAR")%>%
dplyr::rename("I don't like the idea that I have to rely on the government for electricity from (large scale solar energy)" = "RELYSOLAR")%>%
  na.omit()


psych::alpha(Solar, check.keys = TRUE)




```



Factor Analysis on the eco- pol characteristics of the technology, Solar Energy : 2 factor spaces


```{r, echo=FALSE}

#factor analysis with 2 factor spaces

solar.fa <- fa(Solar, nfactors=2, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(solar.fa, cut = 0.4, sort = TRUE)
#fa.diagram(solar.fa)

loadingssolar <- unclass(solar.fa$loadings)

loadingstablesolar <- cbind(loadingssolar) 

fasolar <- as_tibble(loadingstablesolar) %>%
add_column("Items" = c("Solar energy is leading to displacement of people from their land",
"Solar energy increases pollution of air/water/land",
"Solar energy poses a great risk to the health of people living around it",
"Solar energy will bring jobs to the local community",
"Solar energy spoils the natural beauty of the landscape",
"I would be proud if my community used solar energy",
"Solar energy is a mark of pride for our nation",
"Solar energy pushes forward the country's development",
"Solar energy brings economic prosperity to the surrounding regions",
"I don't like the idea that I have to rely on the government for electricity from (large scale) solar energy"))%>%
dplyr::select("Items",PA1, PA2)%>%
arrange(desc(PA1))
  
knitr::kable(fasolar, digits= 2)
  
Varexplsolar <- unclass(solar.fa$Vaccounted)

knitr::kable(Varexplsolar, digits = 2)
```



Factor Analysis on the eco- pol characteristics of the technology, Solar Energy : 4 factor spaces


```{r, echo=FALSE}

#factor analysis with  4 a factor spaces

solar4.fa <- fa(Solar, nfactors=4, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(solar.fa, cut = 0.4, sort = TRUE)
#fa.diagram(solar.fa)

loadingssolar4 <- unclass(solar4.fa$loadings)

loadingstablesolar4 <- cbind(loadingssolar4) 

fasolar4 <- as_tibble(loadingstablesolar4) %>%
add_column("Items" = c("Solar energy is leading to displacement of people from their land",
"Solar energy increases pollution of air/water/land",
"Solar energy poses a great risk to the health of people living around it",
"Solar energy will bring jobs to the local community",
"Solar energy spoils the natural beauty of the landscape",
"I would be proud if my community used solar energy",
"Solar energy is a mark of pride for our nation",
"Solar energy pushes forward the country's development",
"Solar energy brings economic prosperity to the surrounding regions",
"I don't like the idea that I have to rely on the government for electricity from (large scale) solar energy"))%>%
dplyr::select("Items",PA1, PA2, PA3, PA4) %>%
  arrange(desc(PA1))
  
knitr::kable(fasolar4, digits= 2)
  
Varexplsolar4 <- unclass(solar4.fa$Vaccounted)

knitr::kable(Varexplsolar4, digits = 2)
```



```{r, echo=FALSE}
ROOFS<- codedmodule2 %>%
 dplyr::select("DISPLACEROOFS":"RELYROOFS")

psych::alpha(ROOFS, check.keys = TRUE)

```



```{r, echo=FALSE}
#factor analysis with 2, 4 and 6 factor spaces

roofs.fa <- fa(ROOFS, nfactors=2, scores=TRUE, rotate="varimax", fm="pa")
#print.psych(roofs.fa, cut = 0.4, sort = TRUE)
#fa.diagram(roofs.fa)

loadingsroofs <- unclass(roofs.fa$loadings)

loadingstableroofs <- cbind(loadingsroofs) 

faroofs <- as_tibble(loadingstableroofs) %>%
add_column("Items" = c("Rooftop solar is leading to displacement of people from their land",
"Rooftop solar increases pollution of air/water/land", 
"Rooftop solar poses a great risk to the health of people living around it",
"Rooftop solar will bring jobs to the local community",
"Rooftop solar spoils the natural beauty of the landscape" , 
"I would be proud if my community used Rooftop solar" , 
"Rooftop solar is a mark of pride for our nation", 
"Rooftop solar pushes forward the country's development" , 
"Rooftop solar brings economic prosperity to the surrounding regions" , 
"I don't like the idea that I have to rely on the government for electricity from (large scale) Rooftop solar")) %>%
dplyr::select("Items",  PA1, PA2)%>%
  arrange(desc(PA1))
  
knitr::kable(faroofs, digits = 2)
  

Varexplroofs <- unclass(roofs.fa$Vaccounted)

knitr::kable(Varexplroofs, digits = 2)

```



```{r}
staterisky <- joineddf %>%
  dplyr::select(!starts_with(c("Ben_IND", "Risky_IND")))%>%
  dplyr::select(starts_with("Risky"), State)

staterisky_mean <- staterisky %>%
  group_by(State) %>%
  summarise(
    Mean_Risky_Hydro = mean(Risky_Hydro, na.rm = TRUE),
    Mean_Risky_Solar = mean(Risky_Solar, na.rm = TRUE),
    Mean_Risky_Wind = mean(Risky_Wind, na.rm = TRUE),
    Mean_Risky_Nuclear = mean(Risky_Nuclear, na.rm = TRUE),
    Mean_Risky_Coal = mean(Risky_Coal, na.rm = TRUE),
    Mean_Risky_Gas = mean(Risky_Gas, na.rm = TRUE),
    Mean_Risky_Oil = mean(Risky_Oil, na.rm = TRUE)
  )
 

str(staterisky_mean)

# Load required packages
library(dplyr)
library(tidyr)
library(ggplot2)

# Convert to long format
long_data <- staterisky_mean %>%
  gather(Technology, Mean_Score, -State) %>%
  mutate(Technology = gsub("Mean_Risky_", "", Technology))

# Order Technologies
technology_order <- c("Nuclear", "Gas", "Coal", "Oil", "Hydro", "Wind", "Solar")
long_data$Technology <- factor(long_data$Technology, levels = technology_order)

# Plot the graph
ggplot(long_data, aes(x = Technology, y = Mean_Score, color = State, group = State)) +
  geom_line(size = 1) +
  geom_point(size = 3) +
  labs(title = "Mean Perceived Risk by State",
       x = "Technology", y = "Mean Score") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



```

```{r}
# Using dplyr and tidyr

standardized_data <- long_data %>%
  group_by(Technology) %>%
  mutate(
    Overall_Mean = mean(Mean_Score, na.rm = TRUE),
    Std_Dev = sd(Mean_Score, na.rm = TRUE)
  ) %>%
  ungroup() %>%
  mutate(Standardized_Score = (Mean_Score - Overall_Mean) / Std_Dev) %>%
  dplyr::select(-Overall_Mean, -Std_Dev)  # 

# Order Technologies
technology_order <- c("Nuclear", "Gas", "Coal", "Oil", "Hydro", "Wind", "Solar")
standardized_data$Technology <- factor(standardized_data$Technology, levels = technology_order)

# Plot the graph
ggplot(standardized_data, aes(x = Technology, y = Standardized_Score, color = State, group = State)) +
  geom_line(size = 1) +
  geom_point(size = 3) +
  labs(title = "Standardised Scores of Technologies by State",
       x = "Technology", y = "Z Score") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
